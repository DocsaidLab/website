"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["29474"],{49898:function(n,e,s){s.r(e),s.d(e,{assets:function(){return o},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return t},metadata:function(){return r},toc:function(){return d}});var r=s(89642),i=s(85893),c=s(50065);let t={slug:"system-status-checking-by-chatgpt",title:"Ubuntu \u7CFB\u7D71\u57FA\u790E\u72C0\u614B\u6AA2\u67E5\u81EA\u52D5\u5316",authors:"Z. Yuan",image:"/img/2024/1212.webp",tags:["System-Monitoring","Automation","OpenAI-Integration"],description:"\u900F\u904E ChatGPT \u81EA\u52D5\u5316\u6AA2\u67E5\u7CFB\u7D71\u57FA\u790E\u72C0\u614B\u3002"},l=void 0,o={authorsImageUrls:[void 0]},d=[{value:"\u529F\u80FD\u91CD\u9EDE",id:"\u529F\u80FD\u91CD\u9EDE",level:2},{value:"\u524D\u7F6E\u4F5C\u696D",id:"\u524D\u7F6E\u4F5C\u696D",level:2},{value:"\u57F7\u884C\u65B9\u5F0F",id:"\u57F7\u884C\u65B9\u5F0F",level:2},{value:"\u6CE8\u610F\u4E8B\u9805",id:"\u6CE8\u610F\u4E8B\u9805",level:2},{value:"\u7BC4\u4F8B\u6D41\u7A0B",id:"\u7BC4\u4F8B\u6D41\u7A0B",level:2},{value:"\u7A0B\u5F0F\u78BC",id:"\u7A0B\u5F0F\u78BC",level:2},{value:"\u57F7\u884C\u7D50\u679C\u5C55\u793A",id:"\u57F7\u884C\u7D50\u679C\u5C55\u793A",level:2}];function a(n){let e={admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:"\u70BA\u4E86\u5206\u6790\u554F\u984C\uFF0C\u6211\u5011\u9700\u8981\u6AA2\u67E5\u7CFB\u7D71\u72C0\u614B\uFF0C\u4F46\u662F\u53C8\u4E0D\u64C5\u9577\u95B1\u8B80\u7CFB\u7D71\u65E5\u8A8C\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u9019\u6642\u5019\u6211\u5011\u53EF\u4EE5\u900F\u904E ChatGPT \u4F86\u81EA\u52D5\u5316\u6AA2\u67E5\u7CFB\u7D71\u57FA\u790E\u72C0\u614B\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u529F\u80FD\u91CD\u9EDE",children:"\u529F\u80FD\u91CD\u9EDE"}),"\n",(0,i.jsxs)(e.p,{children:["\u9996\u5148\u900F\u904E\u5167\u5EFA Linux \u6307\u4EE4\u5982 ",(0,i.jsx)(e.code,{children:"uptime"}),"\u3001",(0,i.jsx)(e.code,{children:"top"}),"\u3001",(0,i.jsx)(e.code,{children:"free"}),"\u3001",(0,i.jsx)(e.code,{children:"df"}),"\u3001",(0,i.jsx)(e.code,{children:"systemctl"}),"\u3001",(0,i.jsx)(e.code,{children:"sensors"}),"\u3001",(0,i.jsx)(e.code,{children:"smartctl"}),"\u3001",(0,i.jsx)(e.code,{children:"dmesg"}),"\u3001",(0,i.jsx)(e.code,{children:"journalctl"}),"\u3001",(0,i.jsx)(e.code,{children:"ss"}),"\u3001",(0,i.jsx)(e.code,{children:"ip"}),"\u3001",(0,i.jsx)(e.code,{children:"docker"})," \u7B49\u6536\u96C6\u7CFB\u7D71\u76F8\u95DC\u72C0\u6CC1\u8207\u6027\u80FD\u6307\u6A19\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u63A5\u8457\u6211\u5011\u5C07\u539F\u59CB\u5831\u544A\u5206\u70BA\u6578\u500B\u5340\u584A\uFF0C\u4EE5 OpenAI API \u70BA\u5F8C\u7AEF\u7684 GPT \u6A21\u578B (\u6307\u5B9A\u70BA ",(0,i.jsx)(e.code,{children:"gpt-4o"}),") \u81EA\u52D5\u751F\u6210\u6458\u8981\u4E26\u5F59\u6574\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u6700\u5F8C\u5C07\u591A\u4EFD\u6458\u8981\u6574\u5408\uFF0C\u6700\u5F8C\u751F\u6210\u4E00\u4EFD Markdown \u683C\u5F0F\u7684\u7CFB\u7D71\u72C0\u6CC1\u5831\u544A\uFF0C\u5305\u62EC\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7CFB\u7D71\u73FE\u6CC1\u63CF\u8FF0"}),"\n",(0,i.jsx)(e.li,{children:"\u7CFB\u7D71\u554F\u984C\u5206\u6790"}),"\n",(0,i.jsx)(e.li,{children:"\u6539\u5584\u8207\u5EFA\u8B70\u65B9\u6848"}),"\n"]}),"\n",(0,i.jsx)(e.admonition,{type:"warning",children:(0,i.jsx)(e.p,{children:"\u672C\u7BC7\u6587\u7AE0\u7684\u7A0B\u5F0F\u78BC\u53EF\u80FD\u6703\u96A8\u8457 OpenAI \u7684 API \u66F4\u65B0\u800C\u9700\u8981\u8ABF\u6574\uFF0C\u8ACB\u78BA\u4FDD API \u7684\u4F7F\u7528\u65B9\u5F0F\u8207\u7A0B\u5F0F\u78BC\u76F8\u7B26\u3002"})}),"\n",(0,i.jsx)(e.h2,{id:"\u524D\u7F6E\u4F5C\u696D",children:"\u524D\u7F6E\u4F5C\u696D"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5FC5\u8981\u5957\u4EF6\u8207\u6307\u4EE4"}),"\uFF1A"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"curl"}),"\uFF1A\u7528\u65BC\u8207 API \u9032\u884C HTTP \u901A\u8A0A"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"jq"}),"\uFF1A\u7528\u65BC\u89E3\u6790 JSON \u683C\u5F0F\u7684 API \u56DE\u61C9"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"smartctl"}),"\uFF1A\u7528\u65BC\u6AA2\u67E5\u78C1\u789F SMART \u8CC7\u8A0A"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"systemctl"}),"\uFF1A\u6AA2\u8996\u670D\u52D9\u57F7\u884C\u8207\u5931\u6557\u72C0\u614B"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"docker"}),"\uFF1A\u6AA2\u67E5 Docker \u5BB9\u5668\u72C0\u614B\uFF08\u82E5\u7CFB\u7D71\u672A\u4F7F\u7528 Docker\uFF0C\u53EF\u5FFD\u7565\u932F\u8AA4\u8A0A\u606F\uFF09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"sensors"}),"\uFF1A\u53D6\u5F97\u7CFB\u7D71\u6EAB\u5EA6\u8CC7\u8A0A\uFF08\u82E5\u7121\u6B64\u6307\u4EE4\u5247\u7121\u6CD5\u53D6\u5F97\u6EAB\u5EA6\uFF0C\u7A0B\u5F0F\u6703\u986F\u793A Warning\uFF09"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8ACB\u78BA\u4FDD\u4EE5\u4E0A\u6307\u4EE4\u5DF2\u6B63\u78BA\u5B89\u88DD\u4E26\u53EF\u5728\u8A72\u7CFB\u7D71\u6B63\u5E38\u57F7\u884C\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"OpenAI API Key"}),"\uFF1A"]}),"\n",(0,i.jsx)(e.p,{children:"\u672C\u7A0B\u5F0F\u6703\u4F7F\u7528 OpenAI API \u7522\u751F\u7CFB\u7D71\u5831\u544A\u6458\u8981\u8207\u6700\u7D42\u5206\u6790\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u8ACB\u78BA\u4FDD\u60A8\u5DF2\u64C1\u6709\u6709\u6548\u7684 OpenAI API \u91D1\u9470\uFF0C\u4E26\u5C07\u6B64\u91D1\u9470\u5132\u5B58\u65BC\u6307\u5B9A\u8DEF\u5F91"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u9810\u8A2D\u70BA ",(0,i.jsx)(e.code,{children:"/home/your_user_name/.openai_api_key"})]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'echo "YOUR_OPENAI_API_KEY" > /home/your_user_name/.openai_api_key\nchmod 600 /home/your_user_name/.openai_api_key\n'})}),"\n",(0,i.jsxs)(e.p,{children:["\u78BA\u4FDD\u5C07 ",(0,i.jsx)(e.code,{children:"YOUR_OPENAI_API_KEY"})," \u66FF\u63DB\u70BA\u5BE6\u969B\u7684 API Key\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5DE5\u4F5C\u76EE\u9304\u8207\u78C1\u789F\u7A7A\u9593"}),"\uFF1A"]}),"\n",(0,i.jsxs)(e.p,{children:["\u9810\u8A2D\u5DE5\u4F5C\u76EE\u9304\u70BA ",(0,i.jsx)(e.code,{children:"/var/log/system_checking_by_chatgpt"}),"\uFF0C\u7A0B\u5F0F\u6703\u5728\u6B64\u5EFA\u7ACB\u76F8\u95DC\u6A94\u6848\u8207\u8CC7\u6599\u593E\uFF1A"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"raw_report_YYYY-MM-DD.txt"}),"\uFF1A\u539F\u59CB\u8CC7\u8A0A\u6536\u96C6\u5831\u544A"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"chunks_YYYY-MM-DD/"}),"\uFF1A\u5206\u584A\u5F8C\u7684\u6A94\u6848"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"summary_YYYY-MM-DD/"}),"\uFF1A\u5404\u5206\u584A\u7D93 GPT \u6458\u8981\u5F8C\u7684\u6A94\u6848"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"combined_summary_YYYY-MM-DD.txt"}),"\uFF1A\u5408\u4F75\u6240\u6709\u5206\u584A\u6458\u8981\u7684\u6700\u7D42\u6458\u8981\u6A94"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"final_report_YYYY-MM-DD.md"}),"\uFF1A\u6700\u7D42\u5206\u6790\u5831\u544A\uFF08Markdown \u683C\u5F0F\uFF09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"debug_YYYY-MM-DD.log"}),"\uFF1A\u9664\u932F\u65E5\u8A8C\u6A94"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u8ACB\u78BA\u4FDD\u8A72\u76EE\u9304\u64C1\u6709\u8DB3\u5920\u7A7A\u9593\uFF08\u81F3\u5C11 100MB\uFF09\u3002\u9810\u8A2D\u6703\u6AA2\u67E5\u7A7A\u9593\u4E0D\u8DB3\u6642\u81EA\u52D5\u9000\u51FA\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u57F7\u884C\u6B0A\u9650"}),"\uFF1A"]}),"\n",(0,i.jsx)(e.p,{children:"\u8ACB\u78BA\u4FDD\u6B64\u7A0B\u5F0F\u64C1\u6709\u53EF\u57F7\u884C\u6B0A\u9650\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"chmod +x system_checking_by_chatgpt.sh\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u57F7\u884C\u65B9\u5F0F",children:"\u57F7\u884C\u65B9\u5F0F"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u7D42\u7AEF\u6A5F\u4E2D\u57F7\u884C\u672C\u7A0B\u5F0F\u5373\u53EF\u958B\u59CB\u7522\u751F\u5831\u544A\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u9810\u671F\u7684\u57F7\u884C\u6D41\u7A0B\u5982\u4E0B\uFF1A"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u521D\u59CB\u5316\u8A2D\u5B9A\u8207\u6AA2\u67E5"}),"\uFF1A\u7A0B\u5F0F\u6703\u6AA2\u67E5\u6240\u6709\u5FC5\u8981\u7684\u5916\u90E8\u6307\u4EE4\u662F\u5426\u5B58\u5728\u4E26\u78BA\u8A8D ",(0,i.jsx)(e.code,{children:"OPENAI_API_KEY"})," \u4E0D\u70BA\u7A7A\u3002\u82E5\u6709\u554F\u984C\u6703\u7ACB\u5373\u4E2D\u65B7\u4E26\u986F\u793A\u932F\u8AA4\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u7CFB\u7D71\u8CC7\u8A0A\u6536\u96C6"}),"\uFF1A\u7A0B\u5F0F\u900F\u904E\u5404\u7A2E\u6307\u4EE4\u6536\u96C6\u7CFB\u7D71\u8CC7\u8A0A\u4E26\u5C07\u8F38\u51FA\u532F\u6574\u81F3 ",(0,i.jsx)(e.code,{children:"raw_report_YYYY-MM-DD.txt"}),"\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5206\u584A\u8655\u7406\u8207\u6458\u8981"}),"\uFF1A\u7A0B\u5F0F\u5C07 ",(0,i.jsx)(e.code,{children:"raw_report_YYYY-MM-DD.txt"})," \u5206\u6210\u591A\u500B\u7D04 200 \u884C\u5927\u5C0F\u7684\u5B50\u6A94\u6848 (",(0,i.jsx)(e.code,{children:"chunk_*"}),")\uFF0C\u6BCF\u500B\u5B50\u6A94\u7D93\u7531 OpenAI API \u8655\u7406\u751F\u6210\u6458\u8981\u6A94 (",(0,i.jsx)(e.code,{children:"summary_chunk_*"}),")\uFF0C\u4EE5\u63D0\u7149\u8A72\u5206\u584A\u95DC\u9375\u91CD\u9EDE\u8207\u554F\u984C\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5408\u4F75\u6240\u6709\u6458\u8981\u4E26\u6700\u7D42\u5206\u6790"}),"\uFF1A\u7A0B\u5F0F\u5C07\u6240\u6709\u6458\u8981\u5F59\u6574\u70BA\u55AE\u4E00\u6587\u4EF6 ",(0,i.jsx)(e.code,{children:"combined_summary_YYYY-MM-DD.txt"}),"\uFF0C\u518D\u547C\u53EB OpenAI API \u9032\u884C\u300C\u6700\u7D42\u5831\u544A\u300D\u7684\u751F\u6210\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u7522\u51FA\u6700\u7D42\u5831\u544A"}),"\uFF1A\u6700\u7D42\u5831\u544A\u5132\u5B58\u5728 ",(0,i.jsx)(e.code,{children:"final_report_YYYY-MM-DD.md"}),"\uFF0C\u5167\u542B\uFF1A","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7CFB\u7D71\u73FE\u6CC1\u63CF\u8FF0"}),"\n",(0,i.jsx)(e.li,{children:"\u554F\u984C\u8207\u7570\u5E38\u4E8B\u4EF6\u5206\u6790"}),"\n",(0,i.jsx)(e.li,{children:"\u5EFA\u8B70\u7684\u89E3\u6C7A\u65B9\u6848\u8207\u6AA2\u6E2C\u5EFA\u8B70\uFF08\u53EF\u80FD\u542B\u8868\u683C\u8207\u6307\u4EE4\u7BC4\u4F8B\uFF09"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u6CE8\u610F\u4E8B\u9805",children:"\u6CE8\u610F\u4E8B\u9805"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"API \u91D1\u9470\u5B89\u5168\u6027"}),"\uFF1A\u8ACB\u59A5\u5584\u4FDD\u7BA1 ",(0,i.jsx)(e.code,{children:"OPENAI_API_KEY"}),"\uFF0C\u6B64\u91D1\u9470\u4E0D\u61C9\u516C\u958B\uFF0C\u4E26\u5EFA\u8B70\u9650\u5236\u6A94\u6848\u7684\u8B80\u53D6\u6B0A\u9650\uFF08\u5982 600 \u6B0A\u9650\uFF09\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u667A\u6167\u8ABF\u6574\u6AA2\u6E2C\u7BC4\u570D"}),"\uFF1A\u82E5\u5E0C\u671B\u64F4\u5145\u6216\u7E2E\u6E1B\u8490\u96C6\u7684\u7CFB\u7D71\u8CC7\u8A0A\uFF0C\u53EF\u5728 ",(0,i.jsx)(e.code,{children:"collect_system_info()"})," \u51FD\u6578\u4E2D\u65B0\u589E\u6216\u79FB\u9664\u6307\u4EE4\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"OpenAI API \u6A21\u578B\u8207 Token \u9650\u5236"}),"\uFF1A\u9810\u8A2D\u4F7F\u7528 ",(0,i.jsx)(e.code,{children:'MODEL="gpt-4o"'}),"\uFF0C\u8ACB\u78BA\u4FDD\u6B64\u6A21\u578B\u5728\u60A8\u7684 API \u6B0A\u9650\u4E2D\u53EF\u7528\u3002\u82E5\u6458\u8981\u6216\u6700\u7D42\u5831\u544A\u904E\u9577\u800C\u5C0E\u81F4 API \u56DE\u61C9\u5931\u6557\u6216\u4E2D\u65B7\uFF0C\u8ACB\u8003\u616E\u8ABF\u6574 ",(0,i.jsx)(e.code,{children:"CHUNK_SIZE"})," \u6216\u964D\u4F4E\u8F38\u51FA\u5167\u5BB9\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6642\u5340\u8207\u65E5\u671F\u683C\u5F0F"}),"\uFF1A\u7A0B\u5F0F\u4F7F\u7528 ",(0,i.jsx)(e.code,{children:'date +"%Y-%m-%d"'})," \u683C\u5F0F\u5316\u65E5\u671F\uFF0C\u53EF\u4F9D\u9700\u6C42\u4FEE\u6539\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u7BC4\u4F8B\u6D41\u7A0B",children:"\u7BC4\u4F8B\u6D41\u7A0B"}),"\n",(0,i.jsx)(e.p,{children:"\u4EE5\u4E0B\u70BA\u5B8C\u6574\u904B\u884C\u7BC4\u4F8B\u8AAA\u660E\uFF1A"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u78BA\u8A8D\u74B0\u5883\u8207 API Key"}),"\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'echo "sk-abc123xxx..." > /home/your_user_name/.openai_api_key\nchmod 600 /home/your_user_name/.openai_api_key\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u57F7\u884C\u7A0B\u5F0F"}),"\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"sudo bash system_checking_by_chatgpt.sh\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7A0B\u5F0F\u6703\u986F\u793A\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"[INFO] \u958B\u59CB\u57F7\u884C\u7A0B\u5F0F...\n[INFO] API \u91D1\u9470\u5DF2\u6210\u529F\u8F09\u5165\u3002\n[INFO] \u958B\u59CB\u6536\u96C6\u7CFB\u7D71\u8CC7\u8A0A...\n[INFO] \u7CFB\u7D71\u8CC7\u8A0A\u6536\u96C6\u5B8C\u6210\uFF0C\u5132\u5B58\u65BC /var/log/system_checking_by_chatgpt/raw_report_2024-12-12.txt\n[INFO] \u5C0D /var/log/system_checking_by_chatgpt/chunks_2024-12-12/chunk_aa \u9032\u884C\u6458\u8981\u8ACB\u6C42...\n...\n[INFO] \u6700\u7D42\u5831\u544A\u5DF2\u751F\u6210: /var/log/system_checking_by_chatgpt/final_report_2024-12-12.md\n[INFO] \u7A0B\u5F0F\u57F7\u884C\u5B8C\u6210\u3002\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u6AA2\u8996\u5831\u544A"}),"\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"less /var/log/system_checking_by_chatgpt/final_report_2024-12-12.md\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u6AA2\u95B1\u9664\u932F\u65E5\u8A8C\uFF08\u82E5\u9700\u8981\uFF09"}),"\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"less /var/log/system_checking_by_chatgpt/debug_2024-12-12.log\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u7A0B\u5F0F\u78BC",children:"\u7A0B\u5F0F\u78BC"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",metastring:'title="system_checking_by_chatgpt.sh"',children:'#!/usr/bin/env bash\n\nset -euo pipefail\n# set -x  # \u5982\u9700\u9664\u932F\u53EF\u555F\u7528\n\n########################################\n# \u57FA\u672C\u8A2D\u5B9A\u8207\u6AA2\u67E5\n########################################\n\nDATE=$(date +"%Y-%m-%d")\nWORK_DIR="/var/log/system_checking_by_chatgpt"\nRAW_REPORT="$WORK_DIR/raw_report_$DATE.txt"\nCHUNKS_DIR="$WORK_DIR/chunks_$DATE"\nSUMMARY_DIR="$WORK_DIR/summary_$DATE"\nFINAL_REPORT="$WORK_DIR/final_report_$DATE.md"  # \u4F7F\u7528 Markdown \u683C\u5F0F\nDEBUG_LOG="$WORK_DIR/debug_$DATE.log"\n\nOPENAI_KEY_FILE="/home/your_user_name/.openai_api_key"\n\nmkdir -p "$WORK_DIR"\nmkdir -p "$CHUNKS_DIR"\nmkdir -p "$SUMMARY_DIR"\n\n# \u6AA2\u67E5\u5FC5\u8981\u6307\u4EE4\nREQUIRED_COMMANDS=("curl" "jq" "smartctl" "systemctl" "docker" "sensors")\nfor cmd in "${REQUIRED_COMMANDS[@]}"; do\n    if ! command -v "$cmd" &>/dev/null; then\n        echo "[ERROR] \u5FC5\u9808\u7684\u6307\u4EE4 $cmd \u672A\u5B89\u88DD\uFF0C\u8ACB\u5148\u5B89\u88DD\u3002" | tee -a "$DEBUG_LOG"\n        exit 1\n    fi\ndone\n\n# \u6AA2\u67E5\u78C1\u789F\u7A7A\u9593\nAVAILABLE_SPACE=$(df "$WORK_DIR" | tail -1 | awk \'{print $4}\')\nif [ "$AVAILABLE_SPACE" -lt 102400 ]; then # \u5C11\u65BC 100MB\n    echo "[ERROR] $WORK_DIR \u78C1\u789F\u7A7A\u9593\u4E0D\u8DB3\u3002" | tee -a "$DEBUG_LOG"\n    exit 1\nfi\n\n# \u65E5\u8A8C\u51FD\u6578\uFF1A\u5C07\u8A0A\u606F\u8F38\u51FA\u5230stderr\uFF0C\u4EE5\u514D\u5E72\u64FE\u51FD\u6578\u56DE\u50B3\u503C\nlog() {\n    local LEVEL=$1\n    shift\n    local MESSAGE="$@"\n    # \u5C07\u8A0A\u606F\u5BEB\u5165DEBUG_LOG\u4E26\u900F\u904Estderr\u986F\u793A\n    {\n        echo "[$LEVEL] $MESSAGE" | tee -a "$DEBUG_LOG" >&2\n        logger -t "system_checking_by_chatgpt" "[$LEVEL] $MESSAGE"\n    }\n}\n\nlog "INFO" "\u958B\u59CB\u57F7\u884C\u7A0B\u5F0F..."\n\n########################################\n# \u8B80\u53D6 API \u91D1\u9470\n########################################\n\nif [ ! -f "$OPENAI_KEY_FILE" ]; then\n    log "ERROR" "$OPENAI_KEY_FILE \u4E0D\u5B58\u5728\u3002"\n    exit 1\nfi\n\nOPENAI_API_KEY=$(cat "$OPENAI_KEY_FILE")\nif [ -z "$OPENAI_API_KEY" ]; then\n    log "ERROR" "OPENAI_API_KEY \u70BA\u7A7A\u503C\u3002"\n    exit 1\nfi\nexport OPENAI_API_KEY\n\nlog "INFO" "API \u91D1\u9470\u5DF2\u6210\u529F\u8F09\u5165\u3002"\n\nAPI_URL="https://api.openai.com/v1/chat/completions"\nMODEL="gpt-4o"\n\n########################################\n# \u51FD\u6578\u5B9A\u7FA9\u5340\n########################################\n\ncollect_system_info() {\n    # \u6536\u96C6\u7CFB\u7D71\u8CC7\u8A0A\u5230 RAW_REPORT\n    {\n        echo "=== System Uptime ==="\n        uptime\n        echo ""\n\n        echo "=== Date & Time ==="\n        date\n        echo ""\n\n        echo "=== CPU & Memory Usage ==="\n        top -b -n1 | head -n 20\n        echo ""\n\n        echo "=== Memory Usage (free) ==="\n        free -h\n        echo ""\n\n        echo "=== Disk Usage (df) ==="\n        df -h\n        echo ""\n\n        echo "=== Failed Services ==="\n        systemctl list-units --state=failed\n        echo ""\n\n        echo "=== Temperature Sensors ==="\n        sensors 2>/dev/null || echo "[WARNING] \u7121\u6CD5\u53D6\u5F97\u6EAB\u5EA6\u8CC7\u8A0A"\n        echo ""\n\n        echo "=== NVMe / SMART Status ==="\n        sudo smartctl -a /dev/nvme0n1 2>/dev/null || echo "[WARNING] \u7121\u6CD5\u6AA2\u67E5 /dev/nvme0n1"\n        echo ""\n        sudo smartctl -a /dev/nvme1n1 2>/dev/null || echo "[WARNING] \u7121\u6CD5\u6AA2\u67E5 /dev/nvme1n1"\n        echo ""\n\n        echo "=== Recent dmesg Entries (Last 100 lines) ==="\n        dmesg | tail -n 100\n        echo ""\n\n        echo "=== System Journal (Last 300 lines, errors only) ==="\n        journalctl -p err -n 300\n        echo ""\n\n        echo "=== Network Status (ss -tulpn) ==="\n        ss -tulpn 2>/dev/null || echo "[WARNING] \u7121\u6CD5\u6AA2\u67E5\u7DB2\u8DEF\u72C0\u614B"\n        echo ""\n\n        echo "=== Network Interface Statistics (ip -s link) ==="\n        ip -s link\n        echo ""\n\n        echo "=== Docker Containers (if any) ==="\n        docker ps -a 2>/dev/null || echo "[INFO] Docker \u672A\u904B\u884C\u6216\u672A\u5B89\u88DD"\n        echo ""\n\n    } > "$RAW_REPORT"\n}\n\ngenerate_chunk_summaries() {\n    # \u5C07 RAW_REPORT \u5206\u584A\u4E26\u6458\u8981\n    CHUNK_SIZE=200\n    split -l $CHUNK_SIZE "$RAW_REPORT" "$CHUNKS_DIR/chunk_"\n\n    CHUNKS=("$CHUNKS_DIR"/chunk_*)\n\n    if [ ${#CHUNKS[@]} -eq 0 ]; then\n        log "ERROR" "\u6C92\u6709\u7522\u751F\u4EFB\u4F55 chunk\uFF01"\n        exit 1\n    fi\n\n    # \u5206\u584A\u6458\u8981\u63D0\u793A\n    CHUNK_SYSTEM_PROMPT="\u4F60\u662F\u4E00\u4F4D\u5C08\u696D\u7684\u7CFB\u7D71\u7BA1\u7406\u9867\u554F\u3002\u4EE5\u4E0A\u662F\u7CFB\u7D71\u8CC7\u8A0A\u7684\u4E00\u90E8\u5206\uFF0C\u8ACB\u5206\u6790\uFF1A1.\u91CD\u8981\u7684\u7CFB\u7D71\u72C0\u614B\u8CC7\u8A0A\uFF08\u5982 CPU/\u8A18\u61B6\u9AD4\u4F7F\u7528\u7387\u3001\u78C1\u789F\u4F7F\u7528\u3001\u7DB2\u8DEF\u72C0\u614B\u3001\u670D\u52D9\u904B\u884C\u548C\u932F\u8AA4\u8A0A\u606F\uFF09\uFF0C2.\u4EFB\u4F55\u986F\u793A\u7570\u5E38\u3001\u932F\u8AA4\u6216\u9700\u8981\u7279\u5225\u6CE8\u610F\u7684\u5730\u65B9\u3002\u8A72\u7CFB\u7D71\u53EF\u80FD\u906D\u5230\u60E1\u610F\u653B\u64CA\uFF0C\u8ACB\u5148\u5206\u6790\u9019\u88E1\u6AA2\u67E5\u7684\u76EE\u6A19\uFF0C\u63A5\u8457\u8A73\u7D30\u63CF\u8FF0\u4F60\u770B\u5230\u7684\u554F\u984C\uFF0C\u4EE5\u53CA\u554F\u984C\u6240\u5C0D\u61C9\u7684\u932F\u8AA4\u6216\u8B66\u544A\u8A0A\u606F\u3002"\n\n    summaries=()\n\n    for chunk_file in "${CHUNKS[@]}"; do\n        CHUNK_CONTENT=$(cat "$chunk_file")\n\n        CHUNK_API_PAYLOAD=$(jq -n \\\n            --arg system_prompt "$CHUNK_SYSTEM_PROMPT" \\\n            --arg user_prompt "$CHUNK_CONTENT" \\\n            --arg model "$MODEL" \\\n            \'{\n                "model": $model,\n                "messages": [\n                    {"role": "user", "content": $user_prompt},\n                    {"role": "system", "content": $system_prompt}\n                ]\n            }\')\n\n        log "INFO" "\u5C0D $chunk_file \u9032\u884C\u6458\u8981\u8ACB\u6C42..."\n        START_TIME=$(date +%s)\n        RESPONSE=$(curl -sS -X POST "$API_URL" \\\n          -H "Authorization: Bearer $OPENAI_API_KEY" \\\n          -H "Content-Type: application/json" \\\n          -d "$CHUNK_API_PAYLOAD")\n\n        if [ $? -ne 0 ]; then\n            log "ERROR" "\u8207 ChatGPT API \u901A\u8A0A\u5931\u6557 (\u5728\u6458\u8981\u968E\u6BB5): $chunk_file"\n            exit 1\n        fi\n        END_TIME=$(date +%s)\n        log "INFO" "API \u8ACB\u6C42\u8017\u6642 $((END_TIME - START_TIME)) \u79D2\u3002"\n\n        SUMMARY=$(echo "$RESPONSE" | jq -r \'.choices[0].message.content\' 2>>"$DEBUG_LOG" || echo "")\n\n        if [ -z "$SUMMARY" ] || [ "$SUMMARY" = "null" ]; then\n            log "ERROR" "\u7121\u6CD5\u53D6\u5F97\u8A72\u5206\u584A\u7684\u6458\u8981\uFF1A$chunk_file"\n            echo "Raw Response: $RESPONSE" >> "$DEBUG_LOG"\n            exit 1\n        fi\n\n        SUMMARY_FILE="$SUMMARY_DIR/summary_$(basename "$chunk_file").txt"\n        echo "$SUMMARY" > "$SUMMARY_FILE"\n        summaries+=("$SUMMARY_FILE")\n    done\n\n    # \u50C5\u8F38\u51FA summary \u6A94\u6848\u6E05\u55AE\u5230stdout\uFF08\u4E0D\u8F38\u51FA\u5176\u4ED6\u65E5\u8A8C\uFF09\uFF0C\u78BA\u4FDD\u547C\u53EB\u8005\u53EF\u6B63\u78BA\u53D6\u5F97\u6A94\u540D\u5217\u8868\n    for s in "${summaries[@]}"; do\n        echo "$s"\n    done\n}\n\ncombine_summaries() {\n    local summaries=("$@")\n    COMBINED_SUMMARY="$WORK_DIR/combined_summary_$DATE.txt"\n    rm -f "$COMBINED_SUMMARY"\n    touch "$COMBINED_SUMMARY"\n\n    log "INFO" "\u958B\u59CB\u5F59\u6574\u6240\u6709\u5206\u584A\u6458\u8981..."\n    {\n        echo "\u4EE5\u4E0B\u70BA\u591A\u500B\u5206\u6BB5\u6458\u8981\u7684\u5408\u4F75\u7D50\u679C\uFF1A"\n        echo "------------------------------------"\n        for sfile in "${summaries[@]}"; do\n            echo "=== \u5206\u6BB5\u6458\u8981 ==="\n            cat "$sfile"\n            echo ""\n        done\n    } > "$COMBINED_SUMMARY"\n\n    echo "$COMBINED_SUMMARY"\n}\n\ngenerate_final_report() {\n    local COMBINED_SUMMARY="$1"\n\n    FINAL_SYSTEM_PROMPT="\u4F60\u662F\u4E00\u4F4D\u5C08\u696D\u7684\u7CFB\u7D71\u7BA1\u7406\u9867\u554F\u3002\u4EE5\u4E0A\u662F\u7531\u591A\u500B\u5206\u6BB5\u6458\u8981\u7D44\u6210\u7684\u5408\u4F75\u5167\u5BB9\uFF0C\u8A72\u7CFB\u7D71\u53EF\u80FD\u906D\u5230\u60E1\u610F\u653B\u64CA\uFF0C\u8ACB\u91DD\u5C0D\u6574\u9AD4\u7CFB\u7D71\u72C0\u6CC1\u7522\u51FA\u300C\u8A73\u7D30\u7684\u6700\u7D42\u5831\u544A\u300D\u3002\u4E26\u5305\u542B\u4EE5\u4E0B\u4E09\u500B\u4E3B\u8981\u7AE0\u7BC0\uFF1A\n\n**1. \u7CFB\u7D71\u73FE\u6CC1\u63CF\u8FF0**\uFF1A\n\u5217\u51FA\u76EE\u524D\u7CFB\u7D71\u7684\u72C0\u6CC1\u3001\u670D\u52D9\u904B\u884C\u60C5\u5F62\u3001\u7DB2\u8DEF\u72C0\u614B\u3001\u91CD\u8981\u65E5\u8A8C\u8CC7\u8A0A\u3001\u932F\u8AA4\u8A0A\u606F\u53CA\u4EFB\u4F55\u7570\u5E38\u4E8B\u4EF6\u7684\u7D30\u7BC0\u3002\n\n**2. \u7CFB\u7D71\u73FE\u6CC1\u5206\u6790**\uFF1A\n\u91DD\u5C0D\u4E0A\u8FF0\u8CC7\u8A0A\u9032\u884C\u5206\u6790\uFF0C\u6307\u51FA\u53EF\u80FD\u7684\u554F\u984C\u9EDE\u3001\u7570\u5E38\u539F\u56E0\u63A8\u6E2C\u3001\u7CFB\u7D71\u6548\u80FD\u74F6\u9838\uFF0C\u4EE5\u53CA\u4EFB\u4F55\u4E0D\u5C0B\u5E38\u7684\u72C0\u6CC1\u6216\u98A8\u96AA\u3002\n\n**3. \u5EFA\u8B70\u89E3\u6C7A\u65B9\u5F0F**\uFF1A\n\u6839\u64DA\u5206\u6790\u7D50\u679C\uFF0C\u63D0\u51FA\u53EF\u884C\u4E14\u660E\u78BA\u7684\u6539\u5584\u65B9\u6848\u3001\u8A3A\u65B7\u6307\u4EE4\u6216\u6AA2\u67E5\u6D41\u7A0B\u5EFA\u8B70\uFF0C\u5305\u62EC\u512A\u5316\u6548\u80FD\u3001\u4FEE\u6B63\u932F\u8AA4\u3001\u5F37\u5316\u7CFB\u7D71\u7A69\u5B9A\u6027\u7684\u5EFA\u8B70\u3002\n\n\u5728\u5206\u6790\u904E\u7A0B\u4E2D\uFF0C\u4F60\u5FC5\u9808\u91DD\u5C0D\u6BCF\u500B\u554F\u984C\u9EDE\u88DC\u4E0A\u5C0D\u61C9\u7684\u6AA2\u67E5\u6307\u4EE4\u548C\u6D41\u7A0B\u5EFA\u8B70\uFF0C\u5FC5\u8981\u6642\u53EF\u4EE5\u7E6A\u88FD\u8A73\u7D30\u8868\u683C\u9032\u884C\u8A18\u9304\u3002"\n\n    FINAL_INPUT=$(cat "$COMBINED_SUMMARY")\n\n    FINAL_API_PAYLOAD=$(jq -n \\\n        --arg system_prompt "$FINAL_SYSTEM_PROMPT" \\\n        --arg user_prompt "$FINAL_INPUT" \\\n        --arg model "$MODEL" \\\n        \'{\n            "model": $model,\n            "messages": [\n                {"role": "user", "content": $user_prompt},\n                {"role": "system", "content": $system_prompt}\n            ]\n        }\')\n\n    log "INFO" "\u958B\u59CB\u6700\u7D42\u5206\u6790..."\n\n    START_TIME=$(date +%s)\n    RESPONSE=$(curl -sS -X POST "$API_URL" \\\n      -H "Authorization: Bearer $OPENAI_API_KEY" \\\n      -H "Content-Type: application/json" \\\n      -d "$FINAL_API_PAYLOAD")\n\n    if [ $? -ne 0 ]; then\n        log "ERROR" "\u8207 ChatGPT API \u901A\u8A0A\u5931\u6557 (\u6700\u7D42\u5206\u6790\u968E\u6BB5)"\n        exit 1\n    fi\n    END_TIME=$(date +%s)\n    log "INFO" "API \u8ACB\u6C42\u8017\u6642 $((END_TIME - START_TIME)) \u79D2\u3002"\n\n    log "DEBUG" "\u6700\u7D42\u5206\u6790\u56DE\u61C9: $RESPONSE"\n\n    FINAL_ANALYSIS=$(echo "$RESPONSE" | jq -r \'.choices[0].message.content\' 2>>"$DEBUG_LOG" || echo "")\n\n    if [ -z "$FINAL_ANALYSIS" ] || [ "$FINAL_ANALYSIS" = "null" ]; then\n        log "ERROR" "\u6700\u7D42\u5206\u6790\u5167\u5BB9\u53D6\u5F97\u5931\u6557\u3002"\n        echo "Raw Response: $RESPONSE" >> "$DEBUG_LOG"\n        exit 1\n    fi\n\n    {\n        echo "# \u6BCF\u65E5\u7CFB\u7D71\u6AA2\u6E2C\u5831\u544A - $DATE"\n        echo ""\n        echo "$FINAL_ANALYSIS"\n    } > "$FINAL_REPORT"\n\n    log "INFO" "\u6700\u7D42\u5831\u544A\u5DF2\u751F\u6210: $FINAL_REPORT"\n}\n\n\n########################################\n# \u4E3B\u7A0B\u5F0F\u6D41\u7A0B\n########################################\n\nlog "INFO" "\u958B\u59CB\u6536\u96C6\u7CFB\u7D71\u8CC7\u8A0A..."\ncollect_system_info\nlog "INFO" "\u7CFB\u7D71\u8CC7\u8A0A\u6536\u96C6\u5B8C\u6210\uFF0C\u5132\u5B58\u65BC $RAW_REPORT"\n\n# \u4F7F\u7528 readarray \u8B80\u53D6 generate_chunk_summaries \u7684\u8F38\u51FA\u81F3\u9663\u5217\nmapfile -t summaries < <(generate_chunk_summaries)\nCOMBINED_SUMMARY_FILE=$(combine_summaries "${summaries[@]}")\ngenerate_final_report "$COMBINED_SUMMARY_FILE"\n\nlog "INFO" "\u7A0B\u5F0F\u57F7\u884C\u5B8C\u6210\u3002"\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u57F7\u884C\u7D50\u679C\u5C55\u793A",children:"\u57F7\u884C\u7D50\u679C\u5C55\u793A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-markdown",children:'# \u6BCF\u65E5\u7CFB\u7D71\u6AA2\u6E2C\u5831\u544A - 2024-12-12\n\n## \u8A73\u7D30\u7684\u6700\u7D42\u5831\u544A\n\n### 1. \u7CFB\u7D71\u73FE\u6CC1\u63CF\u8FF0\n\n**CPU \u4F7F\u7528\u72C0\u6CC1**\uFF1A\n\n- CPU \u4F7F\u7528\u7387\u504F\u9AD8\uFF0C\u7279\u5225\u662F\u5728\u8655\u7406\u2018pt_data+\u2019\u4EFB\u52D9\u6642\uFF0C\u4F54\u7528\u8D85\u904E 200%\u5230 300%\u3002\n- \u591A\u500B CPU \u6838\u5FC3\u7684\u6EAB\u5EA6\u9054\u5230\u751A\u81F3\u8D85\u904E 80\xb0C\uFF0C\u53EF\u80FD\u610F\u5473\u8457\u904E\u71B1\u554F\u984C\u3002\n\n**\u8A18\u61B6\u9AD4\u4F7F\u7528\u72C0\u6CC1**\uFF1A\n\n- \u7E3D\u8A18\u61B6\u9AD4 128577.3 MiB\uFF0C\u5DF2\u88AB\u4F7F\u7528 48421.6 MiB\uFF0C\u6709 76743.1 MiB \u7684\u7DE9\u5B58/\u7DE9\u885D\u3002\n- \u7CFB\u7D71\u51FA\u73FE\u591A\u6B21\u300COut of memory\u300D\u4E8B\u4EF6\uFF0C\u90E8\u5206\u9032\u7A0B\u56E0\u5167\u5B58\u4E0D\u8DB3\u88AB\u5F37\u5236\u7D42\u6B62\u3002\n\n**\u78C1\u789F\u4F7F\u7528\u72C0\u6CC1**\uFF1A\n\n- /\uFF08\u6839\u76EE\u9304\uFF09\u5DF2\u4F7F\u7528 70%\uFF0C/dev/nvme1n1 \u4F7F\u7528\u4E86 51%\u3002\n- NVMe \u78C1\u789F\u5065\u5EB7\u72C0\u6CC1\u986F\u793A\u201CPASSED\u201D\uFF0C\u4F46\u6709\u4E00\u4E9B "Invalid Field in Command" \u932F\u8AA4\u3002\n\n**\u7DB2\u8DEF\u72C0\u614B**\uFF1A\n\n- \u7DB2\u5361`enp5s0`\u548C`r8169`\u51FA\u73FE\u591A\u6B21\u300CNETDEV WATCHDOG\u300D\u8B66\u544A\uFF0C\u63D0\u793A\u7DB2\u8DEF\u50B3\u8F38\u968A\u5217\u8D85\u6642\u3002\n- \u65E5\u8A8C\u986F\u793A\u6301\u7E8C\u7684 UFW \u9632\u706B\u7246\u5C01\u9396\u4F86\u81EA 192.168.0.1 \u7684\u591A\u64AD\u5C01\u5305\u3002\n- \u5B58\u5728\u4E00\u6B21 SSH \u9023\u7DDA\u5931\u6557\u7684\u8A18\u9304\u3002\n\n**\u670D\u52D9\u904B\u884C\u72C0\u614B**\uFF1A\n\n- `snap.firmware-updater.firmware-notifier`\u670D\u52D9\u591A\u6B21\u555F\u52D5\u5931\u6557\u3002\n- `NETDEV WATCHDOG`\u932F\u8AA4\u8A18\u9304\u591A\u6B21\u3002\n- \u90E8\u5206\u61C9\u7528\u7A0B\u5E8F\u5982 `NetworkManager-dispatcher` \u670D\u52D9\u672A\u80FD\u6210\u529F\u555F\u52D5\u3002\n\n**\u5B89\u5168\u72C0\u6CC1**\uFF1A\n\n- \u65E5\u8A8C\u986F\u793A\u6709\u591A\u91CD `apparmor` \u62D2\u7D55\u8B66\u544A\uFF0C\u9700\u8981\u6AA2\u67E5\u5B89\u5168\u8A2D\u5B9A\u3002\n\n### 2. \u7CFB\u7D71\u73FE\u6CC1\u5206\u6790\n\n**CPU \u904E\u71B1\u53CA\u9AD8\u4F7F\u7528\u7387**\uFF1A\n\n- \u9AD8 CPU \u4F7F\u7528\u53CA\u6EAB\u5EA6\u53EF\u80FD\u7531\u65BC\u9AD8\u5F37\u5EA6\u8A08\u7B97\u4EFB\u52D9\uFF08\u5982\u2018pt_data+\u2019\uFF09\uFF0C\u9700\u8981\u6AA2\u67E5\u662F\u5426\u70BA\u5FC5\u8981\u9032\u7A0B\u6216\u512A\u5316\u8A08\u7B97\u3002\n\n**\u8A18\u61B6\u9AD4\u74F6\u9838**\uFF1A\n\n- \u591A\u6B21 OOM \u4E8B\u4EF6\u8868\u660E\u5167\u5B58\u7684\u5206\u914D\u4E0D\u5408\u7406\u6216\u4E0D\u8DB3\uFF0C\u9700\u9032\u4E00\u6B65\u6AA2\u67E5\u5167\u5B58\u5BC6\u96C6\u578B\u61C9\u7528\u7A0B\u5E8F\u53CA\u5176\u904B\u884C\u72C0\u6CC1\u3002\n\n**\u78C1\u789F\u5065\u5EB7\u53CA\u932F\u8AA4**\uFF1A\n\n- NVMe \u78C1\u789F\u51FA\u73FE"Invalid Field in Command"\u53EF\u80FD\u662F\u7531\u65BC\u9A45\u52D5\u6216\u97CC\u9AD4\u554F\u984C\uFF0C\u9700\u78BA\u8A8D\u662F\u5426\u6709\u66F4\u65B0\u3002\n\n**\u7DB2\u8DEF\u554F\u984C**\uFF1A\n\n- \u300CNETDEV WATCHDOG\u300D\u63D0\u793A\u7DB2\u7D61\u9A45\u52D5\u6216\u914D\u7F6E\u554F\u984C\uFF0C\u7528\u6236\u5FC5\u9808\u6392\u67E5\u7DB2\u5361\u9A45\u52D5\u53CA\u914D\u7F6E\u66F4\u65B0\u3002\n- \u6301\u7E8C\u7684 UFW \u5C01\u9396\u4E8B\u4EF6\u53EF\u80FD\u7531\u975E\u6B63\u5E38\u6D41\u91CF\u6216\u914D\u7F6E\u932F\u8AA4\u5F15\u767C\uFF0C\u9700\u8981\u6AA2\u67E5\u8A72 IP \u8A2D\u5099\u3002\n\n**\u670D\u52D9\u904B\u884C\u554F\u984C**\uFF1A\n\n- `snap.firmware-updater.firmware-notifier`\u670D\u52D9\u7684\u554F\u984C\u53EF\u80FD\u662F\u7531\u65BC\u8CC7\u6E90\u4E0D\u53EF\u7528\u6216\u76F8\u4F9D\u670D\u52D9\u56B4\u91CD\u6545\u969C\u3002\n\n**\u5B89\u5168\u98A8\u96AA**\uFF1A\n\n- UFW \u5C01\u9396\u8207`apparmor`\u8B66\u544A\u986F\u793A\u6F5B\u5728\u5B89\u5168\u98A8\u96AA\uFF0C\u9700\u6AA2\u67E5\u9632\u706B\u7246\u548C\u61C9\u7528\u5B89\u5168\u6027\u3002\n\n### 3. \u5EFA\u8B70\u89E3\u6C7A\u65B9\u5F0F\n\n**\u6539\u9032 CPU \u53CA\u8A18\u61B6\u9AD4\u6548\u80FD**\uFF1A\n\n1. **\u6AA2\u67E5\u5E76\u512A\u5316\u9032\u7A0B**\uFF1A\n\n   - \u4F7F\u7528`top`\u6216`htop`\u76E3\u63A7\u9AD8 CPU \u4F7F\u7528\u7684\u9032\u7A0B\u3002\n   - \u8ABF\u6574\u6216\u95DC\u9589\u975E\u5FC5\u8981\u7684\u2018pt_data+\u2019\u9032\u7A0B\u3002\n\n2. **\u5167\u5B58\u7BA1\u7406**\uFF1A\n   - \u4F7F\u7528`free -m`\u548C`vmstat`\u7B49\u547D\u4EE4\u9032\u884C\u5167\u5B58\u72C0\u6CC1\u5206\u6790\u3002\n   - \u589E\u52A0\u7269\u7406\u5167\u5B58\u6216\u8ABF\u6574 swap \u7A7A\u9593\u3002\n\n**\u4FEE\u5FA9\u78C1\u789F\u932F\u8AA4**\uFF1A\n\n1. **\u6AA2\u67E5\u66F4\u65B0\u9A45\u52D5/\u97CC\u9AD4**\uFF1A\n   - \u57F7\u884C`sudo smartctl -a /dev/nvme0n1`\u6AA2\u67E5\u8A73\u7D30 SMART \u4FE1\u606F\u3002\n   - \u66F4\u65B0 NVMe \u9A45\u52D5\u7A0B\u5E8F\u548C\u97CC\u9AD4\u3002\n\n**\u8655\u7406\u7DB2\u8DEF\u554F\u984C**\uFF1A\n\n1. **\u7DB2\u5361\u9A45\u52D5\u6AA2\u67E5**\uFF1A\n\n   - \u7528`sudo ethtool -i r8169`\u6AA2\u67E5\u9A45\u52D5\u7248\u672C\uFF0C\u78BA\u8A8D\u662F\u5426\u6709\u53EF\u7528\u5347\u7D1A\u3002\n   - `journalctl -k | grep -i netdev`\u67E5\u770B\u66F4\u8A73\u7D30\u7684\u7DB2\u5361\u932F\u8AA4\u65E5\u8A8C\u3002\n\n2. **\u6AA2\u67E5 UFW \u8A2D\u5B9A**\uFF1A\n   - \u4F7F\u7528\u547D\u4EE4`sudo ufw status verbose`\u6AA2\u67E5\u6D3B\u52D5\u7684\u9632\u706B\u7246\u898F\u5247\u3002\n   - \u5177\u9AD4\u5206\u6790\u4F86\u81EA 192.168.0.1 \u7684\u6D41\u91CF\u4F86\u6E90\uFF0C\u78BA\u4FDD\u6B63\u7576\u3002\n\n**\u670D\u52D9\u53CA\u5B89\u5168\u6027\u4FEE\u6B63**\uFF1A\n\n1. **\u670D\u52D9\u8A3A\u65B7**\uFF1A\n\n   - \u67E5\u770B`snap.service`\u76F8\u95DC\u7684\u65E5\u8A8C\uFF0C\u4F7F\u7528`journalctl -xe`\u7372\u5F97\u66F4\u591A\u932F\u8AA4\u8CC7\u8A0A\u3002\n   - \u6AA2\u67E5`firmware-updater`\u7684\u76F8\u4F9D\u5305\u72C0\u6CC1\u548C\u914D\u7F6E\u3002\n\n2. **\u52A0\u5F37\u5B89\u5168\u914D\u7F6E**\uFF1A\n   - \u5F9E`cat /var/log/syslog | grep apparmor`\u6AA2\u67E5\u5177\u9AD4\u7684`apparmor`\u8B66\u544A\u4FE1\u606F\u3002\n   - \u978F\u56FA\u9632\u706B\u7246\u53CA\u52A0\u5F37\u7DB2\u7D61\u670D\u52D9\u7684\u5B89\u5168\u7B56\u7565\u3002\n\n\u6700\u5F8C\uFF0C\u5EFA\u8B70\u6574\u500B\u7CFB\u7D71\u9032\u884C\u8A73\u7D30\u65E5\u8A8C\u76E3\u63A7\uFF0C\u52A0\u5F37\u5C0D\u7570\u5E38\u4E8B\u4EF6\u5FEB\u901F\u53CD\u61C9\u7684\u80FD\u529B\uFF0C\u4EE5\u4FDD\u969C\u7CFB\u7D71\u7684\u7A69\u5B9A\u904B\u884C\u3002\n'})})]})}function h(n={}){let{wrapper:e}={...(0,c.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},50065:function(n,e,s){s.d(e,{Z:function(){return l},a:function(){return t}});var r=s(67294);let i={},c=r.createContext(i);function t(n){let e=r.useContext(c);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:t(n.components),r.createElement(c.Provider,{value:e},n.children)}},89642:function(n){n.exports=JSON.parse('{"permalink":"/blog/system-status-checking-by-chatgpt","source":"@site/blog/2024/12-12-system-status-checking-by-chatgpt/index.md","title":"Ubuntu \u7CFB\u7D71\u57FA\u790E\u72C0\u614B\u6AA2\u67E5\u81EA\u52D5\u5316","description":"\u900F\u904E ChatGPT \u81EA\u52D5\u5316\u6AA2\u67E5\u7CFB\u7D71\u57FA\u790E\u72C0\u614B\u3002","date":"2024-12-12T00:00:00.000Z","tags":[{"inline":true,"label":"System-Monitoring","permalink":"/blog/tags/system-monitoring"},{"inline":true,"label":"Automation","permalink":"/blog/tags/automation"},{"inline":true,"label":"OpenAI-Integration","permalink":"/blog/tags/open-ai-integration"}],"readingTime":17.39,"hasTruncateMarker":true,"authors":[{"name":"Z. Yuan","title":"Dosaid maintainer, Full-Stack AI Engineer","url":"https://github.com/zephyr-sh","socials":{"github":"https://github.com/zephyr-sh"},"imageURL":"https://github.com/zephyr-sh.png","key":"Z. Yuan","page":null}],"frontMatter":{"slug":"system-status-checking-by-chatgpt","title":"Ubuntu \u7CFB\u7D71\u57FA\u790E\u72C0\u614B\u6AA2\u67E5\u81EA\u52D5\u5316","authors":"Z. Yuan","image":"/img/2024/1212.webp","tags":["System-Monitoring","Automation","OpenAI-Integration"],"description":"\u900F\u904E ChatGPT \u81EA\u52D5\u5316\u6AA2\u67E5\u7CFB\u7D71\u57FA\u790E\u72C0\u614B\u3002"},"unlisted":false,"prevItem":{"title":"\u6279\u6B21\u5F71\u7247\u8F49\u6A94","permalink":"/blog/flexible-video-conversion-by-python"},"nextItem":{"title":"\u5E6B Docusaurus \u7684 Docs \u52A0\u4E0A\u4F5C\u8005\u8CC7\u8A0A","permalink":"/blog/customized-docusaurus-author-to-plugin-content-docs"}}')}}]);