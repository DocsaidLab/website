"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["8583"],{989:function(n,e,s){s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>a});var i=s(54517),r=s(85893),t=s(50065);let c={slug:"ubuntu-github-runner-systemd",title:"\u81EA\u52D5\u904B\u884C GitHub Runner",authors:"Z. Yuan",tags:["github-action","runner"],image:"/img/2023/0910.webp",description:"\u7528 Ubuntu Systemd \u5728\u80CC\u666F\u57F7\u884C\u4E26\u81EA\u52D5\u904B\u884C\u3002"},l=void 0,d={authorsImageUrls:[void 0]},a=[{value:"\u554F\u984C\u63CF\u8FF0",id:"\u554F\u984C\u63CF\u8FF0",level:2},{value:"\u914D\u7F6E\u6D41\u7A0B",id:"\u914D\u7F6E\u6D41\u7A0B",level:2},{value:"\u67E5\u770B\u72C0\u614B",id:"\u67E5\u770B\u72C0\u614B",level:2},{value:"\u91CD\u65B0\u914D\u7F6E",id:"\u91CD\u65B0\u914D\u7F6E",level:2}];function u(n){let e={admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.p,{children:"\u5728\u4F7F\u7528 Github \u5354\u4F5C\u7684\u904E\u7A0B\u4E2D\uFF0C\u6211\u5011\u5E38\u6703\u4F7F\u7528\u5230\u79C1\u6709\u4E3B\u6A5F\u4F86\u9032\u884C CI/CD \u7684\u5DE5\u4F5C\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u9019\u500B\u90E8\u5206\u5728 Github \u4E2D\u6709\u63D0\u4F9B\u8AAA\u660E\u6587\u4EF6\uFF0C\u544A\u8A34\u4F7F\u7528\u8005\u8A72\u5982\u4F55\u9032\u884C\u521D\u6B65\u7684\u5B89\u88DD\uFF0C\u4F9D\u7167\u6B65\u9A5F\u505A\u5B8C\u5C31\u53EF\u4EE5\u914D\u7F6E\u6210\u529F\u3002"}),"\n",(0,r.jsxs)("div",{align:"center",children:[(0,r.jsx)("figure",{style:{width:"80%"},children:(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{alt:"github_set_runner",src:s(88630).Z+"",width:"2048",height:"1173"})})}),(0,r.jsx)("figcaption",{children:"\u8AAA\u660E\u6587\u4EF6"})]}),"\n",(0,r.jsx)(e.h2,{id:"\u554F\u984C\u63CF\u8FF0",children:"\u554F\u984C\u63CF\u8FF0"}),"\n",(0,r.jsx)(e.p,{children:"\u4F46\u662F\u4F60\u7684\u4E3B\u6A5F\u7E3D\u6703\u9700\u8981\u91CD\u65B0\u555F\u52D5\uFF0C\u5982\u679C\u9019\u6642\u6C92\u6709\u505A\u8A2D\u5B9A\uFF0CRunner \u7684\u670D\u52D9\u6703\u6C38\u9060\u7684\u6C88\u7761\u4E0B\u53BB\u3002\u7136\u5F8C\u9019\u4EF6\u4E8B\u60C5\u5C31\u9019\u6A23\u88AB\u5FD8\u8A18\uFF0C\u76F4\u5230\u6709\u4EBA\u767C\u73FE\u6C92\u53CD\u61C9\u6216\u88AB\u5BA2\u8A34\uFF0C\u9019\u6642\u53EF\u80FD\u5DF2\u7D93\u904E\u4E86\u597D\u5E7E\u5929\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u9019\u7A2E\u4E8B\u60C5\u6703\u4E00\u800C\u518D\uFF0C\u518D\u800C\u4E09\u7684\u767C\u751F\uFF0C\u4E0D\u582A\u5176\u64FE\uFF01"}),"\n",(0,r.jsx)(e.p,{children:"\u6240\u4EE5\uFF0C\u6211\u5011\u9700\u8981\u81EA\u52D5\u57F7\u884C\uFF01"}),"\n",(0,r.jsx)(e.h2,{id:"\u914D\u7F6E\u6D41\u7A0B",children:"\u914D\u7F6E\u6D41\u7A0B"}),"\n",(0,r.jsx)(e.p,{children:"\u8981\u5728\u4E3B\u6A5F\u958B\u6A5F\u5F8C\u81EA\u52D5\u57F7\u884C\u67D0\u500B\u4EFB\u52D9\uFF0C\u53EF\u4EE5\u4F7F\u7528 systemd \u4F86\u505A\u3002"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u5EFA\u7ACB\u4E00\u500B\u65B0\u7684 systemd \u670D\u52D9\u6A94\u6848\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"sudo vim /etc/systemd/system/actions-runner.service\n"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u8CBC\u4E0A\u4EE5\u4E0B\u7684\u5167\u5BB9\u5230\u6A94\u6848\u4E2D\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",metastring:'{7-9} title="/etc/systemd/system/actions-runner.service"',children:"[Unit]\nDescription=GitHub Action Runner\nAfter=network.target\n\n[Service]\nType=simple\nUser=\u4F60\u7684\u4F7F\u7528\u8005\u540D\u7A31\nWorkingDirectory=/home/\u4F60\u7684\u4F7F\u7528\u8005\u540D\u7A31/actions-runner\nExecStart=/home/\u4F60\u7684\u4F7F\u7528\u8005\u540D\u7A31/actions-runner/run.sh\nRestart=always\nRestartSec=5\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u7528\u984F\u8272\u5321\u8D77\u4F86\u7684\u5730\u65B9\u8981\u6CE8\u610F\uFF1A"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"User"}),"\u3001",(0,r.jsx)(e.code,{children:"ExecStart"})," \u8207 ",(0,r.jsx)(e.code,{children:"WorkingDirectory"})," \u8981\u6539\u6210\u4F60\u81EA\u5DF1\u7684\u4F7F\u7528\u8005\u540D\u7A31\u3002"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u544A\u77E5 systemd \u91CD\u65B0\u8B80\u53D6\u65B0\u7684\u670D\u52D9\u8A2D\u5B9A\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"sudo systemctl daemon-reload\n"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u555F\u7528\u6B64\u670D\u52D9\uFF0C\u4F7F\u5176\u5728\u958B\u6A5F\u6642\u81EA\u52D5\u555F\u52D5\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"sudo systemctl enable actions-runner.service\n"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u73FE\u5728\u4F60\u53EF\u4EE5\u624B\u52D5\u958B\u59CB\u6B64\u670D\u52D9\uFF0C\u6216\u662F\u91CD\u65B0\u958B\u6A5F\u4F86\u6E2C\u8A66\u5B83\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"sudo systemctl start actions-runner.service\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u4F7F\u7528\u9019\u500B\u65B9\u6CD5\uFF0C\u7576\u4F60\u7684\u4E3B\u6A5F\u958B\u6A5F\u6642\uFF0Cactions-runner \u6703\u81EA\u52D5\u80CC\u666F\u57F7\u884C\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u679C\u4F60\u60F3\u505C\u6B62\u670D\u52D9\uFF0C\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u6307\u4EE4\uFF1A"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"sudo systemctl stop actions-runner.service\n"})}),"\n",(0,r.jsx)(e.admonition,{type:"warning",children:(0,r.jsxs)(e.p,{children:["\u8981\u8A18\u5F97\u8981\u78BA\u4FDD ",(0,r.jsx)(e.code,{children:"run.sh"})," \u5177\u6709\u53EF\u57F7\u884C\u7684\u6B0A\u9650\u3002"]})}),"\n",(0,r.jsx)(e.h2,{id:"\u67E5\u770B\u72C0\u614B",children:"\u67E5\u770B\u72C0\u614B"}),"\n",(0,r.jsx)(e.p,{children:"\u7576\u4F60\u4F7F\u7528 systemd \u4F86\u7BA1\u7406\u670D\u52D9\u6642\uFF0C\u4F60\u53EF\u4EE5\u67E5\u770B\u65E5\u8A8C\u4F86\u4E86\u89E3\u5B83\u7684\u5DE5\u4F5C\u72C0\u614B\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u8ACB\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\uFF1A"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"sudo journalctl -u actions-runner.service -f\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u89E3\u91CB\u4E00\u4E0B\u53C3\u6578\uFF1A"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"-u actions-runner.service"}),"\uFF1A\u53EA\u67E5\u770B\u540D\u70BA actions-runner \u7684\u670D\u52D9\u7684\u65E5\u8A8C\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"-f"}),"\uFF1A\u9019\u500B\u53C3\u6578\u8B93 journalctl \u6301\u7E8C\u8FFD\u8E2A\u6700\u65B0\u7684\u65E5\u8A8C\uFF0C\u6240\u4EE5\u4F60\u53EF\u4EE5\u5BE6\u6642\u770B\u5230\u65B0\u7684\u8F38\u51FA\u3002"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u6B64\u5916\uFF0C\u5982\u679C\u4F60\u60F3\u67E5\u770B\u670D\u52D9\u7684\u7576\u524D\u72C0\u614B\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528\uFF1A"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"sudo systemctl status actions-runner.service\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u9019\u5C07\u6703\u986F\u793A ",(0,r.jsx)(e.code,{children:"actions-runner"})," \u670D\u52D9\u7684\u7576\u524D\u72C0\u614B\uFF0C\u5305\u62EC\u662F\u5426\u6B63\u5728\u904B\u884C\uFF0C\u4EE5\u53CA\u6700\u8FD1\u7684\u65E5\u8A8C\u8F38\u51FA\uFF1A"]}),"\n",(0,r.jsx)("div",{align:"center",children:(0,r.jsx)("figure",{style:{width:"80%"},children:(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{alt:"action-service",src:s(72248).Z+"",width:"2048",height:"831"})})})}),"\n",(0,r.jsx)(e.h2,{id:"\u91CD\u65B0\u914D\u7F6E",children:"\u91CD\u65B0\u914D\u7F6E"}),"\n",(0,r.jsx)(e.p,{children:"\u9019\u908A\u662F\u984C\u5916\u8A71\uFF0C\u8DDF\u81EA\u52D5\u904B\u884C\u7121\u95DC\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u679C\u662F\u539F\u672C\u7684 Runner \u4E0D\u898B\u4E86\uFF08\u901A\u5E38\u6703\u662F\u5728\u5207\u63DB\u5132\u5B58\u5EAB\u7684 Public \u548C Private \u7684\u6642\u5019\uFF09\uFF0C\u6216\u662F\u539F\u672C Runner \u592A\u4E45\u6C92\u6709\u8ABF\u7528\uFF0C\u7E3D\u4E4B\u5C31\u662F\u5F04\u4E1F\u4E86\uFF01"}),"\n",(0,r.jsx)(e.p,{children:"\u9019\u6642\u5019\u5C31\u9700\u8981\u91CD\u65B0\u914D\u7F6E\uFF1A"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u5230\u4F60\u7684 github \u5E33\u865F\u4E0A\u53D6\u5F97\u4E00\u7D44\u65B0\u7684 Token\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u56DE\u5230\u4F60\u7684 actions-runner \u8CC7\u6599\u593E\u5E95\u4E0B\uFF08\u53EF\u80FD\u662F\u5176\u4ED6\u4F60\u81EA\u5DF1\u53D6\u7684\u540D\u7A31\uFF09\uFF0C\u628A ",(0,r.jsx)(e.code,{children:".runner"})," \u6A94\u6848\u522A\u6389\uFF0C\u518D\u57F7\u884C\u914D\u7F6E\u6307\u4EE4\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"./config.sh --url ... (\u6539\u6210\u65B0\u7684 Token \u914D\u7F6E)\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u5176\u4ED6\u6D41\u7A0B\u90FD\u4E00\u6A23\uFF0C\u914D\u7F6E\u5B8C\u4E4B\u5F8C\uFF0C\u628A\u670D\u52D9\u91CD\u65B0\u555F\u52D5\u5C31\u597D\u3002"})]})}function h(n={}){let{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(u,{...n})}):u(n)}},72248:function(n,e,s){s.d(e,{Z:()=>i});let i=s.p+"assets/images/action-service-6b4de0ff1dc1dc29f3edb7aeb4d16fc8.jpg"},88630:function(n,e,s){s.d(e,{Z:()=>i});let i=s.p+"assets/images/github_set_runner-6ca68dc499f780fcc4c6e7d7461a2ffe.jpg"},50065:function(n,e,s){s.d(e,{Z:()=>l,a:()=>c});var i=s(67294);let r={},t=i.createContext(r);function c(n){let e=i.useContext(t);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:c(n.components),i.createElement(t.Provider,{value:e},n.children)}},54517:function(n){n.exports=JSON.parse('{"permalink":"/blog/ubuntu-github-runner-systemd","source":"@site/blog/2023/09-10-ubuntu-github-action-runner-systemd/index.md","title":"\u81EA\u52D5\u904B\u884C GitHub Runner","description":"\u7528 Ubuntu Systemd \u5728\u80CC\u666F\u57F7\u884C\u4E26\u81EA\u52D5\u904B\u884C\u3002","date":"2023-09-10T00:00:00.000Z","tags":[{"inline":true,"label":"github-action","permalink":"/blog/tags/github-action"},{"inline":true,"label":"runner","permalink":"/blog/tags/runner"}],"readingTime":2.61,"hasTruncateMarker":true,"authors":[{"name":"Z. Yuan","title":"Dosaid maintainer, Full-Stack AI Engineer","url":"https://github.com/zephyr-sh","socials":{"github":"https://github.com/zephyr-sh","linkedin":"https://www.linkedin.com/in/ze-yuan-sh7/"},"imageURL":"https://github.com/zephyr-sh.png","key":"Z. Yuan","page":null}],"frontMatter":{"slug":"ubuntu-github-runner-systemd","title":"\u81EA\u52D5\u904B\u884C GitHub Runner","authors":"Z. Yuan","tags":["github-action","runner"],"image":"/img/2023/0910.webp","description":"\u7528 Ubuntu Systemd \u5728\u80CC\u666F\u57F7\u884C\u4E26\u81EA\u52D5\u904B\u884C\u3002"},"unlisted":false,"prevItem":{"title":"\u5728 Ubuntu \u4E0A\u8A2D\u5B9A SSH \u4F3A\u670D\u5668","permalink":"/blog/ubuntu-install-ssh"},"nextItem":{"title":"\u767B\u5165 RTF8207W \u8DEF\u7531\u5668","permalink":"/blog/login-rtf8207w"}}')}}]);