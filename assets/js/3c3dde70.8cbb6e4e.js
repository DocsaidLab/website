"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["62359"],{42269:function(n,e,t){t.r(e),t.d(e,{assets:function(){return l},contentTitle:function(){return s},default:function(){return d},frontMatter:function(){return a},metadata:function(){return r},toc:function(){return c}});var r=t(5540),i=t(85893),o=t(50065);let a={slug:"pytorch-training-out-of-memory",title:"PyTorch \u7684 List \u9677\u9631",authors:"Zephyr",tags:["PyTorch","OOM"],image:"/img/2024/0220.webp",description:"\u767C\u73FE\u8207\u89E3\u6C7A PyTorch OOM \u554F\u984C\u3002"},s=void 0,l={authorsImageUrls:[void 0]},c=[{value:"\u554F\u984C\u8AAA\u660E",id:"\u554F\u984C\u8AAA\u660E",level:2},{value:"\u90A3\u6211\u5462\uFF1F",id:"\u90A3\u6211\u5462",level:2}];function h(n){let e={admonition:"admonition",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:"\u8EAB\u70BA\u4E00\u500B\u5C08\u696D\u7684 PyTorch \u4F7F\u7528\u8005\uFF0C\u4F60\u61C9\u8A72\u65E9\u5DF2\u7D93\u719F\u6089\u4E86\u5982\u4F55\u8A13\u7DF4\u6A21\u578B\uFF0C\u5982\u4F55\u8ABF\u53C3\uFF0C\u5982\u4F55\u512A\u5316\u7B49\u6280\u5DE7\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u600E\u9EBC\u53EF\u80FD\u9084\u6703\u5BEB\u51FA OOM\uFF08Out of Memory\uFF09\u7684\u7A0B\u5F0F\u5462\uFF1F"}),"\n",(0,i.jsx)(e.admonition,{type:"tip",children:(0,i.jsx)(e.p,{children:"\u9019\u88E1\u8B1B\u7684\u662F\u7CFB\u7D71\u7684\u8A18\u61B6\u9AD4\uFF0C\u4E0D\u662F GPU \u7684\u8A18\u61B6\u9AD4\u3002"})}),"\n",(0,i.jsx)(e.h2,{id:"\u554F\u984C\u8AAA\u660E",children:"\u554F\u984C\u8AAA\u660E"}),"\n",(0,i.jsx)(e.p,{children:"\u7531\u65BC OOM \u7684\u6210\u56E0\u592A\u591A\uFF0C\u9019\u6B21\u6211\u5011\u5C31\u53EA\u8B1B\u4E00\u500B\u5C08\u696D\u5DE5\u4F5C\u8005\u4E5F\u5E38\u6703\u9047\u5230\u7684\u554F\u984C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4F60\u53EF\u80FD\u7528\u4E86 List \u7D50\u69CB\u5566\uFF01"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7D93\u904E\u8ABF\u67E5\uFF0C\u6211\u5011\u627E\u5230\u4E86\u6D29\u6F0F\u767C\u751F\u6642\u7684\u78BA\u5207\u5834\u666F\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u8003\u616E\u4E0B\u9762\u7684\u7A0B\u5F0F\u78BC\u7BC4\u4F8B\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from torch.utils.data import Dataset, DataLoader\nimport numpy as np\nimport torch\n\n\nclass DataIter(Dataset):\n\n    def __init__(self):\n        self.data_np = np.array([x for x in range(10000000)])\n        self.data = [x for x in range(10000000)]\n\n    def __len__(self):\n        return len(self.data)\n\n    def __getitem__(self, idx):\n        data = self.data[idx]\n        data = np.array([data], dtype=np.int64)\n        return torch.tensor(data)\n\n\ntrain_data = DataIter()\ntrain_loader = DataLoader(train_data, batch_size=300, num_workers=18)\n\nfor i, item in enumerate(train_loader):\n    if i % 1000 == 0:\n        print(i)\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.p,{children:"\u770B\u5B8C\u9019\u500B\u4F8B\u5B50\uFF0C\u4E0D\u5EE2\u8A71\uFF0C\u76F4\u63A5\u8B1B\u7D50\u8AD6\uFF1A"}),"\n",(0,i.jsxs)(e.p,{children:["\u770B\u5230 ",(0,i.jsx)(e.code,{children:"self.data"})," \u9019\u500B List \u4E86\u55CE\uFF1F\u9019\u500B List \u6703\u5C0E\u81F4 OOM \u554F\u984C\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u5011\u8A66\u8457\u7FFB\u627E\u4E86\u4E00\u4E0B\u76F8\u95DC\u8CC7\u6599\uFF0C\u767C\u73FE\u9019\u4F3C\u4E4E\u4E0D\u662F Pytorch \u7684\u554F\u984C\uFF0C\u800C\u662F Python \u7684\u554F\u984C\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u7E3D\u4E4B\uFF0C\u4E0D\u8981\u7528 List\uFF0C\u6539\u7528 Numpy \u6216\u8005 Tensor \u4F86\u5B58\u5132\u6578\u64DA\uFF0C\u9019\u6A23\u5C31\u4E0D\u6703\u51FA\u73FE OOM \u554F\u984C\u4E86\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u81F3\u5C11\u5728\u9019\u500B\u4F8B\u5B50\u4E2D\uFF0C\u9019\u6A23\u505A\u662F\u6709\u6548\u7684\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u90A3\u6211\u5462",children:"\u90A3\u6211\u5462\uFF1F"}),"\n",(0,i.jsx)(e.p,{children:"\u4F60\u8AAA\uFF1A\u6211\u4E5F\u662F\u9019\u6A23\u5BEB\uFF0C\u70BA\u4EC0\u9EBC\u4EC0\u9EBC\u4E8B\u60C5\u90FD\u6C92\u6709\u767C\u751F\uFF1F"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.p,{children:"\u4E16\u754C\u5F88\u7F8E\u597D\uFF0C\u76F4\u5230\u4F60\u9047\u5230\u4E86\u4E00\u500B\u5927\u6578\u64DA\u96C6\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5C31\u6211\u81EA\u5DF1\u7684\u6E2C\u8A66\u7684\u7D50\u679C\u4F86\u770B\uFF0C\u7576\u6578\u64DA\u91CF\u5C0F\u7684\u6642\u5019\uFF0C\u7528 List \u4E0D\u6703\u51FA\u73FE\u8A18\u61B6\u9AD4\u6D29\u6F0F\u7684\u554F\u984C\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u66F4\u5177\u9AD4\u4F86\u8AAA\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7576\u6211\u5011\u4F7F\u7528\u4E00\u842C\u591A\u7B46\u6578\u64DA\u7684\u6642\u5019\uFF0C\u6C92\u554F\u984C\u5440\uFF01"}),"\n",(0,i.jsx)(e.li,{children:"\u7576\u6211\u5011\u4F7F\u7528\u4E00\u767E\u591A\u842C\u7B46\u6578\u64DA\u7684\u6642\u5019\uFF0C\u5C31\u7206\u5566\uFF01"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6240\u4EE5\uFF0C\u5982\u679C\u4F60\u7684\u6578\u64DA\u91CF\u4E0D\u5927\uFF0C\u4F60\u53EF\u80FD\u6C38\u9060\u4E0D\u6703\u9047\u5230\u9019\u500B\u554F\u984C\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u81F3\u65BC\u6578\u64DA\u591A\u5BE1\u7684\u5206\u754C\u9EDE\uFF0C\u6211\u5011\u4E5F\u4E0D\u77E5\u9053..."}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u5011\u63A8\u6E2C\u9019\u662F Python \u6216\u662F PyTorch \u5728\u4EA4\u4E92\u7684\u67D0\u500B\u6642\u523B\u624D\u6703\u51FA\u73FE\u7684\u7570\u5E38\u3002"})]})}function d(n={}){let{wrapper:e}={...(0,o.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(h,{...n})}):h(n)}},50065:function(n,e,t){t.d(e,{Z:function(){return s},a:function(){return a}});var r=t(67294);let i={},o=r.createContext(i);function a(n){let e=r.useContext(o);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),r.createElement(o.Provider,{value:e},n.children)}},5540:function(n){n.exports=JSON.parse('{"permalink":"/blog/pytorch-training-out-of-memory","source":"@site/blog/2024/02-20-pytorch-training-oom/index.md","title":"PyTorch \u7684 List \u9677\u9631","description":"\u767C\u73FE\u8207\u89E3\u6C7A PyTorch OOM \u554F\u984C\u3002","date":"2024-02-20T00:00:00.000Z","tags":[{"inline":true,"label":"PyTorch","permalink":"/blog/tags/py-torch"},{"inline":true,"label":"OOM","permalink":"/blog/tags/oom"}],"readingTime":2.485,"hasTruncateMarker":true,"authors":[{"name":"Zephyr","title":"Dosaid maintainer, Full-Stack AI Engineer","url":"https://github.com/zephyr-sh","socials":{"github":"https://github.com/zephyr-sh"},"imageURL":"https://github.com/zephyr-sh.png","key":"Zephyr","page":null}],"frontMatter":{"slug":"pytorch-training-out-of-memory","title":"PyTorch \u7684 List \u9677\u9631","authors":"Zephyr","tags":["PyTorch","OOM"],"image":"/img/2024/0220.webp","description":"\u767C\u73FE\u8207\u89E3\u6C7A PyTorch OOM \u554F\u984C\u3002"},"unlisted":false,"prevItem":{"title":"\u642D\u5EFA Nextcloud \u8A18\u9304","permalink":"/blog/setting-up-nextcloud"},"nextItem":{"title":"\u4F7F\u7528 Python \u628A PDF \u8F49\u5716\u7247","permalink":"/blog/convert-pdf-to-images"}}')}}]);