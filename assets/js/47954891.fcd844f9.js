"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["6125"],{76408:function(n,e,i){i.r(e),i.d(e,{default:()=>h,frontMatter:()=>t,metadata:()=>r,assets:()=>c,toc:()=>d,contentTitle:()=>x});var r=JSON.parse('{"id":"vision-transformers/mlp-mixer/index","title":"[21.05] MLP-Mixer","description":"\u5C11\u8667\u5C31\u662F\u8CFA","source":"@site/papers/vision-transformers/2105-mlp-mixer/index.md","sourceDirName":"vision-transformers/2105-mlp-mixer","slug":"/vision-transformers/mlp-mixer/","permalink":"/papers/vision-transformers/mlp-mixer/","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"zephyr-sh","lastUpdatedAt":1739242156000,"frontMatter":{"title":"[21.05] MLP-Mixer","authors":"Z. Yuan"},"sidebar":"papersSidebar","previous":{"title":"[21.03] Swin Transformer","permalink":"/papers/vision-transformers/swin-transformer/"},"next":{"title":"[21.06] BEiT","permalink":"/papers/vision-transformers/beit/"}}'),s=i("85893"),l=i("50065");let t={title:"[21.05] MLP-Mixer",authors:"Z. Yuan"},x=void 0,c={},d=[{value:"\u5C11\u8667\u5C31\u662F\u8CFA",id:"\u5C11\u8667\u5C31\u662F\u8CFA",level:2},{value:"\u5B9A\u7FA9\u554F\u984C",id:"\u5B9A\u7FA9\u554F\u984C",level:2},{value:"\u89E3\u6C7A\u554F\u984C",id:"\u89E3\u6C7A\u554F\u984C",level:2},{value:"\u6A21\u578B\u67B6\u69CB",id:"\u6A21\u578B\u67B6\u69CB",level:3},{value:"\u8A0E\u8AD6",id:"\u8A0E\u8AD6",level:3},{value:"ImageNet \u4E0A\u7684\u6027\u80FD",id:"imagenet-\u4E0A\u7684\u6027\u80FD",level:3},{value:"\u53EF\u8996\u5316\u5206\u6790",id:"\u53EF\u8996\u5316\u5206\u6790",level:3},{value:"\u7D50\u8AD6",id:"\u7D50\u8AD6",level:2}];function a(n){let e={a:"a",admonition:"admonition",code:"code",del:"del",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.a)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h2,{id:"\u5C11\u8667\u5C31\u662F\u8CFA",children:"\u5C11\u8667\u5C31\u662F\u8CFA"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://arxiv.org/abs/2105.01601",children:(0,s.jsx)(e.strong,{children:"MLP-Mixer: An all-MLP Architecture for Vision"})})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.p,{children:"\u5728 Transformer \u88AB\u5F15\u5165\u96FB\u8166\u8996\u89BA\u7684\u9818\u57DF\u4E4B\u5F8C\uFF0C\u8A31\u591A\u7814\u7A76\u958B\u59CB\u63A2\u7D22\u5982\u4F55\u8B93\u6BCF\u500B Patch \u9593\u7684\u8CC7\u8A0A\u4EA4\u63DB\u66F4\u6709\u6548\u7387\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u70BA\u6B64\uFF0C\u4E00\u500B\u65B0\u7684\u540D\u8A5E\u61C9\u904B\u800C\u751F\uFF1A\u300CToken-Mixer\u300D\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u9867\u540D\u601D\u7FA9\uFF0CToken-Mixer \u7684\u76EE\u7684\u662F\u5C07\u4E0D\u540C\u7684 Patch \u4E4B\u9593\u7684\u8CC7\u8A0A\u9032\u884C\u6DF7\u5408\uFF0C\u4EE5\u63D0\u5347\u6A21\u578B\u7684\u6027\u80FD\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u50B3\u7D71\u7684\u81EA\u6CE8\u610F\u529B\u6A5F\u5236\uFF0C\u5C31\u662F\u5176\u4E2D\u4E00\u7A2E Token-Mixer \u7684\u5BE6\u73FE\u65B9\u5F0F\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u7136\u800C\uFF0C\u5728\u539F\u59CB\u7684\u6CE8\u610F\u529B\u6A5F\u5236\u4E2D\uFF0C\u7531\u65BC\u8A08\u7B97\u8907\u96DC\u5EA6\u6975\u9AD8\uFF0C\u56E0\u6B64\u5B78\u8853\u754C\u958B\u59CB\u5C0B\u627E\u66FF\u4EE3\u65B9\u6848\u3002"}),"\n",(0,s.jsx)(e.p,{children:"MLP-Mixer \u4FBF\u662F\u5176\u4E2D\u4E4B\u4E00\u3002"}),"\n",(0,s.jsx)(e.admonition,{type:"tip",children:(0,s.jsx)(e.p,{children:"Token-Mixer \u662F\u5F8C\u4F86\u8AD6\u6587\u6B78\u7D0D\u51FA\u4F86\u7684\u540D\u8A5E\uFF0C\u4E26\u975E\u672C\u7BC7\u8AD6\u6587\u63D0\u51FA\u7684\u5C08\u6709\u540D\u8A5E\u3002"})}),"\n",(0,s.jsx)(e.h2,{id:"\u5B9A\u7FA9\u554F\u984C",children:"\u5B9A\u7FA9\u554F\u984C"}),"\n",(0,s.jsx)(e.p,{children:"\u4F5C\u8005\u8A8D\u70BA\uFF1A\u81EA\u6CE8\u610F\u529B\u7684\u8907\u96DC\u5EA6\u592A\u9AD8\u4E86\uFF0C\u4E0D\u5982\u6211\u5011\u628A\u5B83\u6574\u500B\u6572\u6389\u5427\uFF01"}),"\n",(0,s.jsx)(e.p,{children:"\u81F3\u65BC\u6572\u6389\u4E4B\u5F8C\u8981\u600E\u9EBC\u8FA6\u5462\uFF1F"}),"\n",(0,s.jsx)(e.p,{children:"\u563F\uFF01\u4F60\u770B\uFF0C\u8DEF\u908A\u4E0D\u662F\u6709\u500B\u7C21\u55AE\u7684\u5168\u9023\u63A5\u5C64\u55CE\uFF1F\u62FF\u4F86\u7528\u554A\uFF01"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.del,{children:"\u7136\u5F8C\u9019\u7BC7\u8AD6\u6587\u5C31\u8B1B\u5B8C\u4E86\u3002"}),"\uFF08\u4E26\u6C92\u6709\uFF01\uFF09"]}),"\n",(0,s.jsx)(e.h2,{id:"\u89E3\u6C7A\u554F\u984C",children:"\u89E3\u6C7A\u554F\u984C"}),"\n",(0,s.jsx)(e.h3,{id:"\u6A21\u578B\u67B6\u69CB",children:"\u6A21\u578B\u67B6\u69CB"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"MLP-Mixer \u6A21\u578B\u67B6\u69CB",src:i(66440).Z+"",width:"1456",height:"772"})}),"\n",(0,s.jsx)(e.p,{children:"\u4F5C\u8005\u5728\u672C\u7BC7\u8AD6\u6587\u4E2D\u63D0\u51FA\u4F7F\u7528\u5169\u500B\u968E\u6BB5\u7684\u5168\u9023\u63A5\u5C64\uFF0C\u4E5F\u5C31\u662F MLP\uFF08\u591A\u5C64\u611F\u77E5\u5668\uFF09\uFF0C\u4F86\u9032\u884C\u8CC7\u8A0A\u4EA4\u63DB\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u4E0A\u9762\u9019\u5F35\u5716\u53EF\u80FD\u4E0D\u597D\u61C2\uFF0C\u6C92\u95DC\u4FC2\uFF0C\u8B93\u6211\u5011\u6309\u6B65\u9A5F\u4F86\uFF1A"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u8F38\u5165\u4E00\u5F35 3 x 224 x 224 \u7684\u5F71\u50CF\uFF0C\u5C07\u5176\u5207\u5272\u6210 16 x 16 \u7684 Patchs\uFF0C\u7DAD\u5EA6\u6211\u5011\u5047\u8A2D\u7528 512\u3002"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5C3A\u5BF8\u8B8A\u5316\uFF1A[B x 3 x 224 x 224] -> [B x 512 x 14 x 14]\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u8F49\u63DB\u6210 Transformer \u8F38\u5165\u3002"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5C3A\u5BF8\u8B8A\u5316\uFF1A[B x 512 x 14 x 14] -> [B x 512 x 196]\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u7B2C\u4E00\u968E\u6BB5\uFF1A\u4EA4\u63DB Patch \u4E4B\u9593\u7684\u8CC7\u8A0A\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import torch.nn as nn\n\npatch_mixer = nn.Linear(196, 196)\n\n# \u8F38\u5165\u7DAD\u5EA6\uFF1Ax = [B x 512 x 196]\nx_mix_patch = patch_mixer(x)\n\n# skip connection\n x = x + x_mix_patch\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u7B2C\u4E8C\u968E\u6BB5\uFF1A\u4EA4\u63DB Channel \u4E4B\u9593\u7684\u8CC7\u8A0A\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import torch.nn as nn\n\nchannel_mixer = nn.Linear(512, 512)\n\n# \u8F38\u5165\u7DAD\u5EA6\uFF1Ax = [B x 512 x 196]\n# \u5148 Reshape -> [B x 196 x 512]\nx_mix_channel = x.permute(0, 2, 1)\nx_mix_channel = channel_mixer(x_mix_channel)\n\n# Reshape \u56DE\u4F86\nx_mix_channel = x_mix_channel.permute(0, 2, 1)\n\n# skip connection\nx = x + x_mix_channel\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u5230\u9019\u908A\u5C31\u5B8C\u6210\u4E86\u4E00\u6B21 MLP-Mixer \u7684\u904B\u7B97\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u4F60\u6703\u767C\u73FE\u5728\u4E0A\u9762\u7684\u6D41\u7A0B\u4E2D\uFF0C\u7B2C\u4E8C\u968E\u6BB5\u548C\u539F\u672C\u7684\u81EA\u6CE8\u610F\u529B\u6A5F\u5236\u662F\u4E00\u6A23\u7684\uFF0C\u539F\u672C\u7684\u81EA\u6CE8\u610F\u529B\u6A5F\u5236\u4E5F\u6703\u6709\u4E00\u500B MLP \u7684\u904B\u7B97\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u4E0D\u4E00\u6A23\u7684\u5730\u65B9\u5C31\u662F\u5728\u7B2C\u4E00\u968E\u6BB5\uFF0C\u539F\u672C\u8981\u7B97\u7684\u662F Patch \u81EA\u6CE8\u610F\u529B\u5716\uFF0C\u73FE\u5728\u76F4\u63A5\u7528\u5168\u9023\u63A5\u5C64\u4F86\u7B97\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"\u8A0E\u8AD6",children:"\u8A0E\u8AD6"}),"\n",(0,s.jsx)(e.h3,{id:"imagenet-\u4E0A\u7684\u6027\u80FD",children:"ImageNet \u4E0A\u7684\u6027\u80FD"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"MLP-Mixer on ImageNet 1",src:i(5770).Z+"",width:"1444",height:"560"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"mlp-mixer on imagenet 2",src:i(51655).Z+"",width:"1224",height:"696"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"\u300CImNet\u300D\u548C\u300CReaL\u300D\u6B04\u4F4D\uFF1A\u5206\u5225\u4EE3\u8868\u539F\u59CB ImageNet \u9A57\u8B49\u96C6\u548C\u6E05\u7406\u5F8C\u7684 ReaL \u6A19\u7C64\u96C6\u7684\u7D50\u679C\u3002"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Avg 5\uFF1A\u8868\u793A\u4E94\u500B\u4E0B\u6E38\u4EFB\u52D9\uFF08ImageNet\u3001CIFAR-10\u3001CIFAR-100\u3001Pets\u3001Flowers\uFF09\u7684\u5E73\u5747\u6548\u80FD\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.p,{children:"\u5728 ImageNet-21k \u4E0A\u9810\u8A13\u7DF4\u4E26\u9032\u884C\u984D\u5916\u6B63\u5247\u5316\u6642\uFF0CMLP-Mixer \u5728 ImageNet \u4E0A\u9054\u5230 84.15% \u7684 top-1 \u6E96\u78BA\u7387\uFF0C\u8868\u73FE\u5F37\u52C1\u4F46\u7565\u905C\u65BC\u5176\u4ED6\u6A21\u578B\u3002\u6C92\u6709\u6B63\u5247\u5316\u6642\uFF0CMixer \u5BB9\u6613\u904E\u5EA6\u64EC\u5408\uFF0C\u9019\u8207 ViT \u7684\u89C0\u5BDF\u7D50\u679C\u4E00\u81F4\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u7576\u5728 ImageNet \u4E0A\u5F9E\u96A8\u6A5F\u521D\u59CB\u5316\u8A13\u7DF4 MLP-Mixer \u6642\uFF0CMixer-B/16 \u5728\u89E3\u6790\u5EA6 224 \u4E0B\u53D6\u5F97 76.4% \u7684\u5206\u6578\uFF0C\u8207\u666E\u901A ResNet50 \u985E\u4F3C\uFF0C\u4F46\u4F4E\u65BC\u5176\u4ED6\u6700\u5148\u9032\u7684 CNN/\u6DF7\u5408\u6A21\u578B\uFF0C\u4F8B\u5982 84.7% \u7684 BotNet \u548C 86.5% \u7684 NFNet\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u7576\u4E0A\u6E38\u8CC7\u6599\u96C6\u5927\u5C0F\u589E\u52A0\u6642\uFF0CMLP-Mixer \u7684\u6548\u80FD\u986F\u8457\u63D0\u9AD8\u3002"}),"\n",(0,s.jsx)(e.p,{children:"Mixer-H/14 \u5728 ImageNet \u4E0A\u5BE6\u73FE\u4E86 87.94% \u7684 top-1 \u6E96\u78BA\u7387\uFF0C\u6BD4 BiT-ResNet152x4 \u63D0\u9AD8\u4E86 0.5%\uFF0C\u50C5\u6BD4 ViT-H/14 \u4F4E 0.5%\u3002Mixer-H/14 \u7684\u904B\u884C\u901F\u5EA6\u6BD4 ViT-H/14 \u5FEB 2.5 \u500D\uFF0C\u5E7E\u4E4E\u662F BiT \u7684\u5169\u500D\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u5728\u7CBE\u5EA6\u8A08\u7B97\u6B0A\u8861\u65B9\u9762\uFF0CMixer \u8207\u66F4\u50B3\u7D71\u7684\u795E\u7D93\u7DB2\u8DEF\u67B6\u69CB\u5177\u6709\u7AF6\u722D\u529B\u3002\u8DE8\u67B6\u69CB\u985E\u5225\u7684\u7E3D\u9810\u8A13\u7DF4\u6210\u672C\u8207\u4E0B\u6E38\u6E96\u78BA\u6027\u4E4B\u9593\u5B58\u5728\u660E\u986F\u7684\u76F8\u95DC\u6027\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"\u53EF\u8996\u5316\u5206\u6790",children:"\u53EF\u8996\u5316\u5206\u6790"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"MLP-Mixer Visualization",src:i(66391).Z+"",width:"1852",height:"606"})}),"\n",(0,s.jsx)(e.p,{children:"\u4EBA\u5011\u666E\u904D\u89C0\u5BDF\u5230\uFF0CCNN \u7684\u7B2C\u4E00\u5C64\u50BE\u5411\u65BC\u5B78\u7FD2\u985E\u4F3C Gabor \u7684\u5075\u6E2C\u5668\uFF0C\u4F5C\u7528\u65BC\u5F71\u50CF\u5C40\u90E8\u5340\u57DF\u7684\u50CF\u7D20\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u76F8\u8F03\u4E4B\u4E0B\uFF0CMLP-Mixer \u5141\u8A31\u5728 Token \u8CC7\u8A0A\u5728 MLP \u4E2D\u9032\u884C\u5168\u57DF\u8CC7\u8A0A\u4EA4\u63DB\uFF0C\u9019\u5C31\u5F15\u51FA\u4E86\u4E00\u500B\u554F\u984C\uFF1A"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5B83\u662F\u5426\u4EE5\u985E\u4F3C\u7684\u65B9\u5F0F\u8655\u7406\u8CC7\u8A0A\uFF1F"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u70BA\u4E86\u56DE\u7B54\u9019\u500B\u554F\u984C\uFF0C\u4F5C\u8005\u5C07 MLP-Mixer \u7684\u4E0D\u540C\u5C64\u7684\u7279\u5FB5\u8996\u89BA\u5316\uFF0C\u53EF\u4EE5\u770B\u5230\u4E0D\u540C\u5C64\u6B21\u7684\u7279\u5FB5\u63D0\u53D6\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u5728\u4E0A\u5716\u4E2D\uFF0C\u5F9E\u5DE6\u5230\u53F3\u5206\u5225\u662F MLP-Mixer \u7684\u7B2C\u4E00\u5C64\uFF0C\u7B2C\u4E8C\u5C64\u548C\u7B2C\u4E09\u5C64\uFF0C\u6211\u5011\u53EF\u4EE5\u770B\u5230\uFF1A"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4E00\u4E9B\u5B78\u7FD2\u5230\u7684\u7279\u5FB5\u5C0D\u6574\u500B\u5716\u50CF\u8D77\u4F5C\u7528\uFF0C\u800C\u53E6\u4E00\u4E9B\u5247\u5C0D\u8F03\u5C0F\u7684\u5340\u57DF\u8D77\u4F5C\u7528\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u66F4\u6DF1\u7684\u5C64\u4F3C\u4E4E\u6C92\u6709\u6E05\u6670\u53EF\u8FA8\u7684\u7D50\u69CB\u3002"}),"\n",(0,s.jsx)(e.li,{children:"\u8207 CNN \u985E\u4F3C\uFF0C\u5176\u4E2D\u6709\u8A31\u591A\u5C0D\u5177\u6709\u76F8\u53CD\u76F8\u4F4D\u7684\u7279\u5FB5\u5075\u6E2C\u5668\u3002"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u7D50\u8AD6",children:"\u7D50\u8AD6"}),"\n",(0,s.jsx)(e.p,{children:"\u5C11\u8667\u5C31\u662F\u8CFA\uFF01"}),"\n",(0,s.jsx)(e.p,{children:"\u6BD4\u8D77\u539F\u672C\u7684\u81EA\u6CE8\u610F\u529B\u6A5F\u5236\uFF0CMLP-Mixer \u964D\u4F4E\u4E86\u5927\u91CF\u7684\u8A08\u7B97\uFF0C\u5C31\u7B97\u6548\u679C\u7A0D\u5DEE\uFF0C\u4E5F\u662F\u5F88\u6709\u5E02\u5834\uFF01"})]})}function h(n={}){let{wrapper:e}={...(0,l.a)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}},66440:function(n,e,i){i.d(e,{Z:function(){return r}});let r=i.p+"assets/images/img1-78c8d6489cfcb34be173bdfb58f51d97.jpg"},51655:function(n,e,i){i.d(e,{Z:function(){return r}});let r=i.p+"assets/images/img2-4d3bfe5dfac398843b2a64bc8dd8b2a2.jpg"},5770:function(n,e,i){i.d(e,{Z:function(){return r}});let r=i.p+"assets/images/img3-08541f3cd9b07db2792604d1748364d9.jpg"},66391:function(n,e,i){i.d(e,{Z:function(){return r}});let r=i.p+"assets/images/img4-972e48efecf9e99daf8744617bcbe123.jpg"},50065:function(n,e,i){i.d(e,{Z:function(){return x},a:function(){return t}});var r=i(67294);let s={},l=r.createContext(s);function t(n){let e=r.useContext(l);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function x(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:t(n.components),r.createElement(l.Provider,{value:e},n.children)}}}]);