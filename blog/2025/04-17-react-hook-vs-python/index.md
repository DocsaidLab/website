---
slug: react-hook-vs-python
title: React åˆ°åº•åœ¨ Hook ä»€éº¼ï¼Ÿ
authors: Z. Yuan
image: /img/2025/0417.jpg
tags: [react, hook]
description: æ‹†è§£ React Hook èƒŒå¾Œçš„æ¦‚å¿µã€‚
---

å¹¾å¹´å‰å‰›é–‹å§‹å­¸ React çš„æ™‚å€™ï¼Œç¸½è¦ºå¾— React å½·å½¿æ´»åœ¨å¹³è¡Œæ™‚ç©ºï¼Œé›£ä»¥ç†è§£ã€‚

ä½ çœ‹çœ‹é€™å€‹ Hookï¼Œä¹Ÿå¤ªåäººé¡çš„å§ï¼Ÿ

<!-- truncate -->

## å¾ Python é–‹å§‹

ä½ å¯èƒ½ä¹Ÿå’Œæˆ‘ä¸€æ¨£ï¼Œéƒ½æ¯”è¼ƒæ“…é•·ç”¨ Pythonï¼Œæ‰€ä»¥æˆ‘å€‘å…ˆå¾ Python é–‹å§‹å§ï¼

å…ˆä¾†çœ‹ä¸€ä¸‹æœ€ç°¡å–®çš„è¨ˆæ•¸å™¨ï¼Œåœ¨ React ä¸­ï¼Œæˆ‘å€‘æœƒé€™æ¨£å¯«ï¼š

```jsx
import { useState } from "react";

function Counter() {
  const [count, setCount] = useState(0);

  function handleClick() {
    setCount(count + 1);
  }

  return <button onClick={handleClick}>Clicked! Count = {count}</button>;
}

export default Counter;
```

å¦‚æœè®“ä½ ç”¨ Python ä¾†å¯«è¨ˆæ•¸å™¨ï¼Œä½ æœƒæ€éº¼å¯«ï¼Ÿ

ä½ èªªå¾ˆç°¡å–®ï¼Ÿç•¶ç„¶æ˜¯ç”¨ OOP å¯«å•Šï¼

## å‚³çµ± OOP å¯«æ³•

æˆ‘å¯«èµ·ä¾†æ˜¯é€™æ¨£çš„ï¼Œé€™é¡Œæœ¬èº«æ²’ä»€éº¼é›£åº¦ï¼š

```python
class Counter:

    def __init__(self):
        self.count = 0

    def handle_click(self):
        self.count += 1
        self.render()

    def render(self):
        print(f"Clicked! Count = {self.count}")


# ä½¿ç”¨
counter = Counter()
counter.handle_click()  # é»ä¸€ä¸‹
counter.handle_click()  # å†é»ä¸€ä¸‹
```

ä½†é€™å€‹å¯«æ³•ï¼Œå’Œä¸Šé¢çš„ React é›£ä»¥å°ç…§ï¼Œæ‰€ä»¥æˆ‘å€‘æ¥è‘—æ›å€‹å¯«æ³•ï¼š

## å‡½æ•¸å¼ + ç‹€æ…‹ç¶å®š

ä¸ä½¿ç”¨é¡åˆ¥ï¼Œæˆ‘å€‘ç›´æ¥å®šç¾©ä¸€å€‹å‡½æ•¸ï¼ŒæŠŠã€Œç‹€æ…‹ã€å’Œã€Œæ¸²æŸ“é‚è¼¯ã€æ‹†é–‹ï¼Œç”¨ç´”å‡½æ•¸ï¼‹é–‰åŒ…ç®¡ç†ç‹€æ…‹ï¼š

```python
def use_state(initial_value):

    state = {"value": initial_value}

    def get_value():
        return state["value"]

    def set_value(new_value):
        state["value"] = new_value

    return get_value, set_value
```

åˆ°é€™é‚Šï¼Œæœ‰æ²’æœ‰è¦ºå¾—æœ‰é»åƒäº†ï¼Ÿ

æ¥è‘—ï¼Œæˆ‘å€‘å»ºç«‹ä¸€å€‹ç‹€æ…‹ï¼š

```python
get_count, set_count = use_state(0)
```

é€™å·²ç¶“æ˜¯ç´”ç´”çš„ Pythonï¼Œåˆ¥å†èªªæˆ‘åœ¨å¯« React äº†ã€‚

å–å¾— `get_count` å’Œ `set_count` å…©å€‹å‡½æ•¸ï¼Œç„¶å¾Œæˆ‘å€‘ä¾†å¯«ä¸€å€‹ã€Œé»é¸äº‹ä»¶ã€å‡½æ•¸ï¼š

```python
def render():
    print(f"Clicked! Count = {get_count()}")

def handle_click():
    set_count(get_count() + 1)
    render()
```

ç„¶å¾Œæˆ‘å€‘ä¾†æ¨¡æ“¬é»æ“Šå…©æ¬¡ï¼š

```python
handle_click()
handle_click()
```

è¼¸å‡ºçµæœï¼š

```python
Clicked! Count = 1
Clicked! Count = 2
```

æ©ï¼Ÿé€™ä¸å°±æ˜¯æˆ‘å€‘å‰›æ‰åœ¨ React åšçš„äº‹æƒ…å—ï¼Ÿ

## OOP vs å‡½æ•¸å¼

ä½ å¯èƒ½æœƒå•ï¼Œé‚£ç‚ºä»€éº¼ React ä¸ç”¨ OOPï¼Ÿ

ç”¨é¡åˆ¥ä¸æ˜¯æ¯”è¼ƒç›´è¦ºå—ï¼Ÿåƒæˆ‘å€‘å‰›æ‰ç”¨ Python å¯«çš„ `Counter` é¡åˆ¥ï¼Œç‹€æ…‹ä¸€ç›®äº†ç„¶ï¼

æˆ‘å€‘å›åˆ°å‰›æ‰çš„ç¯„ä¾‹ï¼Œçœ‹çœ‹é€™å…©ç¨®æ€ç¶­åœ¨ã€Œç‹€æ…‹ç®¡ç†ã€ä¸Šçš„å¯¦éš›å·®ç•°ã€‚

ç”¨ Python OOP å¯«è¨ˆæ•¸å™¨ï¼Œé€™ç¨®å¯«æ³•å°±åƒä½ åœ¨å¯«æ¡Œé¢æ‡‰ç”¨ç¨‹å¼ï¼Œæ•´å€‹å…ƒä»¶åŒ…åœ¨ä¸€å€‹é¡åˆ¥è£¡ï¼š

- `self.count` æ˜¯ç‹€æ…‹ã€‚
- `handle_click` æ˜¯äº‹ä»¶è™•ç†ã€‚
- `render` æ˜¯æ›´æ–°ç•«é¢ã€‚

å„ªé»æ˜¯çµæ§‹æ¸…æ¥šã€è¡Œç‚ºå°è£å¥½ã€‚

ä½†å•é¡Œä¾†äº†ï¼šç•¶é€™å€‹å…ƒä»¶è¶Šä¾†è¶Šè¤‡é›œæ™‚ï¼Œä½ å¯èƒ½è¦ç®¡ç†å¥½å¹¾å€‹ç‹€æ…‹ï¼ˆä¾‹å¦‚å€’æ•¸è¨ˆæ™‚ã€èƒŒæ™¯è‰²ã€éŒ¯èª¤æç¤ºç­‰ï¼‰ï¼Œé€™äº›éƒ½å¡é€² selfï¼Œå¾ˆå¿«åœ°ï¼Œä½ çš„ç¨‹å¼å°±æœƒè®Šé€™æ¨£ï¼š

```python
self.count
self.timer
self.error_message
self.loading
self.is_dark_mode
self.is_visible
self.is_editable
self.is_submitting
self.is_valid
self.is_disabled
```

ç„¶å¾Œä½ é–‹å§‹æ‡·ç–‘äººç”Ÿã€‚

## å‡½æ•¸å¼æ€ç¶­

React ç”¨ Hookï¼Œå¯¦éš›ä¸Šæ˜¯æŠŠç‹€æ…‹é‚è¼¯æŠ½å‡ºä¾†è®Šæˆä¸€å€‹å€‹å°å‡½æ•¸ï¼Œè®“ä½ å¯ä»¥ã€Œæ‹¼ã€å‡ºå…ƒä»¶åŠŸèƒ½ã€‚

é‚„è¨˜å¾—æˆ‘å€‘çš„ `use_state` å—ï¼Ÿ

```python
get_count, set_count = use_state(0)
```

ä½ ç¾åœ¨æœ‰å…©å€‹å‡½æ•¸ `get_count()` å’Œ `set_count()`ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼Œä¸éœ€è¦ä¸€å€‹é¡åˆ¥ä¾†ä¿å­˜é€™äº›è³‡è¨Šã€‚

**é€™ä¹Ÿæ˜¯ Hook çš„ç²¾é«“ï¼šç‹€æ…‹å°±è¢«ç¶åœ¨é‚£è£¡ï¼Œåªè¦ä½ èƒ½æ‹¿åˆ° `get_count()` æˆ– `set_count()`ï¼Œå°±èƒ½éš¨æ™‚å–å¾—å’Œæ›´æ–°å®ƒã€‚å°±åƒæ‹¿è‘—ä¸€å€‹æ›é‰¤ (Hook)ï¼Œéš¨æ™‚å¯ä»¥å‹¾ä½é‚£æ®µç‹€æ…‹ï¼ŒæŠŠå®ƒæ‹‰å‡ºä¾†ç”¨ã€‚**

ä¸ä¿¡ï¼Ÿé‚£æˆ‘å€‘ä¸€èµ·ä¾†è©¦è©¦çœ‹åŠ å€‹åŠŸèƒ½ï¼šã€Œæ¯äº”æ¬¡é»æ“Šè¦æé†’ä¸€æ¬¡ã€‚ã€

- **ç”¨ OOP å¯«**

  ```python
  class Counter:

      def __init__(self):
          self.count = 0

      def handle_click(self):
          self.count += 1
          if self.count % 5 == 0:
              print("ğŸ‰ ä½ é»äº† 5 æ¬¡ï¼")
          self.render()

      def render(self):
          print(f"Clicked! Count = {self.count}")
  ```

- **ç”¨å‡½æ•¸å¼å¯«**

  ```python
  get_count, set_count = use_state(0)

  def use_celebrate_every(n):
      def check():
          if get_count() % n == 0 and get_count() != 0:
              print(f"ğŸ‰ ä½ é»äº† {n} æ¬¡ï¼")
      return check

  celebrate = use_celebrate_every(5)

  def handle_click():
      set_count(get_count() + 1)
      celebrate()
      render()

  def render():
      print(f"Clicked! Count = {get_count()}")
  ```

  é€™é‚Šæˆ‘å€‘æŠŠã€Œæ¯ n æ¬¡è§¸ç™¼æé†’ã€é€™ä»¶äº‹æ‹†æˆä¸€å€‹ç¨ç«‹çš„ Hookï¼š`use_celebrate_every(n)`ï¼Œä½ å¯ä»¥æ‹¿ä¾†çµ¦ä»»ä½•éœ€è¦ã€Œå®šæ™‚æé†’ã€çš„å…ƒä»¶ç”¨ã€‚

  é€™å°±æ˜¯ å‡½æ•¸å¼çš„åŠ›é‡ï¼šä½ æŠŠåŠŸèƒ½è®Šæˆä¸€å¡Šå¡Šç©æœ¨ï¼Œæ‹†è§£ã€é‡çµ„ã€å…±ç”¨éƒ½æ›´å®¹æ˜“ã€‚

---

ä½†å‡½æ•¸å¼çœ‹èµ·ä¾†å°±æ˜¯æ¯”è¼ƒè¤‡é›œå•Šï¼

æ²’é—œä¿‚ï¼Œæˆ‘å€‘å†ä¾†çœ‹ä¸€å€‹ä¾‹å­ã€‚

äº‹å¯¦ä¸Šï¼Œå¦‚æœåªæ˜¯è¦å¯«ä¸€å€‹ç°¡å–®çš„æŒ‰éˆ•ï¼ŒOOP æ¯”å‡½æ•¸å¼ç›´è§€å¤ªå¤šäº†ã€‚

ä½† React ä¸æ˜¯ç‚ºäº†è®“ä½ ã€Œå¯«ä¸€å€‹æŒ‰éˆ•ã€ï¼Œè€Œæ˜¯è®“ä½ èƒ½å¤ ã€Œçµ„è£ä¸€æ•´å€‹æ‡‰ç”¨ã€ã€‚

æ‰€ä»¥æˆ‘å€‘è¦å•çš„å…¶å¯¦ä¸æ˜¯ï¼šã€Œèª°æ¯”è¼ƒç°¡å–®ï¼Ÿã€

è€Œæ˜¯ï¼šã€Œ**ç•¶äº‹æƒ…è®Šè¤‡é›œçš„æ™‚å€™ï¼Œèª°é‚„æ’å¾—ä½ï¼Ÿ**ã€

## æ›å€‹å ´æ™¯ä¾†æƒ³

å‡è¨­ä½ ä¸€é–‹å§‹å¯«ä¸€å€‹ç°¡å–®çš„å…ƒä»¶ï¼Œé•·é€™æ¨£ï¼š

```jsx
function LoginForm() {
  const [username, setUsername] = useState("");
  return (
    <input value={username} onChange={(e) => setUsername(e.target.value)} />
  );
}
```

æ²’å•é¡Œï¼Œä¹¾æ·¨ç°¡å–®ã€‚

ä½†æ¥ä¸‹ä¾†ï¼Œç”¢å“ç¶“ç†ä¾†äº†ï¼Œä»–èªªï¼š

1. ç™»å…¥æ™‚è¦é¡¯ç¤º loading å‹•ç•«ã€‚
2. éŒ¯èª¤è¨Šæ¯è¦ 3 ç§’å¾Œè‡ªå‹•æ¶ˆå¤±ã€‚
3. è¨˜ä½ä½¿ç”¨è€…çš„å¸³è™Ÿï¼Œå„²å­˜åœ¨ localStorageã€‚
4. è¼¸å…¥å®Œè¦è‡ªå‹• focus å¯†ç¢¼æ¬„ä½ã€‚
5. è‹¥ä½¿ç”¨è€…é€£çºŒå¤±æ•—ä¸‰æ¬¡ï¼Œé–å¸³è™Ÿ 30 ç§’ã€‚

é€™æ™‚ä½ è¦è™•ç†ï¼š

- loading ç‹€æ…‹
- éŒ¯èª¤è¨Šæ¯é¡¯ç¤ºèˆ‡è‡ªå‹•æ¸…é™¤
- å‰¯ä½œç”¨ï¼šlocalStorage æ“ä½œã€focus æ§åˆ¶
- æ™‚é–“é‚è¼¯ï¼šé–å®šè¨ˆæ™‚å™¨

## å¦‚æœç”¨ OOP å¯«ï¼Ÿ

ä½ å¯èƒ½å¯«æˆé€™æ¨£ï¼š

```python
class LoginForm:

    def __init__(self):
        self.username = ""
        self.loading = False
        self.error_message = ""
        self.failed_attempts = 0
        self.lock_until = None
        # ç„¶å¾Œå†å¯«ä¸€å †æ–¹æ³•ï¼šhandle_inputã€handle_submitã€handle_error...

```

ç‹€æ…‹å¡åœ¨ä¸€èµ·ã€é‚è¼¯æ•£åœ¨åå¹¾å€‹æ–¹æ³•è£¡ï¼Œä¸€è¨€ä¸åˆå°±çˆ†ç‚¸ï¼Ÿ

ä½ æƒ³é‡ç”¨ã€ŒéŒ¯èª¤è¨Šæ¯æ¶ˆå¤±å€’æ•¸ä¸‰ç§’ã€é€™å€‹è¡Œç‚ºï¼Ÿå°ä¸èµ·ï¼Œé‚£æ˜¯ `LoginForm` ç§æœ‰çš„ï¼Œåˆ¥äººä¸èƒ½é‡ç”¨ã€‚ä½ åªèƒ½é¸æ“‡é‡å¯«åŒæ¨£åŠŸèƒ½çš„ç¨‹å¼ç¢¼ï¼Œæˆ–æ˜¯ç›´æ¥ç¹¼æ‰¿é‚£å€‹é¡åˆ¥ã€‚

## é‚£å¦‚æœç”¨å‡½æ•¸å¼å‘¢ï¼Ÿ

ä½ å¯ä»¥é€™æ¨£æ‹†ï¼š

```jsx
const [username, setUsername] = useState("");
const [loading, setLoading] = useState(false);
const errorMessage = useTimedError(3000); // éŒ¯èª¤è¨Šæ¯é¡¯ç¤ºä¸‰ç§’
useLocalStorage("last-username", username); // è‡ªå‹•è¨˜å¸³è™Ÿ
useAutoFocus(ref); // èšç„¦æ¬„ä½
useLoginRateLimit(); // å¤±æ•—æ¬¡æ•¸é™åˆ¶
```

æ¯ä¸€å€‹éœ€æ±‚ï¼Œéƒ½å¯ä»¥è¢«å°è£æˆä¸€å€‹ã€ŒHook æ¨¡çµ„ã€ï¼Œä¸æœƒå½¼æ­¤ç³¾çºã€‚

ä½ å°±åƒåœ¨æ‹¼ç©æœ¨ï¼Œè€Œä¸æ˜¯è§£ç¹©çµã€‚

æ˜¯ä¸æ˜¯è¼•é¬†å¾ˆå¤šï¼Ÿ

## ç‚ºä»€éº¼è¦æ”¾æ£„ OOPï¼Ÿ

å…¶å¯¦ React ä¸€é–‹å§‹æ˜¯æœ‰ `class` å…ƒä»¶çš„ï¼Œä½ å¯èƒ½é‚„è¨˜å¾—é€™ç¨®å¯«æ³•ï¼š

```jsx
class Counter extends React.Component {
  state = { count: 0 };
  handleClick = () => this.setState({ count: this.state.count + 1 });
  render() {
    return (
      <button onClick={this.handleClick}>Count = {this.state.count}</button>
    );
  }
}
```

ä½†ç•¶ä½ é–‹å§‹æœ‰ã€Œå…±ç”¨é‚è¼¯ã€çš„éœ€æ±‚æ™‚ï¼ˆåƒæ˜¯é©—è­‰è¡¨å–®ã€åµæ¸¬è£ç½®å¤§å°ã€API è«‹æ±‚ç­‰ï¼‰ï¼Œé€™äº›è¡Œç‚ºç„¡æ³•æ‹†æˆç¨ç«‹æ¨¡çµ„é‡ç”¨ï¼Œä½ åªèƒ½ç”¨ã€Œé«˜éšå…ƒä»¶ã€æˆ–ã€Œå‚³å…¥å‡½å¼å…ƒä»¶ã€ä¾†ç¡¬æ‹†ï¼Œçµæœæ„ˆå¯«æ„ˆäº‚ï¼Œæå¾—è‡ªå·±åƒæ˜¯åœ¨å¯« Javaï¼Ÿ

æŠ±æ­‰æˆ‘æ²’æœ‰è¦å†’çŠ¯ Java çš„æ„æ€ã€‚

## æ‰€ä»¥

ä½ èªªå‡½æ•¸å¼çœ‹èµ·ä¾†è¤‡é›œï¼Ÿå°ï¼Œä¸€é–‹å§‹å°±æ˜¯ã€‚

ä½†ä¸€å€‹æŒ‰éˆ•çš„è¤‡é›œåº¦å’Œä¸€å€‹å®Œæ•´æ‡‰ç”¨çš„è¤‡é›œåº¦ï¼Œæ˜¯å…©å›äº‹ã€‚

**Hook çš„è¨­è¨ˆï¼Œä¸æ˜¯ç‚ºäº†è®“ã€Œå…¥é–€æ›´ç°¡å–®ã€ï¼Œè€Œæ˜¯è®“ã€Œè¦æ¨¡è®Šå¤§æ™‚ä¸å´©æ½°ã€ã€‚**

ç­‰ä½ å¯«åˆ°ç¬¬ 8 å€‹å…ƒä»¶éƒ½è¦åšã€Œè‡ªå‹•å„²å­˜ã€ã€ã€ŒéŒ¯èª¤è™•ç†ã€ã€ã€Œè¦–çª—åµæ¸¬ã€çš„æ™‚å€™ï¼Œä½ å°±æœƒæ…¶å¹¸è‡ªå·±æ˜¯ç”¨ Hookï¼Œè€Œä¸æ˜¯ä¸€å€‹å…¨å¡åœ¨ç‰©ä»¶è£¡çš„è©­ç•°ç”Ÿç‰©ã€‚
