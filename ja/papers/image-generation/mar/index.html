<!doctype html><html lang=ja dir=ltr class="docs-wrapper plugin-docs plugin-id-papers docs-version-current docs-doc-page docs-doc-id-image-generation/mar/index" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>[24.06] MAR | DOCSAID</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://docsaid.org/ja/img/docsaid-social-card.jpg><meta data-rh=true name=twitter:image content=https://docsaid.org/ja/img/docsaid-social-card.jpg><meta data-rh=true property=og:url content=https://docsaid.org/ja/papers/image-generation/mar/><meta data-rh=true property=og:locale content=ja><meta data-rh=true property=og:locale:alternate content=zh_hant><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true name=docusaurus_locale content=ja><meta data-rh=true name=docsearch:language content=ja><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-papers-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-papers-current><meta data-rh=true property=og:title content="[24.06] MAR | DOCSAID"><meta data-rh=true name=description content=再び生成の秩序を鍛え直す><meta data-rh=true property=og:description content=再び生成の秩序を鍛え直す><link data-rh=true rel=icon href=/ja/img/favicon.ico><link data-rh=true rel=canonical href=https://docsaid.org/ja/papers/image-generation/mar/><link data-rh=true rel=alternate href=https://docsaid.org/papers/image-generation/mar/ hreflang=zh-hant><link data-rh=true rel=alternate href=https://docsaid.org/en/papers/image-generation/mar/ hreflang=en><link data-rh=true rel=alternate href=https://docsaid.org/ja/papers/image-generation/mar/ hreflang=ja><link data-rh=true rel=alternate href=https://docsaid.org/papers/image-generation/mar/ hreflang=x-default><link data-rh=true rel=preconnect href=https://S9NC0RYCHF-dsn.algolia.net crossorigin=anonymous><link rel=alternate type=application/rss+xml href=/ja/blog/rss.xml title="DOCSAID RSS Feed"><link rel=alternate type=application/atom+xml href=/ja/blog/atom.xml title="DOCSAID Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-RDF83L9R4M"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RDF83L9R4M",{anonymize_ip:!0})</script><link rel=search type=application/opensearchdescription+xml title=DOCSAID href=/ja/opensearch.xml><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css type=text/css integrity=sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM crossorigin=anonymous><link rel=stylesheet href=/ja/assets/css/styles.7e1f34fd.css><script src=/ja/assets/js/runtime~main.58d579ef.js defer></script><script src=/ja/assets/js/main.3aa5d34b.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label=メインコンテンツまでスキップ><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>メインコンテンツまでスキップ</a></div><nav aria-label=ナビゲーション class="navbar navbar--fixed-top navbarHideable_jvwV"><div class=navbar__inner><div class=navbar__items><button aria-label=ナビゲーションバーを開く aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/ja/><div class=navbar__logo><img src=/ja/img/docsaid_logo.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/ja/img/docsaid_logo_white.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href=/ja/docs/>オープンソースプロジェクト</a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/ja/papers/intro>論文ノート</a><a class="navbar__item navbar__link" href=/ja/blog>ブログ</a><a class="navbar__item navbar__link" href=/ja/playground/intro>遊び場</a><a class="navbar__item navbar__link" href=/ja/services>技術サービス</a><a class="navbar__item navbar__link" href=/ja/aboutus>私たちについて</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>日本語</a><ul class=dropdown__menu><li><a href=/papers/image-generation/mar/ target=_self rel="noopener noreferrer" class=dropdown__link lang=zh-hant>繁體中文</a><li><a href=/en/papers/image-generation/mar/ target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/ja/papers/image-generation/mar/ target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=ja>日本語</a></ul></div><div class=navbarSearchContainer_dCNk><button type=button class="DocSearch DocSearch-Button" aria-label="検索 (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>検索</span></span><span class=DocSearch-Button-Keys></span></button></div><button type=button class="ant-btn css-1m2bkf9 ant-btn-circle ant-btn-default ant-btn-color-default ant-btn-variant-outlined ant-btn-icon-only"><span class=ant-btn-icon><span role=img aria-label=user style=font-size:18px class="anticon anticon-user"><svg viewBox="64 64 896 896" focusable=false data-icon=user width=1em height=1em fill=currentColor aria-hidden=true><path d="M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"/></svg></span></span></button></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_eExm"><div class=docsWrapper_hBAB><button aria-label=先頭へ戻る class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/ja/><img src=/ja/img/docsaid_logo.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/ja/img/docsaid_logo_white.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b></b></a><nav aria-label=ドキュメントのサイドバー class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/ja/papers/intro>論文ノート</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/classic-cnns-11>Classic CNNs (11)</a><button aria-label="'Classic CNNs (11)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/contrastive-learning-13>Contrastive Learning (13)</a><button aria-label="'Contrastive Learning (13)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/deepseek-5>DeepSeek (5)</a><button aria-label="'DeepSeek (5)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/face-anti-spoofing-34>Face Anti-Spoofing (34)</a><button aria-label="'Face Anti-Spoofing (34)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/face-recognition-4>Face Recognition (4)</a><button aria-label="'Face Recognition (4)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/feature-fusion-10>Feature Fusion (10)</a><button aria-label="'Feature Fusion (10)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/ja/papers/category/image-generation-1>Image Generation (1)</a><button aria-label="'Image Generation (1)'の目次を隠す" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/ja/papers/image-generation/mar/>[24.06] MAR</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/lightweight-10>Lightweight (10)</a><button aria-label="'Lightweight (10)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/mamba-4>Mamba (4)</a><button aria-label="'Mamba (4)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/model-tuning-8>Model Tuning (8)</a><button aria-label="'Model Tuning (8)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/multimodality-24>Multimodality (24)</a><button aria-label="'Multimodality (24)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/normalization-1>Normalization (1)</a><button aria-label="'Normalization (1)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/object-detection-8>Object Detection (8)</a><button aria-label="'Object Detection (8)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/reparameterization-8>Reparameterization (8)</a><button aria-label="'Reparameterization (8)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/segmentation-1>Segmentation (1)</a><button aria-label="'Segmentation (1)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/text-detection-14>Text Detection (14)</a><button aria-label="'Text Detection (14)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/text-recognition-20>Text Recognition (20)</a><button aria-label="'Text Recognition (20)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/text-spotting-4>Text Spotting (4)</a><button aria-label="'Text Spotting (4)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/transformers-17>Transformers (17)</a><button aria-label="'Transformers (17)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/vision-transformers-12>Vision Transformers (12)</a><button aria-label="'Vision Transformers (12)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/ja/papers/intro>All Notes: 209 entries</a></ul></nav><button type=button title=サイドバーを隠す aria-label=サイドバーを隠す class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=パンくずリストのナビゲーション><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label=ホームページ class=breadcrumbs__link href=/ja/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ja/papers/category/image-generation-1><span itemprop=name>Image Generation (1)</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>[24.06] MAR</span><meta itemprop=position content=2></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>[24.06] MAR</h1><div class="undefined margin-bottom--md"><div class=docAuthor_y7l7><img src=https://github.com/nbswords.png alt=nbswords class=docAuthorImg_vlJe><div><div class=docAuthorName_aSh4><a href=https://github.com/nbswords target=_blank rel="noopener noreferrer">nbswords</a></div><div class=docAuthorTitle_Yp5_>Research Engineer</div><div class=docAuthorSocials_M3ba><a href=https://github.com/nbswords target=_blank rel="noopener noreferrer" class=docAuthorSocialLink_trj9><svg stroke=currentColor fill=currentColor stroke-width=0 viewBox="0 0 496 512" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></a><a href=https://www.linkedin.com/in/nbswords/ target=_blank rel="noopener noreferrer" class=docAuthorSocialLink_trj9><svg stroke=currentColor fill=currentColor stroke-width=0 viewBox="0 0 448 512" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></a><a href=https://x.com/nbswordsYu target=_blank rel="noopener noreferrer" class=docAuthorSocialLink_trj9><svg stroke=currentColor fill=currentColor stroke-width=0 viewBox="0 0 512 512" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=再び生成の秩序を鍛え直す>再び生成の秩序を鍛え直す<a href=#再び生成の秩序を鍛え直す class=hash-link aria-label="再び生成の秩序を鍛え直す への直接リンク" title="再び生成の秩序を鍛え直す への直接リンク">​</a></h2>
<p><a href=https://arxiv.org/abs/2406.11838 target=_blank rel="noopener noreferrer"><strong>Autoregressive Image Generation without Vector Quantization</strong></a></p>
<hr>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>備考</div><div class=admonitionContent_BuS1><p>本記事は <a href=https://medium.com/@nbswords/autoregressive-image-generation-without-vector-quantization-516b68b5acfa target=_blank rel="noopener noreferrer"><strong>nbswords の Medium</strong></a> に同時公開されています。</div></div>
<p>現在の自己回帰型画像生成モデルは、NLP 分野の自己回帰モデルの成功を模倣するために、画像をベクトル量子化（VQ）して複数のトークンに離散化する手法が一般的ですが、著者はこの離散空間が自己回帰型画像生成に必須ではないと考え、連続空間に基づく自己回帰画像生成モデルを提案しました。これにより、より高い精度と高速な推論時間を両立しています。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=背景知識>背景知識<a href=#背景知識 class=hash-link aria-label="背景知識 への直接リンク" title="背景知識 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=ベクトル量子化vector-quantization-vq>ベクトル量子化（Vector Quantization, VQ）<a href=#ベクトル量子化vector-quantization-vq class=hash-link aria-label="ベクトル量子化（Vector Quantization, VQ） への直接リンク" title="ベクトル量子化（Vector Quantization, VQ） への直接リンク">​</a></h3>
<p>これは長年用いられているベクトル探索の高速化技術であり、特徴空間のベクトル（埋め込みベクトル）を複数のグループに分割し、各グループを代表するベクトルをインデックスとして扱い、すべての代表ベクトルのインデックスを含むコードブックを通じてベクトル群を管理します。</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=VQ src=/ja/assets/images/img1-f74853576533d516a078f6ba6abac69b.jpg width=875 height=656 class=img_ev3q></figure></div>
<p>詳しい方法は <a href=https://medium.com/@nbswords/survey-of-vector-space-search-26555890ca5e target=_blank rel="noopener noreferrer">Survey Of Vector Space Search</a> や <a href=https://en.wikipedia.org/wiki/Vector_quantization target=_blank rel="noopener noreferrer">Vector quantization wiki</a> を参照してください。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=自己回帰型画像生成auto-regressive-image-generation>自己回帰型画像生成（Auto-regressive image generation）<a href=#自己回帰型画像生成auto-regressive-image-generation class=hash-link aria-label="自己回帰型画像生成（Auto-regressive image generation） への直接リンク" title="自己回帰型画像生成（Auto-regressive image generation） への直接リンク">​</a></h3>
<p>初期の Visual Autoregressive Model (VAR)は、画像生成タスクを GPT のような自己回帰型テキスト生成として直接模擬し、画像の各ピクセルを一つのカテゴリとして扱い、モデルは categorical cross entropy で多クラス予測を行います。Google の<a href=https://arxiv.org/abs/1802.05751 target=_blank rel="noopener noreferrer">Image Transformer, 2018</a>や OpenAI の<a href=https://cdn.openai.com/papers/Generative_Pretraining_from_Pixels_V2.pdf target=_blank rel="noopener noreferrer">ImageGPT, 2020</a>がこの方法に該当します。</p>
<p>画像生成速度を上げるため、現在の自己回帰画像生成モデルでは VQ を導入した 2 段階学習が一般的です。第 1 段階で latent space 上で画像復元に用いる codebook を学習し、第 2 段階で学習した codebook に基づいて自己回帰的に画像を生成します。</p>
<ul>
<li>
<p>例として<a href=https://arxiv.org/abs/1711.00937 target=_blank rel="noopener noreferrer">VQ-VAE, 2017</a></p>
<ul>
<li>Encode 段階では CNN で画像特徴を抽出し、feature map <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>z</mi><mi>e</mi></msub></mrow><annotation encoding=application/x-tex>z_e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:0.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em><span style=top:-2.55em;margin-left:-0.044em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> に対して VQ を行い、各グループの代表ベクトル（紫色のベクトル、<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>e_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> ～ <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>e</mi><mi>K</mi></msub></mrow><annotation encoding=application/x-tex>e_K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span>）を取得します。次に <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>z</mi><mi>e</mi></msub></mrow><annotation encoding=application/x-tex>z_e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:0.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em><span style=top:-2.55em;margin-left:-0.044em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> の各特徴点と代表ベクトル間の距離を計算し、最も近い代表ベクトルのインデックスで置換し <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi><mo stretchy=false>(</mo><mi>z</mi><mi mathvariant=normal>∣</mi><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>q(z|x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class="mord mathnormal" style=margin-right:0.03588em>q</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.04398em>z</span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span> を得ます。これが離散特徴です。</li>
<li>Decode 段階では <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em></span><span class="mord mathnormal" style=margin-right:0.03588em>q</span></span></span></span> からマッピングされた <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>Z</mi><mi>q</mi></msub></mrow><annotation encoding=application/x-tex>Z_q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.9694em;vertical-align:-0.2861em></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03588em>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em><span></span></span></span></span></span></span></span></span></span> を用いて画像を生成します。</li>
</ul>
</li>
</ul>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=VQ-VAE src=/ja/assets/images/img2-02517e55f6b6fd15a280d398132135be.jpg width=1304 height=537 class=img_ev3q></figure></div>
<p>自己回帰モデルで VQ を使い画像生成を高速化するのは魅力的ですが、欠点はないのでしょうか？</p>
<p>もちろんあります。1. VQ エンコーダの訓練が難しい 2. VQ によって復元画像の品質が低下する点です。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=方法>方法<a href=#方法 class=hash-link aria-label="方法 への直接リンク" title="方法 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vq-を捨ててdiffusion-を採用>VQ を捨てて、Diffusion を採用<a href=#vq-を捨ててdiffusion-を採用 class=hash-link aria-label="VQ を捨てて、Diffusion を採用 への直接リンク" title="VQ を捨てて、Diffusion を採用 への直接リンク">​</a></h3>
<p>Diffusion モデルは画像の全ピクセルやトークンの結合確率分布を表現できるなら、なぜ各トークンの条件付き確率分布を表現できないのか？</p>
<ul>
<li>Diffusion は入力のプロンプトや画像を条件にノイズから画像を生成する</li>
</ul>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=diffusion+text_prompt src=/ja/assets/images/img3-a20e0d0d126d7c3c5ac6876c6c1ff3b1.jpg width=954 height=482 class=img_ev3q></figure></div>
<ul>
<li>今回はTransformerの出力を条件としてノイズから生成（Transformerの入力については後述）</li>
</ul>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=diffusion+transformer src=/ja/assets/images/img4-087d1806c9bd61c8eca3f09fab06eed7.jpg width=972 height=554 class=img_ev3q></figure></div>
<p>彼らの手法は、各トークンの条件付き潜在変数 z を自己回帰的に予測し、小さな MLP の Diffusion モデルでノイズ除去（denoising）を行い、出力 x の確率分布 p(x|z) を得る</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=autoregressive_diffusion src=/ja/assets/images/img5-c79c367e42bc3ed8656a502d29a6797f.jpg width=508 height=355 class=img_ev3q></figure></div>
<p>元のカテゴリカルクロスエントロピーに代えて Diffusion Loss を提案</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=diffusion_cal src=/ja/assets/images/img6-f52aa8173a4413b25ec0f5a9f5e49a3a.jpg width=543 height=80 class=img_ev3q></figure></div>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=diffusion_cal_2 src="data:image/jpeg;base64,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" width=324 height=69 class=img_ev3q></figure></div>
<ul>
<li>
<p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ε</mi></mrow><annotation encoding=application/x-tex>ε</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.4306em></span><span class="mord mathnormal">ε</span></span></span></span> は(0,1)の正規分布からサンプリングされたノイズ</p>
</li>
<li>
<p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ε</mi><mi>θ</mi></msub></mrow><annotation encoding=application/x-tex>ε_θ</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">ε</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em>θ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> は小さな MLP で、<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ε</mi><mi>θ</mi></msub><mo stretchy=false>(</mo><msub><mi>x</mi><mi>t</mi></msub><mi mathvariant=normal>∣</mi><mi>t</mi><mo separator=true>,</mo><mi>z</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>ε_θ(x_t|t,z)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class=mord><span class="mord mathnormal">ε</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em>θ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.2806em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mord>∣</span><span class="mord mathnormal">t</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em></span><span class="mord mathnormal" style=margin-right:0.04398em>z</span><span class=mclose>)</span></span></span></span> は時間 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6151em></span><span class="mord mathnormal">t</span></span></span></span> と条件 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>z</mi></mrow><annotation encoding=application/x-tex>z</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.4306em></span><span class="mord mathnormal" style=margin-right:0.04398em>z</span></span></span></span> をもとに入力 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding=application/x-tex>x_t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.2806em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> からノイズベクトル <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ε</mi><mi>θ</mi></msub></mrow><annotation encoding=application/x-tex>ε_θ</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">ε</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em>θ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> を推定するモデル</p>
<ul>
<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6151em></span><span class="mord mathnormal">t</span></span></span></span> はノイズスケジュールのタイムスタンプ、<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>z</mi></mrow><annotation encoding=application/x-tex>z</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.4306em></span><span class="mord mathnormal" style=margin-right:0.04398em>z</span></span></span></span> は Transformer が文脈から生成した条件ベクトル</li>
</ul>
</li>
</ul>
<p>最後に、DDPM 同様に推論時には逆拡散過程（reverse diffusion process）で画像を生成（<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding=application/x-tex>x_t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.2806em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> から <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>x_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> へ）</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=reverse_diff src=/ja/assets/images/img8-2ddbeaa437c343e08c991bd632d4a991.jpg width=741 height=72 class=img_ev3q></figure></div>
<p>また、Diffusion モデルの画像生成では「温度（temperature）」という超パラメータがあり、温度が高いほど生成のランダム性が大きく、低いほど少ない。今回のモデルでは温度 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>τ</mi></mrow><annotation encoding=application/x-tex>\tau</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.4306em></span><span class="mord mathnormal" style=margin-right:0.1132em>τ</span></span></span></span> * <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>σ</mi><mi>t</mi></msub><mi>δ</mi></mrow><annotation encoding=application/x-tex>\sigma_t \delta</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8444em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.2806em><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:0.03785em>δ</span></span></span></span> を使い調整。この手法は<a href=https://arxiv.org/abs/2105.05233 target=_blank rel="noopener noreferrer">Diffusion Models Beat GANs on Image Synthesis</a>に由来。</p>
<p>これは VAE の条件生成と DDPM のノイズ除去を巧みに組み合わせ、VAE で画像特徴を圧縮し DDPM で画像を生成するという非常に洗練された手法である。</p>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=VAE_and_Diffusion src=/ja/assets/images/img9-2c8c638a704853f10387abcb1e484c74.jpg width=1603 height=431 class=img_ev3q></figure></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=autoregressive-と-masked-generative-models-の概念を融合>Autoregressive と Masked Generative Models の概念を融合<a href=#autoregressive-と-masked-generative-models-の概念を融合 class=hash-link aria-label="Autoregressive と Masked Generative Models の概念を融合 への直接リン��ク" title="Autoregressive と Masked Generative Models の概念を融合 への直接リンク">​</a></h3>
<p>本モデルは<a href=https://arxiv.org/abs/2111.06377 target=_blank rel="noopener noreferrer">MAE (Masked Autoencoders Are Scalable Vision Learners), 2021</a>の作者である愷明氏の発想を踏襲し、MAE の考えを取り入れている。</p>
<ul>
<li>
<p>主に MAE の後続研究<a href=https://arxiv.org/abs/2202.04200 target=_blank rel="noopener noreferrer">MaskGIT, 2022</a>と<a href=https://arxiv.org/abs/2211.09117 target=_blank rel="noopener noreferrer">MAGE, 2022</a>を参考に、いずれも Transformer を用いた Masked Autoregressive(MAR)である。MaskGIT は bidirectional transformer decoder で複数トークンを同時予測する点が貢献、MAGE は画像表現学習と画像合成の統合が貢献。</p>
</li>
<li>
<p>本作でも MAE の双方向注意機構を用い、マスクトークン [m]を中間層に置き全トークンが互いを参照可能にし、マスクされていないトークンのみで損失を計算する。</p>
<ul>
<li>これは一般的に言われる causal attention や bidirectional attention とは異なるため、理解したい場合は MAE 論文を参照。</li>
<li>この設計により画像生成性能が向上する反面、Transformer の訓練・推論で kv cache を使った高速化ができなくなる。ただし複数トークンを同時予測するため速度低下は限定的。</li>
</ul>
</li>
</ul>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=bidirect src=/ja/assets/images/img10-aba7fcdbac546aa2e68355a286a723d1.jpg width=696 height=668 class=img_ev3q></figure></div>
<ul>
<li>下図は通常の順次 AR、ランダム順序での AR（1 トークンマスク）、今回の複数トークン同時予測 AR（複数トークンマスク）の比較。ここで Transformer への入力が masked image である理由が明かされる。</li>
</ul>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=AR_and_MAR src=/ja/assets/images/img11-d2104821c1e5aa8f79ea0b971d3cedcc.jpg width=816 height=570 class=img_ev3q></figure></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=実装>実装<a href=#実装 class=hash-link aria-label="実装 への直接リンク" title="実装 への直接リンク">​</a></h2>
<ul>
<li>Diffusion Loss：cosine 型ノイズスケジュール、訓練時は DDPM を 1000 ステップ、推論時は 100 ステップで実行</li>
<li>Denoising MLP（小型 MLP）：3 層 1024 チャネルブロック、各ブロックに LayerNorm、線形層、SiLU 活性化関数、Residual 接続を含む。実装上は AdaLN で Transformer の出力 z を LayerNorm 層に組み込む</li>
<li>Tokenizer：LDM 公開の Tokenizer を利用、VQ-16 と KL-16 を含む。VQ-16 は VQ-GAN ベースで GAN loss と知覚損失を用い、KL-16 は KL ダイバージェンス正則化で VQ に依存しない</li>
<li>Transformer：Tokenizer 処理済みのトークン列を受け取り、位置エンコードと [CLS] トークンを付加、32 層 1024 チャネルの Transformer ブロックを通す ViT を使用</li>
<li>Masked autoregressive models：訓練時は [0.7, 1.0] のマスキング率で、0.7 はランダムに 70%のトークンをマスク。短すぎるシーケンスを避けるため常に 64 個の [cls] トークンでパディング。推論時はマスキング率を 1.0 から 0 へ段階的に下げ、cosine スケジュールでステップ数調整。デフォルトは 64 ステップ。</li>
<li>ベースラインの Autoregressive Model：causal attention を用いた GPT モデルで、入力に [cls] を付け、kv cache と温度パラメータを利用。</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=実験>実験<a href=#実験 class=hash-link aria-label="実験 への直接リンク" title="実験 への直接��リンク">​</a></h2>
<p>モデル実験設定はすべて AR/MAR-L（約 4 億パラメータ）、400 エポック、ImageNet 256×256</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=diffusion-loss-と-cross-entropy-loss-の比較>Diffusion Loss と Cross-entropy Loss の比較<a href=#diffusion-loss-と-cross-entropy-loss-の比較 class=hash-link aria-label="Diffusion Loss と Cross-entropy Loss の比較 への直接リンク" title="Diffusion Loss と Cross-entropy Loss の比較 への直接リンク">​</a></h3>
<p>すべての AR/MAR バリエーションにおいて、Diffusion Loss を使った方が性能が良い。中でも AR の改善は最小で、下に行くほど改善が大きく、MAR+bidirect+複数予測モデルの改善が最大。Diffusion Loss が MAR モデルにとって重要であることが示されている。</p>
<ul>
<li>Diffusion Loss は他の拡散モデルでも使われる CFG（Classifier-Free Guidance）を用いて生成性能を向上させている</li>
<li>Fréchet Inception Distance (FID) は数値が低いほど良い、Inception Score (IS) は高いほど良い。両者は生成画像の品質評価指標</li>
</ul>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt="Diffusion Loss" src=/ja/assets/images/img12-77434de701c031ee57b0b07c3ce8e694.jpg width=1498 height=433 class=img_ev3q></figure></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=トークナイザー>トークナイザー<a href=#トークナイザー class=hash-link aria-label="トークナイザー への直接リンク" title="トークナイザー への直接リンク">​</a></h3>
<p>異なるトークナイザーを使い Diff Loss と組み合わせた効果を検証。離散空間から連続空間へ脱却したため、トークナイザーは制限されず、Diff Loss は連続・離散どちらのトークナイザーにも適用可能。</p>
<ul>
<li>VQ-16：VQ-VAE の VQ 前の連続潜在表現をトークン化したもの。前述の通り、VQ-16 と KL-16 は LDM 提供のもので、ImageNet で学習している（OpenImages ではない）</li>
<li>Consistency Decoder：非 VQ のトークナイザーで、<a href=https://github.com/openai/consistencydecoder target=_blank rel="noopener noreferrer">DALL·E 3</a>由来</li>
<li>reconstruction FID (rFID)：低いほど良く、トークナイザー評価指標</li>
</ul>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=Tokenizers src=/ja/assets/images/img13-8250cad95bfb70573f1c8f3f468b4419.jpg width=1430 height=321 class=img_ev3q></figure></div>
<p>結果として、連続型トークナイザーの KL-16 は離散型 VQ-16 より良い性能を示し、Consistency Decoder のような異なるトークナイザーにも対応可能なことを示している。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=denoising-mlp>Denoising MLP<a href=#denoising-mlp class=hash-link aria-label="Denoising MLP への直接リンク" title="Denoising MLP への直接リンク">​</a></h3>
<p>パラメータ数の異なる MLP の性能比較。幅（width）1024 が最良の性能を示す。</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt="Denosing MLP" src=/ja/assets/images/img14-83a8c46a5314c97327752c6bb9ba6cd9.jpg width=901 height=285 class=img_ev3q></figure></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=diffusion-loss-のサンプリングステップ数>Diffusion Loss のサンプリングステップ数<a href=#diffusion-loss-のサンプリングステップ数 class=hash-link aria-label="Diffusion Loss のサンプリングステップ数 への直接リンク" title="Diffusion Loss のサンプリングステップ数 への直接リンク">​</a></h3>
<p>Diffusion のステップ数による生成品質の影響。ステップ数 100 で十分良い性能を得られる。</p>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt="Sampling steps of Diffusion Loss" src=/ja/assets/images/img15-42662a0c0fc5e8a350f9a7bdd57dba6c.jpg width=950 height=303 class=img_ev3q></figure></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=diffusion-loss-の温度パラメータ>Diffusion Loss の温度パラメータ<a href=#diffusion-loss-の温度パラメータ class=hash-link aria-label="Diffusion Loss の温度パラメータ への直接リンク" title="Diffusion Loss の温度パラメータ への直接リンク">​</a></h3>
<p>Diff Loss における温度設定も重要。</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=Temperature src=/ja/assets/images/img16-12abcebd945dac79cac80483fc029a04.jpg width=892 height=423 class=img_ev3q></figure></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=スピードと精度のトレードオフ>スピードと精度のトレードオフ<a href=#スピードと精度のトレードオフ class=hash-link aria-label="スピードと精度のトレードオフ への直接リンク" title="スピードと精度のトレードオフ への直接リンク">​</a></h3>
<p>kv cache を使用できないため、この評価は重要。A100 を用い、バッチサイズ 256 で計測。</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=Speed src=/ja/assets/images/img17-903f63b92d80a5694d99a2f6e25bcffb.jpg width=791 height=582 class=img_ev3q></figure></div>
<ul>
<li>MAR: 各点は異なる自己回帰ステップ数（8 ～ 128）</li>
<li>DiT: 各点は異なる拡散ステップ数（50, 75, 150, 250）、DiT-XL を使用</li>
<li>AR: kv cache を使用</li>
</ul>
<p>kv cache なしでも推論速度は悪くないが、デフォルト設定（ステップ 64）はやや遅い。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=システムレベルの比較>システムレベルの比較<a href=#システムレベルの比較 class=hash-link aria-label="システムレベルの比較 への直接リンク" title="システムレベルの比較 への直接リンク">​</a></h3>
<p>他モデルとの比較。最大モデル MAR-H が最良の性能を示すが、MAR-L も十分良好。</p>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt="System-level comparison" src=/ja/assets/images/img18-5b9dbf15d3b7495d204403fb09706b63.jpg width=1543 height=846 class=img_ev3q></figure></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=結論>結論<a href=#結論 class=hash-link aria-label="結論 への直接リンク" title="結論 への直接リンク">​</a></h2>
<p>本研究は自己回帰画像生成の従来手法を打破し、Diffusion と MAE を融合した新たな方向性を切り拓いた。単純な DDPM を使った実証に留まるが、より優れた拡散モデルの適用でさらなる性能向上が期待される。今後の派生研究に期待したい。</p>
<p>最後に一部の生成画像を掲載。</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=result src=/ja/assets/images/img19-2dc1297b93dc97d40a264467615c3783.jpg width=942 height=935 class=img_ev3q></figure></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=参考文献>参考文献<a href=#参考文献 class=hash-link aria-label="参考文献 への直接リンク" title="参考文献 への直接リンク">​</a></h2>
<p><a href=https://zhouyifan.net/2024/07/27/20240717-ar-wo-vq/ target=_blank rel="noopener noreferrer">https://zhouyifan.net/2024/07/27/20240717-ar-wo-vq/</a></header></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated><b><time datetime=2025-05-19T05:33:17.000Z itemprop=dateModified>2025年5月19日</time></b>に<b>zephyr-sh</b>が<!-- -->最終更新</span></div></div><section class=ctaSection_iCjC><div class="
        simpleCta_ji_Y
        simple-cta__coffee_YwC8
        fadeInUp_n33J
        hoverTransform_Mozy
      " style=cursor:pointer><h3 class=simple-cta__title_i7hn>☕ 1杯のコーヒーが支えになります</h3><p class=simple-cta__subtitle_ol86>AIやフルスタックの情報発信を続けるため、ご支援お願いします。<div class=simple-cta__buttonWrapper_jk1Y><img src=/ja/img/bmc-logo.svg alt=cta-button class=simple-cta__buttonImg_Q9VV></div></div><div class="ant-row ant-row-stretch cardsSection_wRaP css-1m2bkf9" style=margin-left:-8px;margin-right:-8px;row-gap:16px><div style=padding-left:8px;padding-right:8px;display:flex class="ant-col ant-col-xs-24 css-1m2bkf9"><div class="ant-card ant-card-bordered card_gKx9 fadeInUp_n33J hoverTransform_Mozy css-1m2bkf9" style=flex:1;display:flex;flex-direction:column><div class=ant-card-body><div style=text-align:center;margin-top:1rem><img src=/ja/img/icons/all_in.svg alt="AI・開発・運用まで一括対応 icon" style=width:48px;height:48px></div><span class="ant-tag ant-tag-orange card__tag_PLj3 css-1m2bkf9">ALL</span><h4 class=card__title_SQBY>AI・開発・運用まで一括対応</h4><p class=card__concept_Ak8F>アイデアからリリースまで、技術面はまるごとお任せください。<div class=card__bulletHeader_b6cf><h5 class=card__bulletTitle_R_wg>対応内容</h5></div><ul class=card__bulletList_SrNN><li class=card__bulletItem_wCRd>技術相談 + 開発 + デプロイ<li class=card__bulletItem_wCRd>継続サポート & 拡張</ul></div></div></div></div><div class="
        simpleCta_ji_Y
        simple-cta__outro_AXbn
        fadeInUp_n33J
        hoverTransform_Mozy
      " style=cursor:pointer><h3 class=simple-cta__title_i7hn>🚀 次のプロジェクト、始めましょう！</h3><p class=simple-cta__subtitle_ol86>カスタム開発や長期支援をご希望の方は、ぜひご相談ください。</div></section><div style=margin-top:3rem> </div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label=ドキュメントページ><a class="pagination-nav__link pagination-nav__link--prev" href=/ja/papers/category/image-generation-1><div class=pagination-nav__sublabel>前へ</div><div class=pagination-nav__label>Image Generation (1)</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/ja/papers/category/lightweight-10><div class=pagination-nav__sublabel>次へ</div><div class=pagination-nav__label>Lightweight (10)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#再び生成の秩序を鍛え直す class="table-of-contents__link toc-highlight">再び生成の秩序を鍛え直す</a><li><a href=#背景知識 class="table-of-contents__link toc-highlight">背景知識</a><ul><li><a href=#ベクトル量子化vector-quantization-vq class="table-of-contents__link toc-highlight">ベクトル量子化（Vector Quantization, VQ）</a><li><a href=#自己回帰型画像生成auto-regressive-image-generation class="table-of-contents__link toc-highlight">自己回帰型画像生成（Auto-regressive image generation）</a></ul><li><a href=#方法 class="table-of-contents__link toc-highlight">方法</a><ul><li><a href=#vq-を捨ててdiffusion-を採用 class="table-of-contents__link toc-highlight">VQ を捨てて、Diffusion を採用</a><li><a href=#autoregressive-と-masked-generative-models-の概念を融合 class="table-of-contents__link toc-highlight">Autoregressive と Masked Generative Models の概念を融合</a></ul><li><a href=#実装 class="table-of-contents__link toc-highlight">実装</a><li><a href=#実験 class="table-of-contents__link toc-highlight">実験</a><ul><li><a href=#diffusion-loss-と-cross-entropy-loss-の比較 class="table-of-contents__link toc-highlight">Diffusion Loss と Cross-entropy Loss の比較</a><li><a href=#トークナイザー class="table-of-contents__link toc-highlight">トークナイザー</a><li><a href=#denoising-mlp class="table-of-contents__link toc-highlight">Denoising MLP</a><li><a href=#diffusion-loss-のサンプリングステップ数 class="table-of-contents__link toc-highlight">Diffusion Loss のサンプリングステップ数</a><li><a href=#diffusion-loss-の温度パラメータ class="table-of-contents__link toc-highlight">Diffusion Loss の温度パラメータ</a><li><a href=#スピードと精度のトレードオフ class="table-of-contents__link toc-highlight">スピードと精度のトレードオフ</a><li><a href=#システムレベルの比較 class="table-of-contents__link toc-highlight">システムレベルの比較</a></ul><li><a href=#結論 class="table-of-contents__link toc-highlight">結論</a><li><a href=#参考文献 class="table-of-contents__link toc-highlight">参考文献</a></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class=footer__links><a class=footer__link-item href=/ja/docs>オープンソースプロジェクト</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/ja/papers/intro>論文ノート</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/ja/blog>ブログ</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/ja/terms-of-service>利用規約</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/ja/privacy-policy>プライバシーポリシー</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/ja/become-an-author>著者になる</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/ja/worklog>作業日誌</a></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2024 DOCSAID.</div></div></div></footer></div>