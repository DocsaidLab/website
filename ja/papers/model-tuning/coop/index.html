<!doctype html><html lang=ja dir=ltr class="docs-wrapper plugin-docs plugin-id-papers docs-version-current docs-doc-page docs-doc-id-model-tuning/coop/index" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>[21.09] CoOp | DOCSAID</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://docsaid.org/ja/img/docsaid-social-card.jpg><meta data-rh=true name=twitter:image content=https://docsaid.org/ja/img/docsaid-social-card.jpg><meta data-rh=true property=og:url content=https://docsaid.org/ja/papers/model-tuning/coop/><meta data-rh=true property=og:locale content=ja><meta data-rh=true property=og:locale:alternate content=zh_hant><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true name=docusaurus_locale content=ja><meta data-rh=true name=docsearch:language content=ja><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-papers-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-papers-current><meta data-rh=true property=og:title content="[21.09] CoOp | DOCSAID"><meta data-rh=true name=description content=搖曳的呢喃><meta data-rh=true property=og:description content=搖曳的呢喃><link data-rh=true rel=icon href=/ja/img/favicon.ico><link data-rh=true rel=canonical href=https://docsaid.org/ja/papers/model-tuning/coop/><link data-rh=true rel=alternate href=https://docsaid.org/papers/model-tuning/coop/ hreflang=zh-hant><link data-rh=true rel=alternate href=https://docsaid.org/en/papers/model-tuning/coop/ hreflang=en><link data-rh=true rel=alternate href=https://docsaid.org/ja/papers/model-tuning/coop/ hreflang=ja><link data-rh=true rel=alternate href=https://docsaid.org/papers/model-tuning/coop/ hreflang=x-default><link data-rh=true rel=preconnect href=https://S9NC0RYCHF-dsn.algolia.net crossorigin><link rel=alternate type=application/rss+xml href=/ja/blog/rss.xml title="DOCSAID RSS Feed"><link rel=alternate type=application/atom+xml href=/ja/blog/atom.xml title="DOCSAID Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-RDF83L9R4M"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RDF83L9R4M",{anonymize_ip:!0})</script><link rel=search type=application/opensearchdescription+xml title=DOCSAID href=/ja/opensearch.xml><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css integrity=sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM crossorigin><link rel=stylesheet href=/ja/assets/css/styles.1cc926cb.css><script src=/ja/assets/js/main.a587ae50.js defer></script><script src=/ja/assets/js/runtime~main.c58b0a1a.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label=メインコンテンツまでスキップ><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>メインコンテンツまでスキップ</a></div><nav aria-label=ナビゲーション class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class=navbar__items><button aria-label=ナビゲーションバーを開く aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/ja/><div class=navbar__logo><img src=/ja/img/docsaid_logo.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/ja/img/docsaid_logo_white.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href=/ja/docs/>オープンソースプロジェクト</a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/ja/papers/intro>論文ノート</a><a class="navbar__item navbar__link" href=/ja/blog>ブログ</a><a class="navbar__item navbar__link" href=/ja/playground/intro>遊び場</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>日本語</a><ul class=dropdown__menu><li><a href=/papers/model-tuning/coop/ rel="noopener noreferrer" class=dropdown__link lang=zh-hant>繁體中文</a><li><a href=/en/papers/model-tuning/coop/ rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/ja/papers/model-tuning/coop/ rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=ja>日本語</a></ul></div><a href=https://buymeacoffee.com/zephyr_docsaid target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">サポートする<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><a href=https://github.com/DocsaidLab target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title=ダークモードを切り替える(現在はライトモード) aria-label=ダークモードを切り替える(現在はライトモード) aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="検索 (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>検索</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label=先頭へ戻る class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/ja/><img src=/ja/img/docsaid_logo.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/ja/img/docsaid_logo_white.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b></b></a><nav aria-label=ドキュメントの��サイドバー class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/ja/papers/intro>論文ノート</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/classic-cnns-11>Classic CNNs (11)</a><button aria-label="'Classic CNNs (11)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/face-anti-spoofing-1>Face Anti-Spoofing (1)</a><button aria-label="'Face Anti-Spoofing (1)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/face-recognition-4>Face Recognition (4)</a><button aria-label="'Face Recognition (4)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/feature-fusion-7>Feature Fusion (7)</a><button aria-label="'Feature Fusion (7)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/lightweight-10>Lightweight (10)</a><button aria-label="'Lightweight (10)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/mamba-1>Mamba (1)</a><button aria-label="'Mamba (1)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/ja/papers/category/model-tuning-7>Model Tuning (7)</a><button aria-label="'Model Tuning (7)'の目次を隠す" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/papers/model-tuning/adapter/>[19.02] Adapter</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/papers/model-tuning/autoprompt/>[20.10] AutoPrompt</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/papers/model-tuning/prefix-tuning/>[21.01] Prefix-Tuning</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/papers/model-tuning/soft-prompts/>[21.04] Soft Prompts</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/papers/model-tuning/lora/>[21.06] LoRA</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/ja/papers/model-tuning/coop/>[21.09] CoOp</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/ja/papers/model-tuning/blip2/>[23.01] BLIP-2</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/multimodality-22>Multimodality (22)</a><button aria-label="'Multimodality (22)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/normalization-1>Normalization (1)</a><button aria-label="'Normalization (1)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/object-detection-8>Object Detection (8)</a><button aria-label="'Object Detection (8)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/reparameterization-7>Reparameterization (7)</a><button aria-label="'Reparameterization (7)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/segmentation-1>Segmentation (1)</a><button aria-label="'Segmentation (1)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/text-detection-10>Text Detection (10)</a><button aria-label="'Text Detection (10)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/text-recognition-20>Text Recognition (20)</a><button aria-label="'Text Recognition (20)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/text-spotting-4>Text Spotting (4)</a><button aria-label="'Text Spotting (4)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/transformers-15>Transformers (15)</a><button aria-label="'Transformers (15)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/ja/papers/category/vision-transformers-11>Vision Transformers (11)</a><button aria-label="'Vision Transformers (11)'の目次を開く" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/ja/papers/intro>All Notes: 140 entries</a></ul></nav><button type=button title=サイドバーを隠す aria-label=サイドバーを隠す class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=パンくずリストのナビゲーション><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label=ホームページ class=breadcrumbs__link href=/ja/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/ja/papers/category/model-tuning-7><span itemprop=name>Model Tuning (7)</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>[21.09] CoOp</span><meta itemprop=position content=2></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>[21.09] CoOp</h1></header>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=搖曳的呢喃>搖曳的呢喃<a href=#搖曳的呢喃 class=hash-link aria-label="搖曳的呢喃 への直接リンク" title="搖曳的呢喃 への直接リンク">​</a></h2>
<p><a href=https://arxiv.org/abs/2109.01134 target=_blank rel="noopener noreferrer"><strong>Learning to Prompt for Vision-Language Models</strong></a></p>
<hr>
<p>稍早我們也看過 Soft Prompts 這篇論文了，現在就來看看後續的相關應用。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>ヒント</div><div class=admonitionContent_BuS1><p>如果你還沒看過的話，可以參考我們之前寫的文章：<ul>
<li><a href=/ja/papers/model-tuning/soft-prompts/><strong>[21.04] Soft Prompts: 小弦切切如私語</strong></a></li>
</ul></div></div>
<p>這種外掛式的調模型的方式，目標對象通常都是 LLM 或是 VLM。</p>
<p>而這篇論文的作者所定的目標是 VLM，確切來說，是我們耳熟能詳的 CLIP。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>ヒント</div><div class=admonitionContent_BuS1><p>沒聽過 CLIP？那先去看看這篇：<ul>
<li><a href=/ja/papers/multimodality/clip/><strong>[21.03] CLIP: 打碎次元的屏障</strong></a></li>
</ul></div></div>
<p>CLIP 在 2021 年 3 月的時候發表，隔了一個月就有人提出了 Soft Prompts 的概念。</p>
<p>於是作者決定把 Soft Prompts 的概念拿去用在 CLIP，就有了這篇論文。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=定義問題>定義問題<a href=#定義問題 class=hash-link aria-label="定義問題 への直接リンク" title="定義問題 への直接リンク">​</a></h2>
<div align=center><figure style=width:90%><p><img decoding=async loading=lazy alt=problem src=/ja/assets/images/img1-45ce870d1bf92685c17246b784afb932.jpg width=1224 height=476 class=img_ev3q></figure></div>
<p>這裡所定義的問題跟 Soft Prompts 一樣，人工設計的提示存在很多缺陷，針對不同的模型、不同的任務，會出現截然不同的結果。</p>
<p>如上圖，以 CLIP 為例子。如果我們用 <code>a photo of [CLASS]</code> 這樣的提示，可以得到 80% 左右的準確率，但是多加一個 <code>a</code> 改成 <code>a photo of a [CLASS]</code>，準確率居然會上升到 86%！</p>
<p>而且這不是特例，上圖四個不同的圖片都是這樣。</p>
<p>這是什麼情況？只是差幾個無關緊要的字，居然能夠出現這麼大的差距？</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>ヒント</div><div class=admonitionContent_BuS1><p>等到你好不容易掌握了這個模型的特性，然後市場上又出現了新的模型，只好再重新來過。</div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=複習-clip>複習 CLIP<a href=#複習-clip class=hash-link aria-label="複習 CLIP への直接リンク" title="複習 CLIP への直接リンク">​</a></h2>
<p>我們猜你不會想去看 CLIP 的論文，所以簡單複習一下 CLIP 的架構。</p>
<div align=center><figure style=width:70%><p><img decoding=async loading=lazy alt=clip src=/ja/assets/images/arch_clip-ef4a34c3ec1c19ee45e598ca12ff5459.jpg width=1726 height=622 class=img_ev3q></figure></div>
<p>CLIP 包含兩個編碼器：</p>
<ul>
<li><strong>影像編碼器</strong>：將高維的影像資料嵌入到低維度的特徵空間中。影像編碼器的架構可以採用 CNN 或 ViT。</li>
<li><strong>文本編碼器</strong>：基於 Transformer，將自然語言轉換為文本表示。</li>
</ul>
<p>輸入的文本資料，處理方式為 BPE（Byte Pair Encoding）表示法，並轉換為 512 維的詞嵌入向量。其中，詞彙表大小為 49,152。在訓練過程中，句子會加入特殊符號 <code>[SOS]</code> 和 <code>[EOS]</code>，並限制最大長度為 77。最後，取 <code>[EOS]</code> 位置的特徵進行 LayerNorm，並經由線性投影層處理。</p>
<p>CLIP 的學習目標是對齊影像與文本的嵌入空間。概念是給定一組影像-文本配對的批次資料，模型最大化配對樣本之間的餘弦相似度，同時最小化未配對樣本之間的餘弦相似度。</p>
<p>CLIP 的訓練資料規模非常龐大，為了讓模型能夠學習更多樣化的視覺概念，CLIP 團隊收集了包含 4 億組影像-文本配對的大規模訓練資料。</p>
<p>複習完畢，現在你也是 CLIP 大師了。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=解決問題>解決問題<a href=#解決問題 class=hash-link aria-label="解決問題 への直接リンク" title="解決問題 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=模�型架構>模型架構<a href=#模型架構 class=hash-link aria-label="模型架構 への直接リンク" title="模型架構 への直接リンク">​</a></h3>
<div align=center><figure style=width:90%><p><img decoding=async loading=lazy alt=problem src=/ja/assets/images/img2-afd45514104ef5599596e9cfe1ae31fe.jpg width=1224 height=564 class=img_ev3q></figure></div>
<p>上圖就是文本上下文優化（Context Optimization, CoOp）的架構，透過將上下文詞彙建模為可從資料中學習的連續向量，避免了手動調整提示詞的過程。</p>
<p>其中作者又分成兩個不同的訓練方式：</p>
<ul>
<li>
<p><strong>統一上下文</strong></p>
<p>原文為 Unified Context，簡稱 UC。</p>
<p>在提示詞的設計設計上，對於所有的類別，使用相同的上下文詞向量組成統一的提示詞，其提示詞的結構如下：</p>
<span class=katex-display><span class=katex><span class=katex-mathml><math display=block><semantics><mrow><mi>t</mi><mo>=</mo><mo stretchy=false>[</mo><mi>V</mi><msub><mo stretchy=false>]</mo><mn>1</mn></msub><mo stretchy=false>[</mo><mi>V</mi><msub><mo stretchy=false>]</mo><mn>2</mn></msub><mo>…</mo><mo stretchy=false>[</mo><mi>V</mi><msub><mo stretchy=false>]</mo><mi>M</mi></msub><mtext>[CLASS]</mtext><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>t = [V]_1 [V]_2 \dots [V]_M  \text{[CLASS]},</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6151em></span><span class="mord mathnormal">t</span><span class=mspace style=margin-right:0.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.10903em>M</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class="mord text"><span class=mord>[CLASS]</span></span><span class=mpunct>,</span></span></span></span></span>
<p>其中，<span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>[</mo><mi>V</mi><msub><mo stretchy=false>]</mo><mi>m</mi></msub></mrow><annotation encoding=application/x-tex>[V]_m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span>（<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><mo stretchy=false>{</mo><mn>1</mn><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mi>M</mi><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>m \in \{1, \dots, M\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5782em;vertical-align:-0.0391em></span><span class="mord mathnormal">m</span><span class=mspace style=margin-right:0.2778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class=mopen>{</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em></span><span class="mord mathnormal" style=margin-right:0.10903em>M</span><span class=mclose>}</span></span></span></span>）是一個與詞嵌入維度相同的向量，例如 CLIP 的特徵維度為 512，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em></span><span class="mord mathnormal" style=margin-right:0.10903em>M</span></span></span></span> 為超參數，表示上下文詞元的數量。</p>
<p>推理過程如下：</p>
<ul>
<li>將提示詞 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6151em></span><span class="mord mathnormal">t</span></span></span></span> 傳遞至文本編碼器 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>g(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class="mord mathnormal" style=margin-right:0.03588em>g</span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span>，獲得對應的分類權重向量（仍取自 [EOS] 標記的位置）。</li>
<li>預測概率計算公式如下：</li>
</ul>
<span class=katex-display><span class=katex><span class=katex-mathml><math display=block><semantics><mrow><mi>p</mi><mo stretchy=false>(</mo><mi>y</mi><mo>=</mo><mi>i</mi><mi mathvariant=normal>∣</mi><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>g</mi><mo stretchy=false>(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>f</mi><mo stretchy=false>)</mo><mi mathvariant=normal>/</mi><mi>τ</mi><mo stretchy=false>)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>g</mi><mo stretchy=false>(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>f</mi><mo stretchy=false>)</mo><mi mathvariant=normal>/</mi><mi>τ</mi><mo stretchy=false>)</mo></mrow></mfrac><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>p(y = i|x) = \frac{\exp(\cos(g(t_i), f)/\tau)}{\sum_{j=1}^K \exp(\cos(g(t_j), f)/\tau)},</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class="mord mathnormal">p</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.03588em>y</span><span class=mspace style=margin-right:0.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class="mord mathnormal">i</span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em></span></span><span class=base><span class=strut style=height:2.734em;vertical-align:-1.307em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.427em><span style=top:-2.1288em><span class=pstrut style=height:3em></span><span class=mord><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0em>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.9812em><span style=top:-2.4003em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em>j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.4358em><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.1667em></span><span class=mop>exp</span><span class=mopen>(</span><span class=mop>cos</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.03588em>g</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em></span><span class="mord mathnormal" style=margin-right:0.10764em>f</span><span class=mclose>)</span><span class=mord>/</span><span class="mord mathnormal" style=margin-right:0.1132em>τ</span><span class=mclose>)</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:0.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mop>exp</span><span class=mopen>(</span><span class=mop>cos</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.03588em>g</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em></span><span class="mord mathnormal" style=margin-right:0.10764em>f</span><span class=mclose>)</span><span class=mord>/</span><span class="mord mathnormal" style=margin-right:0.1132em>τ</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.307em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mpunct>,</span></span></span></span></span>
<p>其中，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>t_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> 表示用於第 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6595em></span><span class="mord mathnormal">i</span></span></span></span> 類的提示詞，包含該類別名稱的詞嵌入向量。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>ヒント</div><div class=admonitionContent_BuS1><p>除了將類別詞元 <code>[CLASS]</code> 放在提示詞的結尾，也可以將其放置在中間，像是這樣：</p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block><semantics><mrow><mi>t</mi><mo>=</mo><mo stretchy=false>[</mo><mi>V</mi><msub><mo stretchy=false>]</mo><mn>1</mn></msub><mo>…</mo><mo stretchy=false>[</mo><mi>V</mi><msub><mo stretchy=false>]</mo><mfrac><mi>M</mi><mn>2</mn></mfrac></msub><mtext>[CLASS]</mtext><mo stretchy=false>[</mo><mi>V</mi><msub><mo stretchy=false>]</mo><mrow><mfrac><mi>M</mi><mn>2</mn></mfrac><mo>+</mo><mn>1</mn></mrow></msub><mo>…</mo><mo stretchy=false>[</mo><mi>V</mi><msub><mo stretchy=false>]</mo><mi>M</mi></msub><mi mathvariant=normal>.</mi></mrow><annotation encoding=application/x-tex>t = [V]_1 \dots [V]_{\frac{M}{2}} \text{[CLASS]} [V]_{\frac{M}{2}+1} \dots [V]_M.</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6151em></span><span class="mord mathnormal">t</span><span class=mspace style=margin-right:0.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em></span></span><span class=base><span class=strut style=height:1.2565em;vertical-align:-0.5065em></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3448em><span style=top:-2.7343em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8721em><span style=top:-2.656em><span class=pstrut style=height:3em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style=top:-3.2255em><span class=pstrut style=height:3em></span><span class="frac-line mtight" style=border-bottom-width:0.049em></span></span><span style=top:-3.384em><span class=pstrut style=height:3em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.10903em>M</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.344em><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.5065em><span></span></span></span></span></span></span><span class="mord text"><span class=mord>[CLASS]</span></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3448em><span style=top:-2.7343em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8721em><span style=top:-2.656em><span class=pstrut style=height:3em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style=top:-3.2255em><span class=pstrut style=height:3em></span><span class="frac-line mtight" style=border-bottom-width:0.049em></span></span><span style=top:-3.384em><span class=pstrut style=height:3em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.10903em>M</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.344em><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.5065em><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.10903em>M</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mord>.</span></span></span></span></span></div></div>
</li>
<li>
<p><strong>類別專屬上下文</strong></p>
<p>原文為 Class-Specific Context，簡稱 CSC。</p>
<p>在提示詞的設計上，對於每個類別，使用獨立的上下文詞向量。</p>
<p>提示詞的結構如下：</p>
<span class=katex-display><span class=katex><span class=katex-mathml><math display=block><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mo stretchy=false>[</mo><mi>V</mi><msubsup><mo stretchy=false>]</mo><mi>i</mi><mn>1</mn></msubsup><mo stretchy=false>[</mo><mi>V</mi><msubsup><mo stretchy=false>]</mo><mi>i</mi><mn>2</mn></msubsup><mo>…</mo><mo stretchy=false>[</mo><mi>V</mi><msubsup><mo stretchy=false>]</mo><mi>i</mi><mi>M</mi></msubsup><mtext>[CLASS]</mtext><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>t_i = [V]_i^1 [V]_i^2 \dots [V]_i^M \text{[CLASS]},</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em></span></span><span class=base><span class=strut style=height:1.1413em;vertical-align:-0.25em></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8641em><span style=top:-2.453em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.113em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.247em><span></span></span></span></span></span></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8641em><span style=top:-2.453em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.113em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.247em><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8913em><span style=top:-2.453em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.113em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.10903em>M</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.247em><span></span></span></span></span></span></span><span class="mord text"><span class=mord>[CLASS]</span></span><span class=mpunct>,</span></span></span></span></span>
<p>其中，<span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>[</mo><mi>V</mi><msubsup><mo stretchy=false>]</mo><mi>i</mi><mi>m</mi></msubsup></mrow><annotation encoding=application/x-tex>[V]_i^m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0087em;vertical-align:-0.2587em></span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.22222em>V</span><span class=mclose><span class=mclose>]</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.6644em><span style=top:-2.4413em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style=top:-3.063em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2587em><span></span></span></span></span></span></span></span></span></span>（<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>∈</mo><mo stretchy=false>{</mo><mn>1</mn><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mi>M</mi><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>m \in \{1, \dots, M\}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5782em;vertical-align:-0.0391em></span><span class="mord mathnormal">m</span><span class=mspace style=margin-right:0.2778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class=mopen>{</span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em></span><span class="mord mathnormal" style=margin-right:0.10903em>M</span><span class=mclose>}</span></span></span></span>）是一個與詞嵌入維度相同的向量，<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em></span><span class="mord mathnormal" style=margin-right:0.10903em>M</span></span></span></span> 為超參數，表示上下文詞元的數量。</p>
<p>推理過程如下：</p>
<ul>
<li>將提示詞 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>t_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> 傳遞至文本編碼器 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>g(\cdot)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class="mord mathnormal" style=margin-right:0.03588em>g</span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span>，獲得對應的分類權重向量（仍取自 [EOS] 標記的位置）。</li>
<li>預測概率計算公式如下：</li>
</ul>
<span class=katex-display><span class=katex><span class=katex-mathml><math display=block><semantics><mrow><mi>p</mi><mo stretchy=false>(</mo><mi>y</mi><mo>=</mo><mi>i</mi><mi mathvariant=normal>∣</mi><mi>x</mi><mo stretchy=false>)</mo><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>g</mi><mo stretchy=false>(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>f</mi><mo stretchy=false>)</mo><mi mathvariant=normal>/</mi><mi>τ</mi><mo stretchy=false>)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>g</mi><mo stretchy=false>(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>f</mi><mo stretchy=false>)</mo><mi mathvariant=normal>/</mi><mi>τ</mi><mo stretchy=false>)</mo></mrow></mfrac><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>p(y = i|x) = \frac{\exp(\cos(g(t_i), f)/\tau)}{\sum_{j=1}^K \exp(\cos(g(t_j), f)/\tau)},</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class="mord mathnormal">p</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.03588em>y</span><span class=mspace style=margin-right:0.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class="mord mathnormal">i</span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em></span></span><span class=base><span class=strut style=height:2.734em;vertical-align:-1.307em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.427em><span style=top:-2.1288em><span class=pstrut style=height:3em></span><span class=mord><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0em>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.9812em><span style=top:-2.4003em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em>j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.4358em><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.1667em></span><span class=mop>exp</span><span class=mopen>(</span><span class=mop>cos</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.03588em>g</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em></span><span class="mord mathnormal" style=margin-right:0.10764em>f</span><span class=mclose>)</span><span class=mord>/</span><span class="mord mathnormal" style=margin-right:0.1132em>τ</span><span class=mclose>)</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:0.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mop>exp</span><span class=mopen>(</span><span class=mop>cos</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.03588em>g</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em></span><span class="mord mathnormal" style=margin-right:0.10764em>f</span><span class=mclose>)</span><span class=mord>/</span><span class="mord mathnormal" style=margin-right:0.1132em>τ</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.307em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mpunct>,</span></span></span></span></span>
<p>其中，<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>t_i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> 表示用於第 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6595em></span><span class="mord mathnormal">i</span></span></span></span> 類的提示詞，包含該類別名稱的詞嵌入向量。</p>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>ヒント</div><div class=admonitionContent_BuS1><p>簡單來說，要不就是全部的類別都共用一組可學習的上下文詞向量，要不就是每個類別都有自己的一組。<p>直覺上來看，每個類別都有一組屬於自己的上下文詞向量，應該會有更好的效果。<p>真的是這樣嗎？我們繼續看一下實驗結果。</div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=討論>討論<a href=#討論 class=hash-link aria-label="討論 への直接リンク" title="討論 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=在多個資料集上的效果>在多個資料集上的效果<a href=#在多個資料集上的效果 class=hash-link aria-label="在多個資料集上的效果 への直接リンク" title="在多個資料集上的效果 への直接リンク">​</a></h3>
<div align=left><figure style=width:90%><p><img decoding=async loading=lazy alt=result src=/ja/assets/images/img3-393ad3f1460a82827e9b85cf8e3e7e95.jpg width=1636 height=1738 class=img_ev3q>
<figurecaption>實線表示 CoOp 對 CLIP 的改進，星星表示零樣本 CLIP<br>虛線表示線性探針替代方案。<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi></mrow><annotation encoding=application/x-tex>M</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.6833em></span><span class="mord mathnormal" style=margin-right:0.10903em>M</span></span></span></span> 表示上下文長度<br>「end」或「mid」表示將類別標記放在末尾或中間<br>CSC 表示特定於類別的上下文。</figurecaption></figure></div>
<hr>
<p>從上圖可見，CLIP+CoOp 在僅需兩個樣本（2-shot）的情況下，即可顯著超越零樣本 CLIP。當樣本數增加到 16-shot 時，平均性能增益約為 15%。</p>
<p>在 EuroSAT 和 DTD 這兩個專門任務上，性能提升分別超過 45% 和 20%。在細粒度數據集（Flowers102、StanfordCars、FGVCAircraft）以及場景和行動識別數據集（SUN397、UCF101）上，性能增益也普遍超過 10%。</p>
<p>對於挑戰性較高的 ImageNet 數據集（包含 1,000 類別），也提升 4.77%。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=uc-和-csc-的比較>UC 和 CSC 的比較<a href=#uc-和-csc-的比較 class=hash-link aria-label="UC 和 CSC 的比較 への直接リンク" title="UC 和 CSC 的比較 への直接リンク">​</a></h3>
<p>剛提到了統一上下文（Unified Context）與類別專屬上下文（CSC），哪個效果更好呢？</p>
<p>這裡還是根據上圖來看，比較有 CSC 和沒有 CSC 的情況下，UC 的效果。</p>
<p>平均而言，UC 在多數場景下表現更佳。但在細粒度數據集（StanfordCars、Flowers102、FGVCAircraft）及專門任務（DTD、EuroSAT）中，CSC 表現更為突出，特別是在 16-shot 時。</p>
<p>所以並不是說有哪個方法一定比較好，而是根據任務需求選擇適合的版本可以進一步提升性能。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=泛化能力轉移>泛化能力轉移<a href=#泛化能力轉移 class=hash-link aria-label="泛化能力轉移 への直接リンク" title="泛化能力轉移 への直接リンク">​</a></h3>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=zero-shot src=/ja/assets/images/img4-a48b26f0ca75aa29356550b810f3e2ca.jpg width=1040 height=896 class=img_ev3q></figure></div>
<p>由於 CLIP 已經具備很強的 Zero-shot 能力，所以作者擔心 CoOp 基於特定的數據集進行微調，會不會影響到 CLIP 的泛化能力？</p>
<p>上表的 <code>source</code> 指的是使用 <code>ImageNet</code> 進行微調，<code>target</code> 則是用來測試泛化能力的數據集。</p>
<p>實驗結果顯示 CoOp 增強了 CLIP 對分佈轉移的穩健性，表示提示詞的設計和學習具有跨域適應能力。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=需要多長的提示詞>需要多長的提示詞？<a href=#需要多長的提示詞 class=hash-link aria-label="需要多長的提示詞？ への直接リンク" title="需要多長的提示詞？ への直接リンク">​</a></h3>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=context-length src=/ja/assets/images/img5-dd08777092f3f3042520bd5e32b47ad3.jpg width=940 height=788 class=img_ev3q></figure></div>
<p>作者在 11 個數據集上進行實驗，將上下文長度設置為 4、8 和 16。</p>
<p>實驗發現增加上下文詞元數量通常會提升性能，特別是在上下文長度較長（如 16）時，將類別詞元放置於中間（mid）的效果更明顯。但沒有固定的最佳上下文長度，需在性能與分佈轉移穩健性之間尋求平衡。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=初始化方法>初始化方法<a href=#初始化方法 class=hash-link aria-label="初始化方法 への直接リンク" title="初始化方法 への直接リンク">​</a></h3>
<div align=center><figure style=width:40%><p><img decoding=async loading=lazy alt=init src=/ja/assets/images/img6-057f5e340c6cdbb7eafcc51738a6fdaa.jpg width=572 height=252 class=img_ev3q></figure></div>
<p>作者比較了隨機初始化和手工初始化的效果。手工初始化使用 "a photo of a" 的嵌入向量。</p>
<p>結果顯示良好的初始化對性能影響不大，雖然進一步調整初始化詞元可能有所幫助，但隨機初始化在實踐中已足夠高效。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=提示詞的解釋性>提示詞的解釋性<a href=#提示詞的解釋性 class=hash-link aria-label="提示詞的解釋性 への直接リンク" title="提示詞的解釋性 への直接リンク">​</a></h3>
<div align=center><figure style=width:90%><p><img decoding=async loading=lazy alt=explain src=/ja/assets/images/img7-8249c63b5f3b5eac07d1d73b21dfe511.jpg width=1666 height=802 class=img_ev3q></figure></div>
<p>由於上下文向量是在連續空間中優化，難以直接解釋。</p>
<p>這裡作者採用間接方式，基於歐幾里得距離在詞彙表中搜尋與學習向量最近的詞彙。</p>
<p>以下展示在部分數據集上的搜尋結果：</p>
<ul>
<li>Food101："enjoyed" 與任務相關。</li>
<li>OxfordPets："fluffy"、"paw" 有一定相關性。</li>
<li>DTD："pretty" 反映材質描述。</li>
</ul>
<p>實驗結果顯示，基於最近詞解釋學習提示詞的準確性有限，因為向量的語義未必與最近詞完全相關，學習向量可能超越了現有詞彙的語義空間，可能表示了更高維度的語義信息。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=結論>結論<a href=#結論 class=hash-link aria-label="結論 への直接リンク" title="結論 への直接リンク">​</a></h3>
<p>本研究的實驗結果顯示，CoOp 在多個數據集上表現出色，特別是在領域泛化方面，顯著優於手工設計的提示詞，展現了其在數據高效學習中的潛力與優勢。</p>
<p>作為首次針對使用提示詞學習適配大規模視覺模型進行的全面研究，這項工作具有重要的開創性意義，不僅為提示詞學習提供了實證支持，也為未來的研究奠定了基礎。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>ヒント</div><div class=admonitionContent_BuS1><p>需要注意的是，後續研究發現 CoOp 在某些情況下對噪聲標籤較為敏感，且學習到的上下文難以推廣至同一數據集中未見過的類別，顯示出其在訓練期間可能過度擬合於基類的限制性特徵。<p>我們有空再來看看後續的研究是如何克服現有的這些挑戰的。</div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated><b><time datetime=2024-11-26T02:25:43.000Z itemprop=dateModified>2024年11月26日</time></b>に<b>zephyr-sh</b>が<!-- -->最終更新</span></div></div></footer><div style=margin-top:3rem> </div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label=ドキュメントページ><a class="pagination-nav__link pagination-nav__link--prev" href=/ja/papers/model-tuning/lora/><div class=pagination-nav__sublabel>前へ</div><div class=pagination-nav__label>[21.06] LoRA</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/ja/papers/model-tuning/blip2/><div class=pagination-nav__sublabel>次へ</div><div class=pagination-nav__label>[23.01] BLIP-2</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#搖曳的呢喃 class="table-of-contents__link toc-highlight">搖曳的呢喃</a><li><a href=#定義問題 class="table-of-contents__link toc-highlight">定義問題</a><li><a href=#複習-clip class="table-of-contents__link toc-highlight">複習 CLIP</a><li><a href=#解決問題 class="table-of-contents__link toc-highlight">解決問題</a><ul><li><a href=#模型架構 class="table-of-contents__link toc-highlight">模型架構</a></ul><li><a href=#討論 class="table-of-contents__link toc-highlight">討論</a><ul><li><a href=#在多個資料集上的效果 class="table-of-contents__link toc-highlight">在多個資料集上的效果</a><li><a href=#uc-和-csc-的比較 class="table-of-contents__link toc-highlight">UC 和 CSC 的比較</a><li><a href=#泛化能力轉移 class="table-of-contents__link toc-highlight">泛化能力轉移</a><li><a href=#需要多長的提示詞 class="table-of-contents__link toc-highlight">需要多長的提示詞？</a><li><a href=#初始化方法 class="table-of-contents__link toc-highlight">初始化方法</a><li><a href=#提示詞的解釋性 class="table-of-contents__link toc-highlight">提示詞的解釋性</a><li><a href=#結論 class="table-of-contents__link toc-highlight">結論</a></ul></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class=footer__links><a class=footer__link-item href=/ja/docs>オープンソースプロジェクト</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/ja/papers/intro>論文ノート</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/ja/blog>ブログ</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/ja/terms-of-service>利用規約</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/ja/privacy-policy>プライバシーポリシー</a><span class=footer__link-separator>·</span><a href=https://buymeacoffee.com/zephyr_docsaid target=_blank rel="noopener noreferrer" class=footer__link-item>サポートする<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2024 DOCSAID.</div></div></div></footer></div>