"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([["63174"],{4052:function(e,n,r){r.r(n),r.d(n,{metadata:()=>t,contentTitle:()=>d,default:()=>m,assets:()=>l,toc:()=>c,frontMatter:()=>a});var t=JSON.parse('{"id":"gmailsummary/integration","title":"\u6574\u5408 API \u529F\u80FD","description":"\u5728\u9019\u500B\u7AE0\u7BC0\uFF0C\u6211\u5011\u5C07\u4ECB\u7D39\u5982\u4F55\u6574\u5408 GmailAPI \u548C OpenAI API\uFF0C\u8B93\u9019\u5169\u500B\u529F\u80FD\u53EF\u4EE5\u4E00\u8D77\u904B\u4F5C\u3002","source":"@site/i18n/ja/docusaurus-plugin-content-docs/current/gmailsummary/integration.md","sourceDirName":"gmailsummary","slug":"/gmailsummary/integration","permalink":"/ja/docs/gmailsummary/integration","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"zephyr-sh","lastUpdatedAt":1732532862000,"sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"OpenAI API \u547C\u53EB","permalink":"/ja/docs/gmailsummary/openaiapi_using"},"next":{"title":"\u4E32\u63A5\u6240\u6709\u529F\u80FD","permalink":"/ja/docs/gmailsummary/update_infos"}}'),i=r("85893"),s=r("50065");let a={sidebar_position:7},d="\u6574\u5408 API \u529F\u80FD",l={},c=[{value:"\u4E3B\u7A0B\u5F0F",id:"\u4E3B\u7A0B\u5F0F",level:2},{value:"\u4E3B\u7A0B\u5F0F\u4ECB\u7D39",id:"\u4E3B\u7A0B\u5F0F\u4ECB\u7D39",level:2},{value:"1. \u5C0E\u5165\u6A21\u7D44",id:"1-\u5C0E\u5165\u6A21\u7D44",level:3},{value:"2. \u751F\u6210\u5831\u544A",id:"2-\u751F\u6210\u5831\u544A",level:3},{value:"3. \u4E3B\u7A0B\u5F0F",id:"3-\u4E3B\u7A0B\u5F0F",level:3},{value:"4. \u547D\u4EE4\u884C\u53C3\u6578\u8655\u7406",id:"4-\u547D\u4EE4\u884C\u53C3\u6578\u8655\u7406",level:3}];function o(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u6574\u5408-api-\u529F\u80FD",children:"\u6574\u5408 API \u529F\u80FD"})}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u9019\u500B\u7AE0\u7BC0\uFF0C\u6211\u5011\u5C07\u4ECB\u7D39\u5982\u4F55\u6574\u5408 GmailAPI \u548C OpenAI API\uFF0C\u8B93\u9019\u5169\u500B\u529F\u80FD\u53EF\u4EE5\u4E00\u8D77\u904B\u4F5C\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u4E3B\u7A0B\u5F0F",children:"\u4E3B\u7A0B\u5F0F"}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u5011\u5148\u4F86\u770B\u4E00\u4E0B\u4E3B\u7A0B\u5F0F\u7684\u67B6\u69CB\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from argparse import ArgumentParser\nfrom datetime import datetime, timedelta\n\nfrom gmail_api import build_service, get_messages, parse_message\nfrom openai_api import chatgpt_summary\nfrom tqdm import tqdm\n\n\ndef generate_markdown_report(input_text, project_name, date):\n    title = f"{project_name} \u66F4\u65B0\u5831\u544A - {date}"\n    markdown_text = input_text.replace(\'\\n\', \'\\n\\n\')\n    markdown_content = f"# {title}\\n\\n{markdown_text}"\n    file_name = f"{project_name}-update-{date}.md"\n    with open(file_name, "w", encoding="utf-8") as file:\n        file.write(markdown_content)\n    return file_name\n\n\ndef main(project_name, time_length):\n\n    current_date = datetime.now()\n    after_date = current_date - timedelta(days=time_length)\n    after_date = after_date.strftime(\'%Y/%m/%d\')\n\n    service = build_service()\n    messages = get_messages(\n        service,\n        after_date=after_date,\n        subject_filter=project_name\n    )\n\n    results = [\n        parse_message(service, msg[\'id\'])\n        for msg in tqdm(messages)\n    ]\n\n    # \u8ABF\u7528 OpenAI API\n    summary = chatgpt_summary(results)\n    summary = f\'{summary}\\n\\n---\\n\\n\u4EE5\u4E0A\u5831\u544A\u7531 OpenAI GPT-3.5 Turbo \u6A21\u578B\u81EA\u52D5\u751F\u6210\u3002\'\n\n    # \u751F\u6210 Markdown \u5831\u544A\n    markdown_file = generate_markdown_report(\n        summary, project_name, current_date.strftime(\'%Y-%m-%d\'))\n    print(f"Markdown \u6587\u4EF6\u5DF2\u751F\u6210: {markdown_file}")\n\n\nif __name__ == "__main__":\n    parser = ArgumentParser(description="Generate a project update report.")\n    parser.add_argument(\n        "--project_name",\n        type=str,\n        help="The name of the project to track.",\n        default="Albumentations"\n    )\n    parser.add_argument(\n        "--time_length",\n        type=int,\n        help="The time length (in days) to track updates.",\n        default=1\n    )\n\n    args = parser.parse_args()\n\n    main(args.project_name, args.time_length)\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u4E3B\u7A0B\u5F0F\u4ECB\u7D39",children:"\u4E3B\u7A0B\u5F0F\u4ECB\u7D39"}),"\n",(0,i.jsx)(n.h3,{id:"1-\u5C0E\u5165\u6A21\u7D44",children:"1. \u5C0E\u5165\u6A21\u7D44"}),"\n",(0,i.jsx)(n.p,{children:"\u7A0B\u5F0F\u958B\u982D\u5C0E\u5165\u4E86\u9700\u8981\u7684 Python \u6A21\u584A\u548C\u81EA\u5B9A\u7FA9\u7684\u51FD\u6578\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ArgumentParser"})," \u7528\u65BC\u89E3\u6790\u547D\u4EE4\u884C\u53C3\u6578\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"datetime"})," \u548C ",(0,i.jsx)(n.code,{children:"timedelta"})," \u7528\u65BC\u8655\u7406\u65E5\u671F\u548C\u6642\u9593\u8A08\u7B97\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"build_service"}),", ",(0,i.jsx)(n.code,{children:"get_messages"}),", ",(0,i.jsx)(n.code,{children:"parse_message"})," \u662F\u7528\u65BC\u8655\u7406 Gmail API \u7684\u76F8\u95DC\u64CD\u4F5C\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"chatgpt_summary"})," \u662F\u7528\u4F86\u8ABF\u7528 OpenAI API \u751F\u6210\u90F5\u4EF6\u5167\u5BB9\u7684\u7E3D\u7D50\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-\u751F\u6210\u5831\u544A",children:"2. \u751F\u6210\u5831\u544A"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"generate_markdown_report"})," \u9019\u500B\u51FD\u6578\u8CA0\u8CAC\u751F\u6210 Markdown \u683C\u5F0F\u7684\u5831\u544A\u6587\u4EF6\uFF1A"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u63A5\u6536 ",(0,i.jsx)(n.code,{children:"input_text"}),"\uFF08\u90F5\u4EF6\u5167\u5BB9\u7684\u7E3D\u7D50\uFF09\u3001",(0,i.jsx)(n.code,{children:"project_name"}),"\uFF08\u5C08\u6848\u540D\u7A31\uFF09\u548C ",(0,i.jsx)(n.code,{children:"date"}),"\uFF08\u65E5\u671F\uFF09\u4F5C\u70BA\u53C3\u6578\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u5C07 ",(0,i.jsx)(n.code,{children:"input_text"})," \u4E2D\u7684\u63DB\u884C\u7B26\u66FF\u63DB\u70BA Markdown \u7684\u63DB\u884C\u683C\u5F0F\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u751F\u6210 Markdown \u6587\u4EF6\u7684\u6A19\u984C\u548C\u5167\u5BB9\uFF0C\u7136\u5F8C\u5BEB\u5165\u4E00\u500B\u4EE5\u5C08\u6848\u540D\u7A31\u548C\u65E5\u671F\u547D\u540D\u7684 ",(0,i.jsx)(n.code,{children:".md"})," \u6587\u4EF6\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"3-\u4E3B\u7A0B\u5F0F",children:"3. \u4E3B\u7A0B\u5F0F"}),"\n",(0,i.jsx)(n.p,{children:"\u4E3B\u7A0B\u5F0F\u57F7\u884C\u4EE5\u4E0B\u6B65\u9A5F\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u8A2D\u5B9A\u7576\u524D\u65E5\u671F\u548C\u904E\u53BB\u65E5\u671F\uFF08\u57FA\u65BC ",(0,i.jsx)(n.code,{children:"time_length"})," \u53C3\u6578\u8A08\u7B97\uFF09\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u901A\u904E ",(0,i.jsx)(n.code,{children:"build_service"})," \u51FD\u6578\u69CB\u5EFA Gmail API \u670D\u52D9\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u8ABF\u7528 ",(0,i.jsx)(n.code,{children:"get_messages"})," \u7372\u53D6\u6307\u5B9A\u65E5\u671F\u5F8C\u548C\u5305\u542B\u6307\u5B9A\u5C08\u6848\u540D\u7A31\u7684\u90F5\u4EF6\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u4F7F\u7528 ",(0,i.jsx)(n.code,{children:"tqdm"})," \u9032\u5EA6\u689D\u986F\u793A\u90F5\u4EF6\u89E3\u6790\u9032\u5EA6\u3002"]}),"\n",(0,i.jsx)(n.li,{children:"\u89E3\u6790\u6BCF\u500B\u90F5\u4EF6\u7684\u5167\u5BB9\u4E26\u5C07\u5176\u50B3\u9001\u5230 OpenAI API \u9032\u884C\u7E3D\u7D50\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u5C07\u7E3D\u7D50\u7684\u5167\u5BB9\u6DFB\u52A0\u5230 Markdown \u6587\u4EF6\u4E26\u751F\u6210\u8A72\u6587\u4EF6\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"4-\u547D\u4EE4\u884C\u53C3\u6578\u8655\u7406",children:"4. \u547D\u4EE4\u884C\u53C3\u6578\u8655\u7406"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u8F38\u5165\u5340\u584A\u4E2D\uFF0C\u7A0B\u5F0F\u89E3\u6790\u5169\u500B\u547D\u4EE4\u884C\u53C3\u6578\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"--project_name"}),'\uFF1A\u7528\u6236\u6307\u5B9A\u7684\u5C08\u6848\u540D\u7A31\uFF0C\u9ED8\u8A8D\u70BA "Albumentations"\u3002']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"--time_length"}),"\uFF1A\u8DDF\u8E2A\u66F4\u65B0\u7684\u6642\u9593\u9577\u5EA6\uFF08\u5929\uFF09\uFF0C\u9ED8\u8A8D\u70BA 1 \u5929\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u9019\u4E9B\u53C3\u6578\u5141\u8A31\u7528\u6236\u5B9A\u5236\u5316\u751F\u6210\u5831\u544A\u7684\u5C08\u6848\u540D\u548C\u671F\u9593\u3002"})]})}function m(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},50065:function(e,n,r){r.d(n,{Z:function(){return d},a:function(){return a}});var t=r(67294);let i={},s=t.createContext(i);function a(e){let n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);