<!doctype html><html lang=zh-hant dir=ltr class="docs-wrapper plugin-docs plugin-id-papers docs-version-current docs-doc-page docs-doc-id-image-generation/mar/index" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>[24.06] MAR | DOCSAID</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://docsaid.org/img/docsaid-social-card.jpg><meta data-rh=true name=twitter:image content=https://docsaid.org/img/docsaid-social-card.jpg><meta data-rh=true property=og:url content=https://docsaid.org/papers/image-generation/mar/><meta data-rh=true property=og:locale content=zh_hant><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true property=og:locale:alternate content=ja><meta data-rh=true name=docusaurus_locale content=zh-hant><meta data-rh=true name=docsearch:language content=zh-hant><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-papers-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-papers-current><meta data-rh=true property=og:title content="[24.06] MAR | DOCSAID"><meta data-rh=true name=description content=重鑄生成的秩序><meta data-rh=true property=og:description content=重鑄生成的秩序><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://docsaid.org/papers/image-generation/mar/><link data-rh=true rel=alternate href=https://docsaid.org/papers/image-generation/mar/ hreflang=zh-hant><link data-rh=true rel=alternate href=https://docsaid.org/en/papers/image-generation/mar/ hreflang=en><link data-rh=true rel=alternate href=https://docsaid.org/ja/papers/image-generation/mar/ hreflang=ja><link data-rh=true rel=alternate href=https://docsaid.org/papers/image-generation/mar/ hreflang=x-default><link data-rh=true rel=preconnect href=https://S9NC0RYCHF-dsn.algolia.net crossorigin=anonymous><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="DOCSAID RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="DOCSAID Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-RDF83L9R4M"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RDF83L9R4M",{anonymize_ip:!0})</script><link rel=search type=application/opensearchdescription+xml title=DOCSAID href=/opensearch.xml><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css type=text/css integrity=sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM crossorigin=anonymous><link rel=stylesheet href=/assets/css/styles.4e9ddbd4.css><script src=/assets/js/runtime~main.2a585289.js defer></script><script src=/assets/js/main.3e9833e9.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label=跳至主要内容><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>跳至主要内容</a></div><nav aria-label=主導航 class="navbar navbar--fixed-top navbarHideable_jvwV"><div class=navbar__inner><div class=navbar__items><button aria-label=切換導覽列 aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/docsaid_logo.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/docsaid_logo_white.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href=/docs/>開源專案</a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/papers/intro>論文筆記</a><a class="navbar__item navbar__link" href=/blog>部落格</a><a class="navbar__item navbar__link" href=/playground/intro>遊樂場</a><a class="navbar__item navbar__link" href=/services>技術服務</a><a class="navbar__item navbar__link" href=/aboutus>關於我們</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>繁體中文</a><ul class=dropdown__menu><li><a href=/papers/image-generation/mar/ target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=zh-hant>繁體中文</a><li><a href=/en/papers/image-generation/mar/ target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/ja/papers/image-generation/mar/ target=_self rel="noopener noreferrer" class=dropdown__link lang=ja>日本語</a></ul></div><div class=navbarSearchContainer_dCNk><button type=button class="DocSearch DocSearch-Button" aria-label="搜尋 (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>搜尋</span></span><span class=DocSearch-Button-Keys></span></button></div><button type=button class="ant-btn css-1m2bkf9 ant-btn-circle ant-btn-default ant-btn-color-default ant-btn-variant-outlined ant-btn-icon-only"><span class=ant-btn-icon><span role=img aria-label=user style=font-size:18px class="anticon anticon-user"><svg viewBox="64 64 896 896" focusable=false data-icon=user width=1em height=1em fill=currentColor aria-hidden=true><path d="M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"/></svg></span></span></button></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_eExm"><div class=docsWrapper_hBAB><button aria-label=回到頂部 class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/><img src=/img/docsaid_logo.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/docsaid_logo_white.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b></b></a><nav aria-label=文件側邊欄 class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/papers/intro>論文筆記</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/classic-cnns-11>Classic CNNs (11)</a><button aria-label="展開側邊欄分類 'Classic CNNs (11)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/contrastive-learning-13>Contrastive Learning (13)</a><button aria-label="展開側邊欄分類 'Contrastive Learning (13)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/deepseek-5>DeepSeek (5)</a><button aria-label="展開側邊欄分類 'DeepSeek (5)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/face-anti-spoofing-35>Face Anti-Spoofing (35)</a><button aria-label="展開側邊欄分類 'Face Anti-Spoofing (35)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/face-recognition-4>Face Recognition (4)</a><button aria-label="展開側邊欄分類 'Face Recognition (4)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/feature-fusion-10>Feature Fusion (10)</a><button aria-label="展開側邊欄分類 'Feature Fusion (10)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/papers/category/image-generation-1>Image Generation (1)</a><button aria-label="收起側邊欄分類 'Image Generation (1)'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/papers/image-generation/mar/>[24.06] MAR</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/lightweight-10>Lightweight (10)</a><button aria-label="展開側邊欄分類 'Lightweight (10)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/mamba-4>Mamba (4)</a><button aria-label="展開側邊欄分類 'Mamba (4)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/model-tuning-8>Model Tuning (8)</a><button aria-label="展開側邊欄分類 'Model Tuning (8)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/multimodality-24>Multimodality (24)</a><button aria-label="展開側邊欄分類 'Multimodality (24)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/normalization-1>Normalization (1)</a><button aria-label="展開側邊欄分類 'Normalization (1)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/object-detection-8>Object Detection (8)</a><button aria-label="展開側邊欄分類 'Object Detection (8)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/reparameterization-8>Reparameterization (8)</a><button aria-label="展開側邊欄分類 'Reparameterization (8)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/segmentation-1>Segmentation (1)</a><button aria-label="展開側邊欄分類 'Segmentation (1)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/text-detection-14>Text Detection (14)</a><button aria-label="展開側邊欄分類 'Text Detection (14)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/text-recognition-20>Text Recognition (20)</a><button aria-label="展開側邊欄分類 'Text Recognition (20)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/text-spotting-4>Text Spotting (4)</a><button aria-label="展開側邊欄分類 'Text Spotting (4)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/transformers-17>Transformers (17)</a><button aria-label="展開側邊欄分類 'Transformers (17)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/papers/category/vision-transformers-12>Vision Transformers (12)</a><button aria-label="展開側邊欄分類 'Vision Transformers (12)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/papers/intro>All Notes: 210 entries</a></ul></nav><button type=button title=收起側邊欄 aria-label=收起側邊欄 class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=頁面路徑><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label=主頁面 class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/papers/category/image-generation-1><span itemprop=name>Image Generation (1)</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>[24.06] MAR</span><meta itemprop=position content=2></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">本頁導覽</button></div><div class="theme-doc-markdown markdown"><header><h1>[24.06] MAR</h1><div class="undefined margin-bottom--md"><div class=docAuthor_y7l7><img src=https://github.com/nbswords.png alt=nbswords class=docAuthorImg_vlJe><div><div class=docAuthorName_aSh4><a href=https://github.com/nbswords target=_blank rel="noopener noreferrer">nbswords</a></div><div class=docAuthorTitle_Yp5_>Research Engineer</div><div class=docAuthorSocials_M3ba><a href=https://github.com/nbswords target=_blank rel="noopener noreferrer" class=docAuthorSocialLink_trj9><svg stroke=currentColor fill=currentColor stroke-width=0 viewBox="0 0 496 512" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></a><a href=https://www.linkedin.com/in/nbswords/ target=_blank rel="noopener noreferrer" class=docAuthorSocialLink_trj9><svg stroke=currentColor fill=currentColor stroke-width=0 viewBox="0 0 448 512" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></a><a href=https://x.com/nbswordsYu target=_blank rel="noopener noreferrer" class=docAuthorSocialLink_trj9><svg stroke=currentColor fill=currentColor stroke-width=0 viewBox="0 0 512 512" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=重鑄生成的秩序>重鑄生成的秩序<a href=#重鑄生成的秩序 class=hash-link aria-label=重鑄生成的秩序的直接連結 title=重鑄生成的秩序的直接連結>​</a></h2>
<p><a href=https://arxiv.org/abs/2406.11838 target=_blank rel="noopener noreferrer"><strong>Autoregressive Image Generation without Vector Quantization</strong></a></p>
<hr>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>資訊</div><div class=admonitionContent_BuS1><p>本篇同步發表於 <a href=https://medium.com/@nbswords/autoregressive-image-generation-without-vector-quantization-516b68b5acfa target=_blank rel="noopener noreferrer"><strong>nbswords 的 Medium</strong></a></div></div>
<p>當前的自迴歸圖片生成模型常使用 vector quantized(VQ)將圖片離散化成一個個 token 來模擬自迴歸模型在 NLP 領域上的成功，但作者認為這種離散值空間對於自迴歸圖片生成模型並不是必要的，因此提出一種基於連續空間的自迴歸圖片生成模型，兼具更高的準度以及快速的推論時間。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=背景知識>背景知識<a href=#背景知識 class=hash-link aria-label=背景知識的直接連結 title=背景知識的直接連結>​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vector-quantization-vq>Vector Quantization (VQ)<a href=#vector-quantization-vq class=hash-link aria-label="Vector Quantization (VQ)的直接連結" title="Vector Quantization (VQ)的直接連結">​</a></h3>
<p>這是一種行之有年的向量搜尋加速技巧，作法是將一個特徵空間向量(embedding vector)切割成不同的群組，每個群組以一個代表向量來當做 index，再透過一份包含所有代表向量索引的 codebook 來存取這群向量。</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=VQ src=/assets/images/img1-f74853576533d516a078f6ba6abac69b.jpg width=875 height=656 class=img_ev3q></figure></div>
<p>詳細作法可參考 <a href=https://medium.com/@nbswords/survey-of-vector-space-search-26555890ca5e target=_blank rel="noopener noreferrer">Survey Of Vector Space Search</a> 或是 <a href=https://en.wikipedia.org/wiki/Vector_quantization target=_blank rel="noopener noreferrer">Vector quantization wiki</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=auto-regressive-image-generation>Auto-regressive image generation<a href=#auto-regressive-image-generation class=hash-link aria-label="Auto-regressive image generation的直接連結" title="Auto-regressive image generation的直接連結">​</a></h3>
<p>早期的 Visual Autoregressive Model (VAR)是直接將圖片生成任務模擬成 GPT-like 的自迴歸文字生成，透過將圖片每一個像素都視為一個種類，模型的任務使用 categorical cross entropy 做多類別預測，如 Google 的<a href=https://arxiv.org/abs/1802.05751 target=_blank rel="noopener noreferrer">Image Transformer, 2018</a>和 OpenAI 的<a href=https://cdn.openai.com/papers/Generative_Pretraining_from_Pixels_V2.pdf target=_blank rel="noopener noreferrer">ImageGPT, 2020</a>都屬於這種方法</p>
<p>而為了加速圖片生成的速度，現在的自迴歸圖片生成模型的常見作法是引入 VQ 做兩階段訓練，第一階段先在 latent space 中學習用來做圖片重建的 codebook，第二階段則基於這個 learned codebook 去自迴歸地生成圖片</p>
<ul>
<li>以<a href=https://arxiv.org/abs/1711.00937 target=_blank rel="noopener noreferrer">VQ-VAE, 2017</a>為例<!-- -->
<ul>
<li>Encode 階段先透過是一個 CNN 擷取出圖片特徵，然後對 feature map <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>z</mi><mi>e</mi></msub></mrow><annotation encoding=application/x-tex>z_e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:0.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em><span style=top:-2.55em;margin-left:-0.044em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> 做 VQ，得到每個群組的代表向量(紫色的向量, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>e_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> ~ <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>e</mi><mi>K</mi></msub></mrow><annotation encoding=application/x-tex>e_K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal">e</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span>)，接下來計算 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>z</mi><mi>e</mi></msub></mrow><annotation encoding=application/x-tex>z_e</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:0.04398em>z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em><span style=top:-2.55em;margin-left:-0.044em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span></span></span></span> 中每一個特徵點跟代表向量之間的距離，取距離最近的代表向量 index 來取代掉他們得到 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi><mo stretchy=false>(</mo><mi>z</mi><mi mathvariant=normal>∣</mi><mi>x</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>q(z|x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class="mord mathnormal" style=margin-right:0.03588em>q</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.04398em>z</span><span class=mord>∣</span><span class="mord mathnormal">x</span><span class=mclose>)</span></span></span></span>，這個 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em></span><span class="mord mathnormal" style=margin-right:0.03588em>q</span></span></span></span> 正是離散的特徵。</li>
<li>Decode 階段則使用從 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em></span><span class="mord mathnormal" style=margin-right:0.03588em>q</span></span></span></span> 映射回來的 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>Z</mi><mi>q</mi></msub></mrow><annotation encoding=application/x-tex>Z_q</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.9694em;vertical-align:-0.2861em></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em>Z</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03588em>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em><span></span></span></span></span></span></span></span></span></span> 做圖片生成。</li>
</ul>
</li>
</ul>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=VQ-VAE src=/assets/images/img2-02517e55f6b6fd15a280d398132135be.jpg width=1304 height=537 class=img_ev3q></figure></div>
<p>自迴歸模型透過 VQ 來加速圖片生成聽起來很棒，但是，這樣的方法難道沒有什麼缺點嗎?</p>
<p>當然有，1. VQ 編碼器很難訓練 2. VQ 會降低重建出來的圖片品質</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=method>Method<a href=#method class=hash-link aria-label=Method的直接連結 title=Method的直接連結>​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=放棄-vq擁抱-diffusion>放棄 VQ，擁抱 Diffusion<a href=#放棄-vq擁抱-diffusion class=hash-link aria-label="放棄 VQ，擁抱 Diffusion的直接連結" title="放棄 VQ，擁抱 Diffusion的直接連結">​</a></h3>
<p>既然 diffusion model 可以用來表現一張圖片中所有 pixels 或 tokens 的聯合機率分布，那為何不能用來表現每一個 token 的機率分布呢?</p>
<ul>
<li>Diffusion 可以將輸入的 prompt/image 作為條件從 noise 中產圖</li>
</ul>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=diffusion+text_prompt src=/assets/images/img3-a20e0d0d126d7c3c5ac6876c6c1ff3b1.jpg width=954 height=482 class=img_ev3q></figure></div>
<ul>
<li>而現在是改為將一個 transformer 的輸出作為條件從 noise 中產圖 (這個 transformer 的輸入是什麼等等會講到)</li>
</ul>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=diffusion+transformer src=/assets/images/img4-087d1806c9bd61c8eca3f09fab06eed7.jpg width=972 height=554 class=img_ev3q></figure></div>
<p>他們的做法是自迴歸地去預測出每一個 token 的條件 z，然後利用一個 diffusion model(small MLP)做 denosing 來得到 output x 的機率分布 p(x|z)</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=autoregressive_diffusion src=/assets/images/img5-c79c367e42bc3ed8656a502d29a6797f.jpg width=508 height=355 class=img_ev3q></figure></div>
<p>提出 Diffusion Loss 來取代原本的 categorical cross entropy</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=diffusion_cal src=/assets/images/img6-f52aa8173a4413b25ec0f5a9f5e49a3a.jpg width=543 height=80 class=img_ev3q></figure></div>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=diffusion_cal_2 src="data:image/jpeg;base64,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" width=324 height=69 class=img_ev3q></figure></div>
<ul>
<li>ε 是一個從(0, 1)常態分布中抽樣出來的noise sample</li>
<li>εθ 是一個 small MLP，<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ε</mi><mi>θ</mi></msub><mo stretchy=false>(</mo><msub><mi>x</mi><mi>t</mi></msub><mi mathvariant=normal>∣</mi><mi>t</mi><mo separator=true>,</mo><mi>z</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>ε_θ(x_t|t, z)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-0.25em></span><span class=mord><span class="mord mathnormal">ε</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em>θ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.2806em><span style=top:-2.55em;margin-left:0em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class=mord>∣</span><span class="mord mathnormal">t</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em></span><span class="mord mathnormal" style=margin-right:0.04398em>z</span><span class=mclose>)</span></span></span></span> 的意思是這個模型會基於t跟z作為生成條件，然後輸入x_t來得到noise vector ε_θ<!-- -->
<ul>
<li>t是noise schedule的 timestamp，z是由Transformer基於上下文產生出來的condition vector</li>
</ul>
</li>
</ul>
<p>最後，跟 DDPM 一樣，在推論階段，模型會透過 reverse diffusion process 來產生出圖片 (從 x_t -> x_0)</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=reverse_diff src=/assets/images/img8-2ddbeaa437c343e08c991bd632d4a991.jpg width=741 height=72 class=img_ev3q></figure></div>
<p>除此之外，若讀者們有使用過 diffusion model 來做圖片生成肯定曾看到過一個超參數叫做溫度(temperature)，溫度越高表示有越高的隨機性，溫度越低則隨機性越低，這是一個控制採樣隨機性的參數，在本作中採用溫度 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>τ</mi></mrow><annotation encoding=application/x-tex>\tau</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.4306em></span><span class="mord mathnormal" style=margin-right:0.1132em>τ</span></span></span></span> * <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>σ</mi><mi>t</mi></msub><mi>δ</mi></mrow><annotation encoding=application/x-tex>\sigma_t \delta</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0.8444em;vertical-align:-0.15em></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.2806em><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em><span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:0.03785em>δ</span></span></span></span> 來控制，這個方法出自<a href=https://arxiv.org/abs/2105.05233 target=_blank rel="noopener noreferrer">Diffusion Models Beat GANs on Image Synthesis</a></p>
<p>仔細想就會發現，這是一個將 VAE 的條件生成以及 DDPM 的降噪結合在一起使用的方法，用 VAE 壓縮圖像特徵並用 DDPM 來生成圖片，非常精妙</p>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=VAE_and_Diffusion src=/assets/images/img9-2c8c638a704853f10387abcb1e484c74.jpg width=1603 height=431 class=img_ev3q></figure></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=融入-autoregressive-和-masked-generative-models-的概念>融入 Autoregressive 和 Masked Generative Models 的概念<a href=#融入-autoregressive-和-masked-generative-models-的概念 class=hash-link aria-label="融入 Autoregressive 和 Masked Generative Models 的概念的直接連結" title="融入 Autoregressive 和 Masked Generative Models 的概念的直接連結">​</a></h3>
<p>愷明作為<a href=https://arxiv.org/abs/2111.06377 target=_blank rel="noopener noreferrer">MAE(Masked Autoencoders Are Scalable Vision Learners), 2021</a>的作者，接下來想到的當然是將 MAE 的概念一起融入到模型當中</p>
<ul>
<li>主要的流程參考 MAE 的後續作品<a href=https://arxiv.org/abs/2202.04200 target=_blank rel="noopener noreferrer">MaskGIT, 2022</a>和<a href=https://arxiv.org/abs/2211.09117 target=_blank rel="noopener noreferrer">MAGE, 2022</a>，兩者都是拿 Transformer 做 Masked Autoregressive(MAR)，其中 MaskGIT 的貢獻是使用 bidirectional transformer decoder 去同時預測多個 token 而 MAGE 的貢獻是統一圖片表徵學習與圖片合成</li>
<li>在本作中同樣採用了 MAE 的雙向注意力機制，將 mask token [m]放在中間層讓所有 token 能看見彼此，而不是只能看到前面的 token，並且只對沒有被 mask 到的 token 計算 loss - 請注意，這並不是一般認為的 causal vs bidirectional attention，若想要深入理解請去閱讀 MAE 原始論文 - 這樣做的好處是圖片生成的表現會變好，壞處是這會讓 transformer 的訓練和推論無法使用 kv cache 加速，但也由於可以同時預測多個 token，這個方法並不會太慢</li>
</ul>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=bidirect src=/assets/images/img10-aba7fcdbac546aa2e68355a286a723d1.jpg width=696 height=668 class=img_ev3q></figure></div>
<ul>
<li>下圖是一般順序的 AR、隨機順序的 AR(random masking one token)和他們使用的同時預測多個 token 的 AR(random masking multiple token)的比較 - 這裡就揭曉了前面那個 transformer 的輸入是一個 masked image</li>
</ul>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=AR_and_MAR src=/assets/images/img11-d2104821c1e5aa8f79ea0b971d3cedcc.jpg width=816 height=570 class=img_ev3q></figure></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=implementation>Implementation<a href=#implementation class=hash-link aria-label=Implementation的直接連結 title=Implementation的直接連結>​</a></h2>
<ul>
<li>Diffusion Loss：cosine 形狀的 noise schedule，訓練時 DDPM 有 1000 step 而推論則僅有 100 step</li>
<li>Denoising MLP(small MLP)：3 層 1024 個 channel 的 block，每一個 block 包含 LayerNorm, linear layer， SiLU 激活函數並使用 residual connection 連接，實作上是使用 AdaLN 將 transformer 的輸出 z 加入到 LayerNorm 層當中</li>
<li>Tokenizer：使用 LDM 提供的公開 tokenizer，包括 VQ-16 和 KL-16。其中 VQ-16 是基於 VQ-GAN 的量化模型，使用 GAN loss 和感知 loss，KL-16 則透過 KL 散度做 regularization 且不依賴 VQ</li>
<li>Transformer：使用 ViT 來接收 tokenizer 處理後的 token sequence，加上位置編碼和類別 token [CLS]，然後通過 32 層 1024 個 channel 的 transformer block</li>
<li>Masked autoregressive models：在訓練階段使用 [0.7, 1.0] 的 masking ratio，0.7 代表隨機遮蔽掉 70%的 token，另外為了避免抽樣出來的序列太短，他們始終 pad 64 個[cls] token 到其中。在推理階段會逐步將 1.0 的 masking ratio 降低到 0，並使用 cosine schedule 來調整步數，預設是 64 步</li>
<li>Baseline Autoregressive Model: causal attention 的 GPT 模型，輸入有 append 一個[cls]，並且有使用 kv cache 以及溫度參數</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=experiments>Experiments<a href=#experiments class=hash-link aria-label=Experiments的直接連結 title=Experiments的直接連結>​</a></h2>
<p>模型實驗設定都是 AR/MAR-L (∼400M parameters), 400 epochs, ImageNet 256×256</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=diffusion-loss-vs-cross-entropy-loss>Diffusion Loss vs. Cross-entropy Loss<a href=#diffusion-loss-vs-cross-entropy-loss class=hash-link aria-label="Diffusion Loss vs. Cross-entropy Loss的直接連結" title="Diffusion Loss vs. Cross-entropy Loss的直接連結">​</a></h3>
<p>在所有 AR/MAR 的變體之下，使用 Diff Loss 的表現都比較好，其中 AR 的改進最少，越往下改進越多，MAR+bidirect+>1 preds 的改進最多，可見 Diff Loss 對於 MAR 模型的重要性</p>
<ul>
<li>Diff Loss 也有使用其他擴散模型也有的 CFG(Classifier-Free Guidance)來提升生成效果</li>
<li>Fréchet inception distance (FID) 是越低越好，Inception Score (IS)則是越高越好，兩個 metrics 都是在衡量生成的圖片品質</li>
</ul>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt="Diffusion Loss" src=/assets/images/img12-77434de701c031ee57b0b07c3ce8e694.jpg width=1498 height=433 class=img_ev3q></figure></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=tokenizers>Tokenizers<a href=#tokenizers class=hash-link aria-label=Tokenizers的直接連結 title=Tokenizers的直接連結>​</a></h3>
<p>實驗不同的 tokenizers 搭配 Diff loss 的效果，由於從離散空間脫離到了連續空間，tokenizer 不再受限，Diff loss 可以適用在連續/離散的 tokenizer 上</p>
<ul>
<li>VQ-16 指的是將 VQ-VAE 中作 VQ 之前的連續值 latent 作為 token，前面也有提過這裡的 VQ-16 跟 KL-16 都是使用 LDM 提供的，只是他們改為在 ImageNet 上訓練而非 OpenImages 上</li>
<li>Consistency Decoder 是一個非 VQ 的 Tokenizer，來自<a href=https://github.com/openai/consistencydecoder target=_blank rel="noopener noreferrer">DALL·E 3</a></li>
<li>reconstruction FID (rFID) 越低越好，用來評估 tokenizer</li>
</ul>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt=Tokenizers src=/assets/images/img13-8250cad95bfb70573f1c8f3f468b4419.jpg width=1430 height=321 class=img_ev3q></figure></div>
<p>結果顯示使用連續型的 tokenizer 如 KL-16 會比離散型的 VQ-16 表現好，另外也順便展示了一下能兼容在不同的 tokenizer 如 Consistency Decoder 上</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=denosing-mlp>Denosing MLP<a href=#denosing-mlp class=hash-link aria-label="Denosing MLP的直接連結" title="Denosing MLP的直接連結">​</a></h3>
<p>不同參數大小的 MLP 表現差異，width=1024 的表現最好</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt="Denosing MLP" src=/assets/images/img14-83a8c46a5314c97327752c6bb9ba6cd9.jpg width=901 height=285 class=img_ev3q></figure></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=sampling-steps-of-diffusion-loss>Sampling steps of Diffusion Loss<a href=#sampling-steps-of-diffusion-loss class=hash-link aria-label="Sampling steps of Diffusion Loss的直接連結" title="Sampling steps of Diffusion Loss的直接連結">​</a></h3>
<p>不同 Diffusion steps 對於生成品質的影響，steps=100 就可以獲得很好的效果</p>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt="Sampling steps of Diffusion Loss" src=/assets/images/img15-42662a0c0fc5e8a350f9a7bdd57dba6c.jpg width=950 height=303 class=img_ev3q></figure></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=temperature-of-diffusion-loss>Temperature of Diffusion Loss<a href=#temperature-of-diffusion-loss class=hash-link aria-label="Temperature of Diffusion Loss的直接連結" title="Temperature of Diffusion Loss的直接連結">​</a></h3>
<p>對 Diff Loss 來說溫度也很重要</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=Temperature src=/assets/images/img16-12abcebd945dac79cac80483fc029a04.jpg width=892 height=423 class=img_ev3q></figure></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=speedaccuracy-trade-off>Speed/accuracy trade-off<a href=#speedaccuracy-trade-off class=hash-link aria-label="Speed/accuracy trade-off的直接連結" title="Speed/accuracy trade-off的直接連結">​</a></h3>
<p>由於無法使用 kv cache，這個評估非常重要，這裡是用一個 A100 然後 batch size=256 來測試</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=Speed src=/assets/images/img17-903f63b92d80a5694d99a2f6e25bcffb.jpg width=791 height=582 class=img_ev3q></figure></div>
<ul>
<li>MAR: 每一個點代表不同的 autoregressive step(8 to 128)</li>
<li>DiT: 每一個點代表不同的 diffusion steps(50, 75, 150, 250)，這裡使用的 DiT-XL</li>
<li>AR: 套用了 kv cache</li>
</ul>
<p>可見即使無法使用 kv cache 這個模型也有不差的推論速度，不過 default 設定(step=64)還是慢了不少</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=system-level-comparison>System-level comparison<a href=#system-level-comparison class=hash-link aria-label="System-level comparison的直接連結" title="System-level comparison的直接連結">​</a></h3>
<p>與其他模型的比較，最大的模型 MAR-H 才能獲得最好的表現，但 MAR-L 表現也已經不錯</p>
<div align=center><figure style=width:80%><p><img decoding=async loading=lazy alt="System-level comparison" src=/assets/images/img18-5b9dbf15d3b7495d204403fb09706b63.jpg width=1543 height=846 class=img_ev3q></figure></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=結論>結論<a href=#結論 class=hash-link aria-label=結論的直接連結 title=結論的直接連結>​</a></h2>
<p>總的來說，本作打破了自迴歸圖片生成模型的舊有做法，以結合 Diffusion 和 MAE 開闢出新的方向，而且只使用了最簡單的 DDPM 來作展示，若改用更好的擴散模型肯定能獲得更好的結果，期待後續有更多衍生作品</p>
<p>最後放上一部份模型產生出來的圖</p>
<div align=center><figure style=width:60%><p><img decoding=async loading=lazy alt=result src=/assets/images/img19-2dc1297b93dc97d40a264467615c3783.jpg width=942 height=935 class=img_ev3q></figure></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=reference>Reference<a href=#reference class=hash-link aria-label=Reference的直接連結 title=Reference的直接連結>​</a></h2>
<p><a href=https://zhouyifan.net/2024/07/27/20240717-ar-wo-vq/ target=_blank rel="noopener noreferrer">https://zhouyifan.net/2024/07/27/20240717-ar-wo-vq/</a></header></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated>最後<!-- -->由 <b>zephyr-sh</b> <!-- -->於 <b><time datetime=2025-05-23T06:28:50.000Z itemprop=dateModified>2025年5月23日</time></b> <!-- -->更新</span></div></div><section class=ctaSection_iCjC><div class="
        simpleCta_ji_Y
        simple-cta__coffee_YwC8
        fadeInUp_n33J
        hoverTransform_Mozy
      " style=cursor:pointer><h3 class=simple-cta__title_i7hn>☕ 一杯咖啡，就是我創作的燃料！</h3><p class=simple-cta__subtitle_ol86>贊助我持續分享 AI 實作、全端架構與開源經驗，讓好文章不斷更新。<div class=simple-cta__buttonWrapper_jk1Y><img src=/img/bmc-logo.svg alt=cta-button class=simple-cta__buttonImg_Q9VV></div></div><div class="ant-row ant-row-stretch cardsSection_wRaP css-1m2bkf9" style=margin-left:-8px;margin-right:-8px;row-gap:16px><div style=padding-left:8px;padding-right:8px;display:flex class="ant-col ant-col-xs-24 css-1m2bkf9"><div class="ant-card ant-card-bordered card_gKx9 fadeInUp_n33J hoverTransform_Mozy css-1m2bkf9" style=flex:1;display:flex;flex-direction:column><div class=ant-card-body><div style=text-align:center;margin-top:1rem><img src=/img/icons/all_in.svg alt="AI / 全端 / 客製 一次搞定 icon" style=width:48px;height:48px></div><span class="ant-tag ant-tag-orange card__tag_PLj3 css-1m2bkf9">ALL</span><h4 class=card__title_SQBY>AI / 全端 / 客製 一次搞定</h4><p class=card__concept_Ak8F>從構想到上線，涵蓋顧問、開發與部署，全方位支援你的技術實作。<div class=card__bulletHeader_b6cf><h5 class=card__bulletTitle_R_wg>包含內容</h5></div><ul class=card__bulletList_SrNN><li class=card__bulletItem_wCRd>顧問服務 + 系統建置 + 客製開發<li class=card__bulletItem_wCRd>長期維運與擴充規劃</ul></div></div></div></div><div class="
        simpleCta_ji_Y
        simple-cta__outro_AXbn
        fadeInUp_n33J
        hoverTransform_Mozy
      " style=cursor:pointer><h3 class=simple-cta__title_i7hn>🚀 你的專案準備好了嗎？</h3><p class=simple-cta__subtitle_ol86>如果你需要客製服務或長期顧問，歡迎與我聯繫！</div></section><div style=margin-top:3rem> </div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label=文件選項卡><a class="pagination-nav__link pagination-nav__link--prev" href=/papers/category/image-generation-1><div class=pagination-nav__sublabel>上一頁</div><div class=pagination-nav__label>Image Generation (1)</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/papers/category/lightweight-10><div class=pagination-nav__sublabel>下一頁</div><div class=pagination-nav__label>Lightweight (10)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#重鑄生成的秩序 class="table-of-contents__link toc-highlight">重鑄生成的秩序</a><li><a href=#背景知識 class="table-of-contents__link toc-highlight">背景知識</a><ul><li><a href=#vector-quantization-vq class="table-of-contents__link toc-highlight">Vector Quantization (VQ)</a><li><a href=#auto-regressive-image-generation class="table-of-contents__link toc-highlight">Auto-regressive image generation</a></ul><li><a href=#method class="table-of-contents__link toc-highlight">Method</a><ul><li><a href=#放棄-vq擁抱-diffusion class="table-of-contents__link toc-highlight">放棄 VQ，擁抱 Diffusion</a><li><a href=#融入-autoregressive-和-masked-generative-models-的概念 class="table-of-contents__link toc-highlight">融入 Autoregressive 和 Masked Generative Models 的概念</a></ul><li><a href=#implementation class="table-of-contents__link toc-highlight">Implementation</a><li><a href=#experiments class="table-of-contents__link toc-highlight">Experiments</a><ul><li><a href=#diffusion-loss-vs-cross-entropy-loss class="table-of-contents__link toc-highlight">Diffusion Loss vs. Cross-entropy Loss</a><li><a href=#tokenizers class="table-of-contents__link toc-highlight">Tokenizers</a><li><a href=#denosing-mlp class="table-of-contents__link toc-highlight">Denosing MLP</a><li><a href=#sampling-steps-of-diffusion-loss class="table-of-contents__link toc-highlight">Sampling steps of Diffusion Loss</a><li><a href=#temperature-of-diffusion-loss class="table-of-contents__link toc-highlight">Temperature of Diffusion Loss</a><li><a href=#speedaccuracy-trade-off class="table-of-contents__link toc-highlight">Speed/accuracy trade-off</a><li><a href=#system-level-comparison class="table-of-contents__link toc-highlight">System-level comparison</a></ul><li><a href=#結論 class="table-of-contents__link toc-highlight">結論</a><li><a href=#reference class="table-of-contents__link toc-highlight">Reference</a></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class=footer__links><a class=footer__link-item href=/docs>開源專案</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/papers/intro>論文筆記</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/blog>部落格</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/terms-of-service>使用條款</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/privacy-policy>隱私政策</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/become-an-author>成為作者</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/worklog>工作日誌</a></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2025 DOCSAID.</div></div></div></footer></div>