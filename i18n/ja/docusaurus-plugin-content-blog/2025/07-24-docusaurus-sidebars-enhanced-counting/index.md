---
slug: docusaurus-sidebars-enhanced-counting
title: Docusaurus Sidebar ã®ã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½ã®é«˜åº¦ãªå®Ÿè£…ï¼šå†å¸°çš„é›†è¨ˆã¨å®‰å®šã—ãŸ slug
authors: Z. Yuan
image: /ja/img/2025/0724.jpg
tags: [Docusaurus, Sidebar, Enhancement]
description: ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã®å†å¸°é›†è¨ˆã¨ slug ã®å®‰å®šæ€§ã®æœ€é©åŒ–ã€‚
---

ã‹ãªã‚Šå‰ã«ã€Docusaurus ã® Sidebar ãŒè¨˜äº‹æ•°ã‚’è‡ªå‹•è¨ˆç®—ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ãŸè¨˜äº‹ã‚’æ›¸ãã¾ã—ãŸã€‚

- å‰å›ã®è¨˜äº‹ï¼š[**Docusaurus ã® Sidebar ã§è¨˜äº‹æ•°ã‚’è‡ªå‹•è¨ˆç®—ã™ã‚‹æ–¹æ³•**](/ja/blog/customized-docusaurus-sidebars-auto-count)

æ•°ãƒ¶æœˆå®Ÿéš›ã«ä½¿ã£ã¦ã¿ã¦ã€ã¾ã æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚‹ã“ã¨ã«æ°—ã¥ã„ãŸãŸã‚ã€ä»Šå›ã¯ **3 ã¤ã®æ”¹è‰¯** ã‚’è¡Œã„ã€ä¸€åº¦ã«å•é¡Œç‚¹ã‚’è§£æ±ºã—ä½“é¨“ã‚’å¼·åŒ–ã—ã¾ã—ãŸã€‚

<!-- truncate -->

## æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å•é¡Œç‚¹

1. **ã‚«ã‚¦ãƒ³ãƒˆãŒæ­£ç¢ºã§ãªã„**ï¼šç›´æ¥ã®å­éšå±¤ã® Markdown ã®ã¿ã‚’é›†è¨ˆã—ã€ã•ã‚‰ã«æ·±ã„éšå±¤ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç„¡è¦–ã—ã¦ã„ã‚‹ã€‚

   ä¾‹ï¼šãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ãŒä»¥ä¸‹ã®ã‚ˆã†ãªå ´åˆ

   ```bash
   papers/
   â”œâ”€â”€ classic-cnns/
   â”‚   â”œâ”€â”€ alexnet.md
   â”‚   â”œâ”€â”€ vgg/
   â”‚   â”‚   â”œâ”€â”€ vgg16.md
   â”‚   â”‚   â””â”€â”€ vgg19.md
   â”‚   â””â”€â”€ resnet/
   â”‚       â””â”€â”€ resnet50.md
   ```

   æ—§ç‰ˆã§ã¯ `Classic CNNs (1)` ã¨ã—ã‹è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ãŒã€æœŸå¾…ã™ã‚‹çµæœã¯ `Classic CNNs (4)` ã§ã™ã€‚

2. **slug ãŒå®‰å®šã—ãªã„**ï¼šCategory ã®ãƒªãƒ³ã‚¯ã¯ Docusaurus ã®è‡ªå‹•ç”Ÿæˆæ©Ÿæ§‹ã«ä¾å­˜ã—ã¦ãŠã‚Šã€æ™‚ã€…ãƒ‘ã‚¹ãŒå¤‰å‹•ã™ã‚‹ã€‚

   Docusaurus ã¯æŒ‡å®šã—ãŸã‚«ãƒ†ã‚´ãƒªåã«åŸºã¥ã„ã¦ slug ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ãŸã‚ã€ã‚«ãƒ†ã‚´ãƒªåã‚’å¤‰æ›´ã—ãŸã‚Šæ–°è¦è¿½åŠ ã™ã‚‹ã¨ slug ã‚‚å¤‰ã‚ã‚Šã€å…ƒã®ãƒªãƒ³ã‚¯ãŒç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚

   æ—§ç‰ˆã§ã¯ãƒªãƒ³ã‚¯ã¯ä¾‹ãˆã° `papers/category/classic-cnns-11` ã®ã‚ˆã†ã«ç”Ÿæˆã•ã‚Œã¾ã™ã€‚

   æ–°ã—ã„è¨˜äº‹ã‚’è¿½åŠ ã™ã‚‹ã¨ã€ãã®ãƒªãƒ³ã‚¯ãŒ `papers/category/classic-cnns-12` ã«å¤‰ã‚ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã“ã†ã—ãŸå¤‰å‹•ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ··ä¹±ã‚’ã‚‚ãŸã‚‰ã—ã€æ—¢ã«å…±æœ‰ã•ã‚Œã¦ã„ã‚‹ãƒªãƒ³ã‚¯ãŒç„¡åŠ¹ã«ãªã‚‹æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚

   ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä¸å¿«æ„Ÿã ã‘ã§ãªãã€Google ã®ã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ãŒã“ã‚Œã‚‰ã®ãƒªãƒ³ã‚¯ã‚’é »ç¹ã«å¤‰ã‚ã‚‹ã‚‚ã®ã¨ã—ã¦ä¿¡é ¼åº¦ã‚’ä¸‹ã’ã€SEO ã®é †ä½ã«ã‚‚æ‚ªå½±éŸ¿ãŒå‡ºã¾ã™ã€‚

## 3 ã¤ã®æ”¹è‰¯ç‚¹

### 1. å…¨ã¦ã®ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã‚’å†å¸°çš„ã«ã‚«ã‚¦ãƒ³ãƒˆ

æ—§ Sidebar ã¯ç¾åœ¨ã®ãƒ•ã‚©ãƒ«ãƒ€å†…ã® .md ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚’é›†è¨ˆã—ã¦ã„ã¾ã—ãŸãŒã€æœ¬ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯æ·±ã„å†å¸°æ¤œç´¢ã‚’è¡Œã„ã€å…¨ã¦ã®ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€å†…ã® Markdown æ•°ã‚’æ­£ç¢ºã«ã‚«ã‚¦ãƒ³ãƒˆã—ã€ã‚«ãƒ†ã‚´ãƒªãƒ©ãƒ™ãƒ«ã®æ•°å­—ãŒæ­£ç¢ºã«ãªã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

```js
/**
 * æŒ‡å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã®å…¨ã¦ã® Markdown (.md) ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†å¸°çš„ã«ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ã€‚
 * éš ã—ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆå…ˆé ­ãŒ '.'ï¼‰ã‚„ '_category_.json' ã¯ç„¡è¦–ã™ã‚‹ã€‚
 *
 * @param {string} dirPath - å¯¾è±¡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®çµ¶å¯¾ãƒ‘ã‚¹ã€‚
 * @returns {number} è¦‹ã¤ã‹ã£ãŸ Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆè¨ˆæ•°ã€‚
 */
function countMarkdownFiles(dirPath) {
  let count = 0;

  // ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®å…¨é …ç›®ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ã‚’å–å¾—
  for (const name of fs.readdirSync(dirPath)) {
    // éš ã—ãƒ•ã‚¡ã‚¤ãƒ«ã¨ _category_.json è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’é™¤å¤–
    if (name.startsWith(".") || name === "_category_.json") continue;

    const fullPath = path.join(dirPath, name); // ãƒ•ãƒ«ãƒ‘ã‚¹ã‚’å–å¾—
    const stat = fs.statSync(fullPath); // ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®çŠ¶æ…‹ã‚’å–å¾—

    if (stat.isDirectory()) {
      // ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãªã‚‰å†å¸°çš„ã«ä¸­ã® Markdown æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
      count += countMarkdownFiles(fullPath);
    } else if (stat.isFile() && name.endsWith(".md")) {
      // Markdown ãƒ•ã‚¡ã‚¤ãƒ«ãªã‚‰ã‚«ã‚¦ãƒ³ãƒˆã‚’å¢—ã‚„ã™
      count += 1;
    }
  }

  return count;
}
```

### 2. å®‰å®šã—ãŸ slug ç”Ÿæˆ

Docusaurus ã§ã¯å„ category ã®ãƒªãƒ³ã‚¯ãŒè‡ªå‹•çš„ã« URL slug ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚

ã—ã‹ã—ã€ç©ºç™½ã‚„æ—¥æœ¬èªã€ç‰¹æ®Šæ–‡å­—ã‚’å«ã‚€ãƒ‘ã‚¹ã ã¨ãƒ“ãƒ«ãƒ‰ã®ãŸã³ã« URL ãŒå¤‰ã‚ã‚‹ã“ã¨ãŒã‚ã‚Šã€ã€Œäºˆæ¸¬ä¸å¯èƒ½ã€ãªå¤‰å‹•ã‚’å¼•ãèµ·ã“ã—ã¾ã™ã€‚

é€£çµã®**å®‰å®šæ€§ã¨åˆ¶å¾¡æ€§**ã‚’ç¢ºä¿ã™ã‚‹ãŸã‚ã€ãƒ‘ã‚¹ã‚’å®‰å®šãƒ»äºˆæ¸¬å¯èƒ½ãª slug ã«å¤‰æ›ã™ã‚‹ `toSlug` é–¢æ•°ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

```js
/**
 * ç›¸å¯¾ POSIX ãƒ‘ã‚¹ã‚’ URL å®‰å…¨ãª slug ã«å¤‰æ›ã™ã‚‹ã€‚
 * ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’æ­£è¦åŒ–ã—ã€encodeURIComponent ã‚’é©ç”¨ã—ã¦ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ä¸€è²«ã—ãŸ slug ã‚’ä¿è¨¼ã€‚
 *
 * @param {string} relPath - 'classic-cnns/vgg' ã®ã‚ˆã†ãªç›¸å¯¾ãƒ‘ã‚¹ã€‚
 * @returns {string} 'classic-cnns/vgg' ã®ã‚ˆã†ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸ URL slugã€‚
 */
function toSlug(relPath) {
  return relPath
    .replace(/\\/g, "/") // Windows ã®ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’ POSIX ã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã«ç½®æ›
    .split("/") // å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªéšå±¤ã«åˆ†å‰²
    .map(encodeURIComponent) // å„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ URL ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
    .join("/"); // ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§å†çµåˆã—ã€å®‰å®šã—ãŸ slug ã‚’ä½œæˆ
}
```

`buildCategoryItem()` å†…ã§ã€ã¾ãš `_category_.json` ã®ã‚«ã‚¹ã‚¿ãƒ  slug ã‚’å„ªå…ˆã—ã¦èª­ã¿è¾¼ã¿ã€è¨­å®šãŒãªã‘ã‚Œã°ä¸Šè¨˜ `toSlug()` ã§ç”Ÿæˆã—ãŸãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ä½¿ã†ã‚ˆã†ã«ã—ã¾ã™ã€‚

```js
const defaultSlug = `/category/${toSlug(relativeDirPath)}`;

const link = {
  type: "generated-index",
  slug: metadata.link?.slug || defaultSlug, // ã‚«ã‚¹ã‚¿ãƒ  slug ãŒã‚ã‚Œã°å„ªå…ˆã€ãªã‘ã‚Œã°ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
  title: metadata.link?.title || baseLabel,
  ...metadata.link, // description ãªã©ãã®ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä¿æŒ
};
```

### 3. ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸¦ã³é †ã®æœ€é©åŒ–

Docusaurus ã® Sidebar è‡ªå‹•ç”Ÿæˆã§ã¯ã€é †åºã‚’æŒ‡å®šã—ãªã‘ã‚Œã°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ä¸¦ã³ã¾ã™ã€‚

ã—ã‹ã—ã€å®Ÿå‹™ä¸Šã¯

- **`_category_.json` ã‚’å«ã‚€åˆ†é¡ãƒ•ã‚©ãƒ«ãƒ€ã‚’å„ªå…ˆè¡¨ç¤º**ï¼ˆæ˜ç¢ºã«å®šç¾©ã•ã‚ŒãŸã‚«ãƒ†ã‚´ãƒªã¨ã—ã¦ï¼‰
- **ãã‚Œä»¥å¤–ã®ãƒ•ã‚©ãƒ«ãƒ€ã¯ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã§ä¸¦ã¹ã‚‹**

ã“ã¨ãŒæœ›ã¾ã‚Œã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Š Sidebar ãŒæ•´ç†ã•ã‚Œã€åˆ©ç”¨è€…ãŒè¨­è¨ˆæ¸ˆã¿ã®ãƒ†ãƒ¼ãƒã‚°ãƒ«ãƒ¼ãƒ—ã‚’å„ªå…ˆã—ã¦é–²è¦§ã§ãã¾ã™ã€‚

ä»¥ä¸‹ã¯ãã®ä¸¦ã³æ›¿ãˆã®å®Ÿè£…ä¾‹ã§ã™ã€‚

```js
/**
 * ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä¸¦ã³æ›¿ãˆã‚‹ï¼š
 * - `_category_.json` ã‚’å«ã‚€ãƒ•ã‚©ãƒ«ãƒ€ã‚’å…ˆé ­ã«
 * - ãã®ä»–ã¯ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †
 *
 * @param {string} dir - è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®çµ¶å¯¾ãƒ‘ã‚¹
 * @returns {string[]} ä¸¦ã³æ›¿ãˆã‚‰ã‚ŒãŸã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã®é…åˆ—
 */
function getSortedSubDirs(dir) {
  return fs
    .readdirSync(dir)
    .filter((name) => {
      const fullPath = path.join(dir, name);
      return !name.startsWith(".") && fs.statSync(fullPath).isDirectory();
    })
    .sort((a, b) => {
      const aHasCategory = fs.existsSync(path.join(dir, a, "_category_.json"));
      const bHasCategory = fs.existsSync(path.join(dir, b, "_category_.json"));

      // _category_.json ãŒã‚ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã‚’å…ˆã«
      if (aHasCategory && !bHasCategory) return -1;
      if (bHasCategory && !aHasCategory) return 1;

      // ãã‚Œä»¥å¤–ã¯ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †
      return a.localeCompare(b);
    });
}
```

## ã¾ã¨ã‚

ã“ã‚Œã§ Sidebar ã®ã€Œæ•°å­—ã€ã€Œãƒªãƒ³ã‚¯ã€ã€Œéšå±¤æ§‹é€ ã€ãŒã™ã¹ã¦æ­£ã—ãæ©Ÿèƒ½ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

ã—ã°ã‚‰ãã¯å®‰å®šã—ã¦é‹ç”¨ã§ãã‚‹ã¯ãšã§ã™ã€‚

é ‘å¼µã‚Šã¾ã™ã€‚

## æˆæœãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼

- å®Œå…¨ãªã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ ğŸ‘‰ [**sidebarsPapers.js**](https://github.com/DocsaidLab/website/blob/main/sidebarsPapers.js)
- å®Ÿéš›ã®å‹•ä½œçµæœã¯ã“ã¡ã‚‰ ğŸ‘‰ [**Paper Notes**](https://docsaid.org/ja/papers/intro)
