---
sidebar_position: 8
---

# pairwise_ioa

> [pairwise_ioa(boxes1: Boxes, boxes2: Boxes) -> np.ndarray](https://github.com/DocsaidLab/Capybara/blob/975d62fba4f76db59e715c220f7a2af5ad8d050e/capybara/structures/functionals.py#L70)

- **説明**：

  `pairwise_ioa` は、2 つの境界ボックスリスト間で IoA（交差領域比）を計算する関数です。この関数は、すべての N x M ペアの境界ボックス間で IoA を計算します。入力される境界ボックスは `Boxes` 型である必要があります。

- **パラメータ**

  - **boxes1** (`Boxes`)：最初の境界ボックスリスト。N 個の境界ボックスを含みます。
  - **boxes2** (`Boxes`)：2 番目の境界ボックスリスト。M 個の境界ボックスを含みます。

- **例**

  ```python
  import capybara as cb

  boxes1 = cb.Boxes([[10, 20, 50, 80], [20, 30, 60, 90]])
  boxes2 = cb.Boxes([[20, 30, 60, 90], [30, 40, 70, 100]])
  ioa = cb.pairwise_ioa(boxes1, boxes2)
  print(ioa)
  # >>> [[0.625 0.33333334]
  #      [1.0 0.625]]
  ```

## 補足説明

### IoA について

IoA（Intersection over Area）は、境界ボックス間の重なり具合を評価する指標で、予測された境界ボックスと実際の境界ボックスとの交差面積と実際の境界ボックスの面積との比率を計算します。

### 定義

IoA の計算式は、予測された境界ボックスと実際の境界ボックスの交差面積を実際の境界ボックスの面積で割ったものです。IoA の値は 0 から 1 の範囲で、値が大きいほど予測された境界ボックスが実際の境界ボックスを多くカバーしていることを示します。

### 計算手順

1. **境界ボックス座標の特定**：まず、予測された境界ボックスと実際の境界ボックスの位置を画像内で特定する必要があります。通常、4 つの座標（x0, y0, x1, y1）を使用して境界ボックスを表現します。ここで、(x0, y0)は左上隅の座標、(x1, y1)は右下隅の座標です。

2. **交差面積の計算**：予測された境界ボックスと実際の境界ボックスの交差面積を計算します。

3. **IoA の計算**：交差面積を実際の境界ボックスの面積で割り、IoA 値を得ます。

### 使用例

- **物体検出**：物体検出タスクでは、IoA を用いて予測された境界ボックスと実際の境界ボックスとの重なり具合を評価し、検出モデルの精度を測ります。

- **モデル評価**：IoA は、異なる物体検出モデルのパフォーマンスを評価する際に使用され、高い IoA 値はモデルが優れた検出精度を持っていることを示します。

- **非極大値抑制（NMS）**：物体検出後の後処理では、IoA を使って非極大値抑制（NMS）を行い、重複する検出ボックスを削除し、最適な検出結果を保持します。

### 長所と短所

- **長所**：IoA は予測された境界ボックスと実際の境界ボックス間の重なり具合を定量化し、モデルの精度を評価するのに役立ちます。

- **短所**：IoA は予測された境界ボックスと実際の境界ボックス間の重なり具合のみを考慮しており、他の要素（例えば、境界ボックスの形状や向き）を考慮していないため、場合によっては不正確な評価となることがあります。
