"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[52],{56349:(s,e,a)=>{a.r(e),a.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>o,frontMatter:()=>t,metadata:()=>r,toc:()=>m});var n=a(74848),i=a(28453);const t={slug:"torch-layernorm-mismatch",title:"Discrepancy in LayerNorm Calculations?",authors:"Zephyr",image:"/en/img/2024/0820.webp",tags:["PyTorch","LayerNorm"],description:"Curious about the numbers? Let's calculate and compare."},l=void 0,r={permalink:"/en/blog/torch-layernorm-mismatch",source:"@site/i18n/en/docusaurus-plugin-content-blog/2024/08-20-torch-layernorm-mismatch/index.md",title:"Discrepancy in LayerNorm Calculations?",description:"Curious about the numbers? Let's calculate and compare.",date:"2024-08-20T00:00:00.000Z",tags:[{inline:!0,label:"PyTorch",permalink:"/en/blog/tags/py-torch"},{inline:!0,label:"LayerNorm",permalink:"/en/blog/tags/layer-norm"}],readingTime:3.325,hasTruncateMarker:!0,authors:[{name:"Zephyr",title:"Engineer",url:"https://github.com/zephyr-sh",imageURL:"https://github.com/zephyr-sh.png",key:"Zephyr",page:null}],frontMatter:{slug:"torch-layernorm-mismatch",title:"Discrepancy in LayerNorm Calculations?",authors:"Zephyr",image:"/en/img/2024/0820.webp",tags:["PyTorch","LayerNorm"],description:"Curious about the numbers? Let's calculate and compare."},unlisted:!1,prevItem:{title:"Customizing the Docusaurus 404 Page",permalink:"/en/blog/customized-docusaurus-404-page"},nextItem:{title:"NIST & FRVT",permalink:"/en/blog/nist-and-frvt"}},c={authorsImageUrls:[void 0]},m=[{value:"Unbiased Estimation",id:"unbiased-estimation",level:2},{value:"Why Doesn&#39;t LayerNorm Use Unbiased Estimation?",id:"why-doesnt-layernorm-use-unbiased-estimation",level:2},{value:"Conclusion",id:"conclusion",level:2}];function h(s){const e={admonition:"admonition",annotation:"annotation",code:"code",h2:"h2",hr:"hr",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mo:"mo",mrow:"mrow",msqrt:"msqrt",mtext:"mtext",p:"p",path:"path",pre:"pre",semantics:"semantics",span:"span",strong:"strong",svg:"svg",ul:"ul",...(0,i.R)(),...s.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("figure",{children:(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.img,{alt:"title",src:a(82149).A+"",width:"1024",height:"1024"}),"\n",(0,n.jsx)("figcaption",{children:"Cover image: Automatically generated by GPT-4 after reading this article."})]})}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.p,{children:"Today, I decided to manually calculate the values of LayerNorm."}),"\n",(0,n.jsx)(e.p,{children:"We all know that the formula for LayerNorm is as follows:"}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"LayerNorm"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"x"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"x"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mi,{children:"\u03bc"})]}),(0,n.jsx)(e.msqrt,{children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"Var["}),(0,n.jsx)(e.mi,{children:"x"}),(0,n.jsx)(e.mtext,{children:"]"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"\u03f5"})]})})]}),(0,n.jsx)(e.mo,{children:"\xd7"}),(0,n.jsx)(e.mi,{children:"\u03b3"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"\u03b2"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{LayerNorm}(x) = \\frac{x - \\mu}{\\sqrt{\\text{Var[}x\\text{]} + \\epsilon}} \\times \\gamma + \\beta"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"LayerNorm"})}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.3903em",verticalAlign:"-1.13em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.2603em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.175em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord sqrt",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.935em"},children:[(0,n.jsxs)(e.span,{className:"svg-align",style:{top:"-3.2em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.2em"}}),(0,n.jsxs)(e.span,{className:"mord",style:{paddingLeft:"1em"},children:[(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Var["})}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"]"})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"\u03f5"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-2.895em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.2em"}}),(0,n.jsx)(e.span,{className:"hide-tail",style:{minWidth:"1.02em",height:"1.28em"},children:(0,n.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.28em",viewBox:"0 0 400000 1296",preserveAspectRatio:"xMinYMin slice",children:(0,n.jsx)(e.path,{d:"M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.305em"},children:(0,n.jsx)(e.span,{})})})]})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"\u03bc"})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"1.13em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.7778em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05556em"},children:"\u03b3"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05278em"},children:"\u03b2"})]})]})]})}),"\n",(0,n.jsxs)(e.p,{children:["Where ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"\u03bc"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\mu"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"\u03bc"})]})})]})," is the mean of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"x"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"x"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"})]})})]}),", and ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mtext,{children:"Var"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{Var}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Var"})})]})})]})," is the variance of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"x"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"x"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"})]})})]}),"."]}),"\n",(0,n.jsxs)(e.p,{children:["With this information, let's calculate it ourselves, ignoring ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"\u03b3"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\gamma"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05556em"},children:"\u03b3"})]})})]})," and ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"\u03b2"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\beta"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05278em"},children:"\u03b2"})]})})]})," for simplicity:"]}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"import torch\n\nx = torch.rand(16, 768)\nmu = x.mean(dim=-1, keepdim=True)\nvar = x.var(dim=-1, keepdim=True)\neps = 1e-5\ny = (x - mu) / (var + eps).sqrt()\n"})}),"\n",(0,n.jsx)(e.p,{children:"This yields the following values:"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"# tensor([[ 0.1219, -0.0222, -1.4742,  ...,  0.1738, -0.6124, -0.3001],\n#         [-1.6009, -1.5814,  1.5357,  ...,  0.1917,  1.3787, -0.2772],\n#         [ 0.3738,  1.0520,  0.4403,  ...,  1.1353, -0.7488, -0.9137],\n#         ...,\n#         [ 0.8823, -1.5427,  0.4725,  ..., -1.2544, -1.5354, -0.4305],\n#         [ 1.4548,  0.3059, -0.6732,  ..., -0.7109,  0.4908, -1.2447],\n#         [-0.4067,  0.5974, -0.9113,  ..., -0.2511, -0.2279, -0.9675]])\n"})}),"\n",(0,n.jsxs)(e.p,{children:["Next, let's compare these results with PyTorch's ",(0,n.jsx)(e.code,{children:"torch.nn.LayerNorm"}),":"]}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"layer_norm = torch.nn.LayerNorm(768, elementwise_affine=False, bias=False)\n\ny_ln = layer_norm(x)\n"})}),"\n",(0,n.jsx)(e.p,{children:"This yields:"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"# tensor([[ 0.1220, -0.0222, -1.4752,  ...,  0.1739, -0.6128, -0.3003],\n#         [-1.6020, -1.5824,  1.5367,  ...,  0.1918,  1.3796, -0.2774],\n#         [ 0.3741,  1.0527,  0.4406,  ...,  1.1360, -0.7493, -0.9143],\n#         ...,\n#         [ 0.8829, -1.5437,  0.4728,  ..., -1.2552, -1.5364, -0.4308],\n#         [ 1.4557,  0.3061, -0.6736,  ..., -0.7113,  0.4911, -1.2455],\n#         [-0.4069,  0.5978, -0.9119,  ..., -0.2513, -0.2281, -0.9681]])\n"})}),"\n",(0,n.jsx)(e.p,{children:"When we compare the two, why are they different?"}),"\n",(0,n.jsx)(e.h2,{id:"unbiased-estimation",children:"Unbiased Estimation"}),"\n",(0,n.jsxs)(e.p,{children:["After a quick search, I found that ",(0,n.jsx)(e.code,{children:"torch.var"})," has a parameter called ",(0,n.jsx)(e.code,{children:"correction"}),", which defaults to ",(0,n.jsx)(e.code,{children:"1"}),", meaning it uses an unbiased estimate."]}),"\n",(0,n.jsxs)(e.p,{children:["This means that it divides by ",(0,n.jsx)(e.code,{children:"N-1"})," instead of ",(0,n.jsx)(e.code,{children:"N"}),", whereas ",(0,n.jsx)(e.code,{children:"torch.nn.LayerNorm"})," uses ",(0,n.jsx)(e.code,{children:"N"}),"."]}),"\n",(0,n.jsxs)(e.p,{children:["So let's modify the ",(0,n.jsx)(e.code,{children:"torch.var"})," function by setting ",(0,n.jsx)(e.code,{children:"correction=0"}),":"]}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"var = x.var(dim=-1, correction=0, keepdim=True)\n"})}),"\n",(0,n.jsxs)(e.admonition,{type:"tip",children:[(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:"correction"})," is an alias for ",(0,n.jsx)(e.code,{children:"unbiased"}),", introduced in PyTorch 2.0.0."]}),(0,n.jsxs)(e.p,{children:["In earlier versions, you would set it using ",(0,n.jsx)(e.code,{children:"unbiased=False"}),":"]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"var = x.var(dim=-1, unbiased=False, keepdim=True)\n"})})]}),"\n",(0,n.jsx)(e.p,{children:"Now, let's compare the results again:"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-python",children:"# tensor([[ 0.1220, -0.0222, -1.4752,  ...,  0.1739, -0.6128, -0.3003],\n#         [-1.6020, -1.5824,  1.5367,  ...,  0.1918,  1.3796, -0.2774],\n#         [ 0.3741,  1.0527,  0.4406,  ...,  1.1360, -0.7493, -0.9143],\n#         ...,\n#         [ 0.8829, -1.5437,  0.4728,  ..., -1.2552, -1.5364, -0.4308],\n#         [ 1.4557,  0.3061, -0.6736,  ..., -0.7113,  0.4911, -1.2455],\n#         [-0.4069,  0.5978, -0.9119,  ..., -0.2513, -0.2281, -0.9681]])\n"})}),"\n",(0,n.jsx)(e.p,{children:"Now the numbers match perfectly!"}),"\n",(0,n.jsx)(e.h2,{id:"why-doesnt-layernorm-use-unbiased-estimation",children:"Why Doesn't LayerNorm Use Unbiased Estimation?"}),"\n",(0,n.jsx)(e.p,{children:"To summarize briefly, it's about stability and simplification of calculations."}),"\n",(0,n.jsx)(e.p,{children:"If you're interested in a deeper dive, here are some key points:"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Stability in Small Batch Calculations"})}),"\n",(0,n.jsx)(e.p,{children:"LayerNorm is typically applied to the features of individual samples (e.g., each neuron or feature) rather than across the entire batch. The number of features per sample is usually much larger than the number of samples. Thus, using population variance provides a more stable and accurate estimate, especially with small sample sizes."}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Reduced Importance of Unbiased Estimation"})}),"\n",(0,n.jsx)(e.p,{children:"The unbiased nature of sample variance (i.e., dividing by n-1 instead of n) is crucial when estimating population parameters from a sample. However, in deep learning regularization and normalization, like in LayerNorm, the impact of this bias is relatively minor. This is because these computations are used to normalize activations rather than to estimate overall statistics. Using population variance simplifies calculations with minimal effect on training outcomes."}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Stability in Gradient Calculations"})}),"\n",(0,n.jsx)(e.p,{children:"Stable gradients are vital during backpropagation. Using population variance leads to smoother and more stable gradient calculations, avoiding additional noise that might arise from small sample sizes. This contributes to better convergence and training performance."}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"Simplified Calculations"})}),"\n",(0,n.jsx)(e.p,{children:"From a computational perspective, calculating population variance is slightly simpler than sample variance because it omits a subtraction operation (i.e., dividing by n rather than n-1). While this isn't a decisive factor, it's a consideration in the design process."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(e.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,n.jsx)(e.p,{children:"This article was inspired by a sudden curiosity."}),"\n",(0,n.jsx)(e.p,{children:"I hope this explanation helps clarify the issue for you."})]})}function o(s={}){const{wrapper:e}={...(0,i.R)(),...s.components};return e?(0,n.jsx)(e,{...s,children:(0,n.jsx)(h,{...s})}):h(s)}},82149:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/0820-2ca402e1bb7cc334ff4f85412631f039.webp"},28453:(s,e,a)=>{a.d(e,{R:()=>l,x:()=>r});var n=a(96540);const i={},t=n.createContext(i);function l(s){const e=n.useContext(t);return n.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:l(s.components),n.createElement(t.Provider,{value:e},s.children)}}}]);