"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["73525"],{36564:function(e,n,t){t.r(n),t.d(n,{default:()=>d,frontMatter:()=>r,metadata:()=>s,assets:()=>l,toc:()=>c,contentTitle:()=>o});var s=JSON.parse('{"id":"feature-fusion/trans-unet/index","title":"[21.02] TransUNet","description":"Convolutions Are Not Enough","source":"@site/i18n/en/docusaurus-plugin-content-docs-papers/current/feature-fusion/2102-trans-unet/index.md","sourceDirName":"feature-fusion/2102-trans-unet","slug":"/feature-fusion/trans-unet/","permalink":"/en/papers/feature-fusion/trans-unet/","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"zephyr-sh","lastUpdatedAt":1739239448000,"frontMatter":{"title":"[21.02] TransUNet","authors":"Z. Yuan"},"sidebar":"papersSidebar","previous":{"title":"[20.06] DetectoRS","permalink":"/en/papers/feature-fusion/detectors/"},"next":{"title":"Lightweight (10)","permalink":"/en/papers/category/lightweight-10"}}'),i=t("85893"),a=t("50065");let r={title:"[21.02] TransUNet",authors:"Z. Yuan"},o=void 0,l={},c=[{value:"Convolutions Are Not Enough",id:"convolutions-are-not-enough",level:2},{value:"Defining the Problem",id:"defining-the-problem",level:2},{value:"Solving the Problem",id:"solving-the-problem",level:2},{value:"Discussion",id:"discussion",level:2},{value:"Conclusion",id:"conclusion",level:2}];function h(e){let n={a:"a",admonition:"admonition",annotation:"annotation",h2:"h2",hr:"hr",img:"img",li:"li",math:"math",mn:"mn",mo:"mo",mrow:"mrow",p:"p",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"convolutions-are-not-enough",children:"Convolutions Are Not Enough"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://arxiv.org/abs/2102.04306",children:(0,i.jsx)(n.strong,{children:"TransUNet: Transformers Make Strong Encoders for Medical Image Segmentation"})})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"ViT was proposed at the end of 2020, and its applications quickly expanded across many fields."}),"\n",(0,i.jsx)(n.p,{children:"Here, we examine a paper that combines U-Net and ViT. The paper itself isn't difficult; as long as you're familiar with the concepts of U-Net and ViT, you'll be able to grasp it easily."}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsx)(n.p,{children:"For those who need a refresher, you can refer to our previous articles:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/en/papers/feature-fusion/unet/",children:(0,i.jsx)(n.strong,{children:"[15.05] U-Net: The Dawn of Integration"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/en/papers/vision-transformers/vit/",children:(0,i.jsx)(n.strong,{children:"[20.10] ViT: Pioneering a New World"})})}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"defining-the-problem",children:"Defining the Problem"}),"\n",(0,i.jsx)(n.p,{children:"Introducing attention mechanisms into CNNs isn't a new concept, but applying it to medical image segmentation remains rare."}),"\n",(0,i.jsx)(n.p,{children:"No one has done it? Well, that's the biggest problem!"}),"\n",(0,i.jsx)(n.p,{children:'The authors wanted to use a "sequence-to-sequence" approach, much like ViT, by splitting images into many patches and feeding them directly into a Transformer, learning the global features of the image in the process.'}),"\n",(0,i.jsx)(n.p,{children:"However, if we simply use upsampling to resize the low-level features produced by the Transformer to the original size (e.g., using Upsample), we would only get coarse segmentation results. While Transformer excels at processing global information, it doesn't inherently enhance local boundaries and details."}),"\n",(0,i.jsx)(n.p,{children:"In ViT, the patch size is usually set at 16\xd716, which is sufficient for image classification. But for segmentation tasks, we need precision down to the pixel level, which means reducing the patch size to 8\xd78 or even 4\xd74. However, the smaller the patch size, the higher the computational cost, which would result in Transformer calculations exploding and making training impossible."}),"\n",(0,i.jsx)(n.p,{children:'So, we need to first address the issues of "multi-scale downsampling" and "resolution."'}),"\n",(0,i.jsx)(n.h2,{id:"solving-the-problem",children:"Solving the Problem"}),"\n",(0,i.jsx)(n.p,{children:"Clearly, directly applying ViT to image segmentation tasks is not feasible, so the authors propose a hybrid architecture, as shown in the diagram below:"}),"\n",(0,i.jsx)("div",{align:"center",children:(0,i.jsx)("figure",{style:{width:"90%"},children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"architecture",src:t(19291).Z+"",width:"1366",height:"678"})})})}),"\n",(0,i.jsx)(n.p,{children:"First, CNN is used for feature extraction, like a typical Backbone, which generates feature maps at 1/2, 1/4, 1/8, and 1/16 resolutions."}),"\n",(0,i.jsxs)(n.p,{children:["Given the computational complexity of Transformer, only the 1/16 resolution feature maps are used, paired with a ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mn,{children:"1"}),(0,i.jsx)(n.mo,{children:"\xd7"}),(0,i.jsx)(n.mn,{children:"1"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"1 \\times 1"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(n.span,{className:"mord",children:"1"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(n.span,{className:"mord",children:"1"})]})]})]})," patch size, converting the image into a sequence, which is then passed through a Transformer for global feature extraction."]}),"\n",(0,i.jsx)(n.p,{children:"After the Transformer performs self-attention operations, it produces a more \"global\" feature representation, which is then transformed back into a 1/16 resolution feature map. The CNN's progressive upsampling (like U-Net's decoder) is used to fuse feature maps at other resolutions. In this way, we retain the advantages of global information while using skip connections to supplement local details, resulting in finer segmentation."}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"We omit the detailed implementation of ViT and U-Net here, as we have covered them before."})}),"\n",(0,i.jsx)(n.h2,{id:"discussion",children:"Discussion"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"results",src:t(87528).Z+"",width:"1624",height:"442"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The table above shows the use of Cascaded Upsampler (CUP) to compare the performance of direct upsampling."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["On the ",(0,i.jsx)(n.strong,{children:"Synapse Multi-organ Segmentation Dataset"}),", the authors compared TransUNet with four previous SOTA methods: V-Net, DARR, U-Net, and AttnUNet."]}),"\n",(0,i.jsxs)(n.p,{children:["Additionally, to validate the effectiveness of ",(0,i.jsx)(n.strong,{children:"CUP"})," and ",(0,i.jsx)(n.strong,{children:"Hybrid Encoder"}),", the experiments compared the following variants:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ViT-None"}),": ViT as the encoder, using simple upsampling for decoding"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ViT-CUP"}),": ViT as the encoder, paired with CUP decoder"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"R50-ViT-CUP"}),": ResNet-50 + ViT as the encoder, paired with CUP decoder"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"TransUNet"}),": R50-ViT-CUP + U-Net style skip connections"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["To ensure a fair comparison, the encoders of U-Net and AttnUNet were also replaced with ",(0,i.jsx)(n.strong,{children:"ImageNet-pretrained ResNet-50"}),", aligning them with the ViT-Hybrid version."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Direct Upsampling vs. CUP"}),": Comparing ",(0,i.jsx)(n.strong,{children:"ViT-None vs. ViT-CUP"}),", the Dice Similarity Coefficient (DSC) improved by 6.36%, and the Hausdorff distance decreased by 3.50 mm. This demonstrates that the CUP decoder is better than simple upsampling for medical image segmentation, as it restores boundary details more precisely."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ViT vs. R50-ViT"}),": Comparing ",(0,i.jsx)(n.strong,{children:"ViT-CUP vs. R50-ViT-CUP"}),", DSC improved by an additional 3.43%, and Hausdorff distance decreased further by 3.24 mm. The conclusion is that while pure ViT captures high-level semantics, it struggles to preserve the boundaries and details of medical images. The hybrid CNN + ViT encoder effectively compensates for the loss of low-level features."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Finally, comparing TransUNet to other methods, DSC increased by 1.91% to 8.67%. Compared to the best CNN method, R50-AttnUNet, TransUNet showed an additional improvement of 1.91%. Compared to R50-ViT-CUP, TransUNet improved by 6.19%."}),"\n",(0,i.jsx)(n.p,{children:"The authors explain that pure CNNs, while good at capturing rich local details, lack a global perspective. Pure ViT, while effective at capturing global semantics, struggles to retain boundaries and details. TransUNet, by combining global and local information through skip connections, successfully surpasses all SOTA methods, becoming the new benchmark for medical image segmentation."}),"\n",(0,i.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,i.jsx)(n.p,{children:"TransUNet leverages the powerful global self-attention mechanism of Transformers combined with the low-level detail representation of CNNs, overcoming the limitations of traditional FCN architectures and demonstrating exceptional performance in medical image segmentation."}),"\n",(0,i.jsx)(n.p,{children:"Through its U-shaped hybrid architecture, TransUNet outperforms existing CNN-based self-attention methods, providing a novel solution for medical image segmentation and proving the potential and practicality of Transformers in this field."})]})}function d(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},19291:function(e,n,t){t.d(n,{Z:function(){return s}});let s=t.p+"assets/images/img1-d33a8ec2aee48eb2ae546e99c4d735b9.jpg"},87528:function(e,n,t){t.d(n,{Z:function(){return s}});let s=t.p+"assets/images/img2-4567a854c0c8756f4558f13db51f25e4.jpg"},50065:function(e,n,t){t.d(n,{Z:function(){return o},a:function(){return r}});var s=t(67294);let i={},a=s.createContext(i);function r(e){let n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);