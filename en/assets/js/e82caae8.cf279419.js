"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["79469"],{69656:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>a,toc:()=>l,default:()=>u,metadata:()=>t,assets:()=>c,contentTitle:()=>o});var t=JSON.parse('{"id":"nginx-notes/static-file-server","title":"Nginx Serving Static Resources","description":"This chapter uses a static website built with Docusaurus as an example to explain how to serve a website using Nginx.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/nginx-notes/static-file-server.md","sourceDirName":"nginx-notes","slug":"/nginx-notes/static-file-server","permalink":"/en/docs/nginx-notes/static-file-server","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"zephyr-sh","lastUpdatedAt":1740705000000,"sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Nginx Monitoring","permalink":"/en/docs/nginx-notes/monitoring"},"next":{"title":"\u88DC\u5145\u8CC7\u6599","permalink":"/en/docs/category/\u88DC\u5145\u8CC7\u6599"}}'),s=i(74848),r=i(84429);let a={sidebar_position:6},o="Nginx Serving Static Resources",c={},l=[{value:"Build the Static Website",id:"build-the-static-website",level:2},{value:"Obtain SSL Certificate",id:"obtain-ssl-certificate",level:2},{value:"Configure Nginx",id:"configure-nginx",level:2},{value:"Advanced Configuration",id:"advanced-configuration",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(e){let n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"nginx-serving-static-resources",children:"Nginx Serving Static Resources"})}),"\n",(0,s.jsx)(n.p,{children:"This chapter uses a static website built with Docusaurus as an example to explain how to serve a website using Nginx."}),"\n",(0,s.jsx)(n.p,{children:"Assume you have already prepared a domain name and pointed it to your server, for example:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"your.domain"})}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["Make sure to replace ",(0,s.jsx)(n.code,{children:"your.domain"})," in all the commands and configuration examples below with the actual domain name you're using."]})}),"\n",(0,s.jsx)(n.h2,{id:"build-the-static-website",children:"Build the Static Website"}),"\n",(0,s.jsxs)(n.p,{children:["Before building, make sure the ",(0,s.jsx)(n.code,{children:"url"})," in your ",(0,s.jsx)(n.code,{children:"docusaurus.config.js"})," file is correctly set to your domain:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'module.exports = {\n  url: "https://your.domain",\n  // ...other configurations\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:"Once verified, run the following command to generate the static files:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"DOCUSAURUS_IGNORE_SSG_WARNINGS=true yarn build\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["If you do not use the ",(0,s.jsx)(n.code,{children:"DOCUSAURUS_IGNORE_SSG_WARNINGS"})," environment variable, you might see many strange warning messages, but they won't affect the build result."]})}),"\n",(0,s.jsxs)(n.p,{children:["This command will generate static HTML, CSS, and JS files in the ",(0,s.jsx)(n.code,{children:"build/"})," folder."]}),"\n",(0,s.jsx)(n.p,{children:"Next, upload the built files to the specified directory on your server and set the file permissions:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo mkdir -p /var/www/your.domain\nsudo rsync -av build/ /var/www/your.domain/\nsudo chown -R www-data:www-data /var/www/your.domain\n"})}),"\n",(0,s.jsx)(n.h2,{id:"obtain-ssl-certificate",children:"Obtain SSL Certificate"}),"\n",(0,s.jsx)(n.p,{children:"It is recommended to use Let's Encrypt to issue an SSL certificate to ensure the website is served securely via HTTPS:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo apt install certbot python3-certbot-nginx -y\nsudo certbot --nginx -d your.domain\n"})}),"\n",(0,s.jsx)(n.h2,{id:"configure-nginx",children:"Configure Nginx"}),"\n",(0,s.jsx)(n.p,{children:"Create a dedicated Nginx configuration file:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo vim /etc/nginx/sites-available/your.domain\n"})}),"\n",(0,s.jsx)(n.p,{children:"Example configuration:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 80;\n    server_name your.domain;\n    return 301 https://$server_name$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name your.domain;\n\n    # SSL certificate (requires Certbot issuance)\n    ssl_certificate /etc/letsencrypt/live/your.domain/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/your.domain/privkey.pem;\n\n    # Set the static file serving directory\n    root /var/www/your.domain;\n    index index.html;\n\n    # Set MIME types\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n\n    location / {\n        try_files $uri $uri/ /index.html;\n    }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"After completing the configuration, enable the file:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo ln -s /etc/nginx/sites-available/your.domain /etc/nginx/sites-enabled/\n"})}),"\n",(0,s.jsx)(n.p,{children:"Test and reload the Nginx configuration:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo nginx -t\nsudo systemctl reload nginx\n"})}),"\n",(0,s.jsx)(n.h2,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,s.jsx)(n.p,{children:"In production environments, it is recommended to add more security and performance settings. Here is a complete example of advanced configuration:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'server {\n    listen 80;\n    listen [::]:80;\n    server_name your.domain;\n\n    # \u{1F512} Automatically redirect HTTP to HTTPS\n    return 301 https://$host$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name your.domain;\n\n    ssl_certificate /etc/letsencrypt/live/your.domain/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/your.domain/privkey.pem;\n\n    # \u{1F512} Security headers\n    add_header Strict-Transport-Security "max-age=63072000; includeSubdomains; preload" always;\n\n    # \u{1F527} Limit file upload size to prevent DDoS\n    client_max_body_size 10M;\n\n    # \u{1F4C1} build directory\n    root /var/www/your.domain;\n    index index.html;\n\n    # \u{1F5C3}\uFE0F Static resource caching\n    location ~* \\.(jpg|jpeg|png|gif|ico|svg|woff2?|ttf|css|js)$ {\n        expires 7d;\n        add_header Cache-Control "public, must-revalidate";\n    }\n\n    # \u{1F527} Main routing rules\n    location / {\n        try_files $uri $uri/ /index.html;\n    }\n\n    # Set MIME types\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n\n    # \u{1F50D} Custom log file location\n    access_log /var/log/nginx/your.domain.access.log main;\n    error_log /var/log/nginx/your.domain.error.log warn;\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsxs)(n.p,{children:["With the steps above and advanced configurations, you can use Nginx to serve static resources securely and efficiently. Once the configuration is complete, you can access your website at ",(0,s.jsx)(n.code,{children:"https://your.domain"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Finally, remember to regularly check the SSL certificate expiration, update the Nginx version, and maintain security rules. These measures effectively protect against potential security risks and ensure the stable operation of the website over time."})]})}function u(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},84429:function(e,n,i){i.d(n,{R:()=>a,x:()=>o});var t=i(96540);let s={},r=t.createContext(s);function a(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);