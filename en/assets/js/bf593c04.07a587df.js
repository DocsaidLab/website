"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[4955],{8760:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>o,contentTitle:()=>r,default:()=>m,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var n=i(74848),t=i(28453);const a={},r="[21.08] Mobile-Former",l={id:"transformers/vision/mobile-former/index",title:"[21.08] Mobile-Former",description:"Bidirectional Bridge",source:"@site/i18n/en/docusaurus-plugin-content-docs-papers/current/transformers/vision/2108-mobile-former/index.md",sourceDirName:"transformers/vision/2108-mobile-former",slug:"/transformers/vision/mobile-former/",permalink:"/en/papers/transformers/vision/mobile-former/",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"zephyr-sh",lastUpdatedAt:1725692539e3,frontMatter:{},sidebar:"papersSidebar",previous:{title:"[21.06] BEiT",permalink:"/en/papers/transformers/vision/beit/"},next:{title:"[21.10] MobileViT",permalink:"/en/papers/transformers/vision/mobilevit/"}},o={},c=[{value:"Bidirectional Bridge",id:"bidirectional-bridge",level:2},{value:"Problem Definition",id:"problem-definition",level:2},{value:"Solution",id:"solution",level:2},{value:"Model Architecture",id:"model-architecture",level:3},{value:"Architecture Parameters",id:"architecture-parameters",level:3},{value:"Discussion",id:"discussion",level:2},{value:"Performance on ImageNet",id:"performance-on-imagenet",level:3},{value:"Ablation Studies",id:"ablation-studies",level:3},{value:"Conclusion",id:"conclusion",level:2}];function h(e){const s={a:"a",admonition:"admonition",annotation:"annotation",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",math:"math",mi:"mi",mrow:"mrow",msub:"msub",ol:"ol",p:"p",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"2108-mobile-former",children:"[21.08] Mobile-Former"})}),"\n",(0,n.jsx)(s.h2,{id:"bidirectional-bridge",children:"Bidirectional Bridge"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://arxiv.org/pdf/2108.05895",children:(0,n.jsx)(s.strong,{children:"Mobile-Former: Bridging MobileNet and Transformer"})})}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.p,{children:"Researchers have been exploring various methods to make ViT (Vision Transformer) more efficient on mobile devices."}),"\n",(0,n.jsx)(s.h2,{id:"problem-definition",children:"Problem Definition"}),"\n",(0,n.jsx)(s.p,{children:"While it's possible to run ViT on mobile devices, it's slow and doesn't fully benefit from hardware acceleration."}),"\n",(0,n.jsx)(s.p,{children:"The authors of this paper propose a solution:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.strong,{children:'Why not integrate "a bit of" Transformer architecture into MobileNet?'})}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"solution",children:"Solution"}),"\n",(0,n.jsx)(s.h3,{id:"model-architecture",children:"Model Architecture"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"mobile-former arch",src:i(13597).A+"",width:"1224",height:"1068"})}),"\n",(0,n.jsx)(s.p,{children:"The authors introduce a bidirectional bridge architecture that connects MobileNet and Transformer in a parallel manner."}),"\n",(0,n.jsx)(s.p,{children:"Here\u2019s how it works, step by step:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"mobile-former detail",src:i(71631).A+"",width:"940",height:"1080"})}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Blue Block"}),": The input image passes through MobileNet\u2019s feature extraction layer, resulting in a feature map."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Yellow Block"}),": Simultaneously, the input image is processed by the Transformer block, using cross-attention mechanisms for feature extraction.","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"The authors predefine a set of learnable tokens (up to 6), which serve as queries while the feature map acts as key-value pairs."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Green Block"}),": After cross-attention, self-attention is computed."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Red Block"}),": The output from the first step undergoes cross-attention with the output from the third step."]}),"\n",(0,n.jsx)(s.li,{children:"Finally, the output from the fourth step is fed into the next MobileNet block, while the third step\u2019s output is input into the next Transformer block."}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["In each attention mechanism, the authors simplify the calculations by omitting some linear projections, thus reducing parameters and computational load. For example, instead of converting ",(0,n.jsxs)(s.span,{className:"katex",children:[(0,n.jsx)(s.span,{className:"katex-mathml",children:(0,n.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(s.semantics,{children:[(0,n.jsx)(s.mrow,{children:(0,n.jsx)(s.mi,{children:"x"})}),(0,n.jsx)(s.annotation,{encoding:"application/x-tex",children:"x"})]})})}),(0,n.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"x"})]})})]})," into ",(0,n.jsxs)(s.span,{className:"katex",children:[(0,n.jsx)(s.span,{className:"katex-mathml",children:(0,n.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(s.semantics,{children:[(0,n.jsxs)(s.mrow,{children:[(0,n.jsxs)(s.msub,{children:[(0,n.jsx)(s.mi,{children:"W"}),(0,n.jsx)(s.mi,{children:"q"})]}),(0,n.jsx)(s.mi,{children:"x"})]}),(0,n.jsx)(s.annotation,{encoding:"application/x-tex",children:"W_q x"})]})})}),(0,n.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,n.jsxs)(s.span,{className:"mord",children:[(0,n.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"W"}),(0,n.jsx)(s.span,{className:"msupsub",children:(0,n.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(s.span,{className:"vlist-r",children:[(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})]})}),(0,n.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(s.span,{className:"vlist-r",children:(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(s.span,{})})})]})})]}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"x"})]})})]}),", ",(0,n.jsxs)(s.span,{className:"katex",children:[(0,n.jsx)(s.span,{className:"katex-mathml",children:(0,n.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(s.semantics,{children:[(0,n.jsxs)(s.mrow,{children:[(0,n.jsxs)(s.msub,{children:[(0,n.jsx)(s.mi,{children:"W"}),(0,n.jsx)(s.mi,{children:"k"})]}),(0,n.jsx)(s.mi,{children:"x"})]}),(0,n.jsx)(s.annotation,{encoding:"application/x-tex",children:"W_k x"})]})})}),(0,n.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,n.jsxs)(s.span,{className:"mord",children:[(0,n.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"W"}),(0,n.jsx)(s.span,{className:"msupsub",children:(0,n.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(s.span,{className:"vlist-r",children:[(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.3361em"},children:(0,n.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"})})]})}),(0,n.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(s.span,{className:"vlist-r",children:(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(s.span,{})})})]})})]}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"x"})]})})]}),", and ",(0,n.jsxs)(s.span,{className:"katex",children:[(0,n.jsx)(s.span,{className:"katex-mathml",children:(0,n.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(s.semantics,{children:[(0,n.jsxs)(s.mrow,{children:[(0,n.jsxs)(s.msub,{children:[(0,n.jsx)(s.mi,{children:"W"}),(0,n.jsx)(s.mi,{children:"v"})]}),(0,n.jsx)(s.mi,{children:"x"})]}),(0,n.jsx)(s.annotation,{encoding:"application/x-tex",children:"W_v x"})]})})}),(0,n.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,n.jsxs)(s.span,{className:"mord",children:[(0,n.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"W"}),(0,n.jsx)(s.span,{className:"msupsub",children:(0,n.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(s.span,{className:"vlist-r",children:[(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"v"})})]})}),(0,n.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(s.span,{className:"vlist-r",children:(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(s.span,{})})})]})})]}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"x"})]})})]}),", the authors opt to use ",(0,n.jsxs)(s.span,{className:"katex",children:[(0,n.jsx)(s.span,{className:"katex-mathml",children:(0,n.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(s.semantics,{children:[(0,n.jsx)(s.mrow,{children:(0,n.jsx)(s.mi,{children:"x"})}),(0,n.jsx)(s.annotation,{encoding:"application/x-tex",children:"x"})]})})}),(0,n.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"x"})]})})]})," directly for calculations."]}),"\n",(0,n.jsx)(s.p,{children:"Other design optimizations include using a factor of 2 instead of 4 in the Feed-Forward Network (FFN), modifying the input of Dynamic ReLU to be the output of the green block, and using Post-LN normalization."}),"\n",(0,n.jsxs)(s.admonition,{type:"tip",children:[(0,n.jsx)(s.p,{children:"It\u2019s important to note that the green block's output not only goes to the red block but also feeds back into the blue block as input for Dynamic ReLU."}),(0,n.jsx)(s.p,{children:"This design choice warrants discussion, as it could be a significant factor in the model\u2019s performance speed."})]}),"\n",(0,n.jsx)(s.h3,{id:"architecture-parameters",children:"Architecture Parameters"}),"\n",(0,n.jsx)(s.p,{children:"The table below shows how the authors replace each block in the original MobileNet-V3 architecture with a Mobile-Former block."}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"mobile-former params",src:i(93668).A+"",width:"1160",height:"976"})}),"\n",(0,n.jsx)(s.h2,{id:"discussion",children:"Discussion"}),"\n",(0,n.jsx)(s.h3,{id:"performance-on-imagenet",children:"Performance on ImageNet"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"imagenet 1",src:i(65782).A+"",width:"1160",height:"1012"})}),"\n",(0,n.jsx)(s.p,{children:"The authors conducted image classification experiments on the ImageNet dataset, which includes 1,281,167 training images and 50,000 validation images across 1,000 classes."}),"\n",(0,n.jsx)(s.p,{children:"The training settings used a 224\xd7224 image resolution. All models were trained from scratch with the AdamW optimizer for 450 epochs, using cosine learning rate decay. The batch size was 1024, and data augmentation techniques included Mixup, AutoAugment, and Random Erasing. Different combinations of initial learning rate, weight decay, and dropout were applied depending on the model complexity."}),"\n",(0,n.jsx)(s.p,{children:"The table above compares Mobile-Former to classic efficient CNNs like MobileNetV3, EfficientNet, ShuffleNetV2, and WeightNet across seven groups, ranging from 26M to 508M FLOPs."}),"\n",(0,n.jsx)(s.p,{children:"In most cases, Mobile-Former outperforms these efficient CNNs at lower computational costs (FLOPs). Only in the ~150M FLOP range does Mobile-Former have slightly higher FLOPs than ShuffleNet/WeightNet, but with significantly higher Top-1 accuracy (75.2% vs. 69.1%/72.4%)."}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"imagenet 2",src:i(28947).A+"",width:"1152",height:"872"})}),"\n",(0,n.jsx)(s.p,{children:"The authors also compared Mobile-Former with other vision transformer models, including DeiT, T2T-ViT, PVT, ConViT, CoaT, ViTC, and Swin."}),"\n",(0,n.jsx)(s.p,{children:"All variants used 224\xd7224 image resolution without teacher network distillation. Mobile-Former achieves higher accuracy with only 30% of the computational cost of other transformer variants. This efficiency is due to Mobile-Former's use of fewer tokens for global interaction modeling and the effective use of MobileNet for local feature extraction."}),"\n",(0,n.jsx)(s.p,{children:"Notably, Mobile-Former (trained for 450 epochs without distillation) even outperforms LeViT (trained for 1000 epochs with distillation) in terms of accuracy (77.9% vs. 76.6%) while having fewer FLOPs (294M vs. 305M)."}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"imagenet 3",src:i(3698).A+"",width:"1224",height:"760"})}),"\n",(0,n.jsx)(s.p,{children:"The figure above further compares Mobile-Former with more CNN models (like GhostNet) and vision transformer variants (like Swin and DeiT)."}),"\n",(0,n.jsx)(s.p,{children:"Swin and DeiT\u2019s FLOPs range from 100M to 2G, achieved by carefully scaling the network width and height. Mobile-Former consistently outperforms these CNNs and ViT variants, showcasing the advantage of the parallel design that combines MobileNet with Transformer. While vision transformers generally struggle in the low-FLOP range compared to efficient CNNs, this study demonstrates that with proper architectural design, transformers can also excel in low-FLOP scenarios."}),"\n",(0,n.jsx)(s.h3,{id:"ablation-studies",children:"Ablation Studies"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"ablation",src:i(40808).A+"",width:"1160",height:"244"})}),"\n",(0,n.jsx)(s.p,{children:"Which parts of Mobile-Former contribute most to its performance?"}),"\n",(0,n.jsx)(s.p,{children:"The authors conducted ablation studies to examine the impact of different components of Mobile-Former on its performance."}),"\n",(0,n.jsx)(s.p,{children:"The table above shows that adding the Former and bridge (Mobile\u2192Former and Mobile\u2190Former) to MobileNet only increases computational cost by 12% but improves Top-1 accuracy by 2.6% compared to using MobileNet alone."}),"\n",(0,n.jsx)(s.p,{children:"Additionally, using Dynamic ReLU in the Mobile submodule further boosts Top-1 accuracy by 1.0%. The parameters in Dynamic ReLU are generated by the first global token, confirming the effectiveness of Mobile-Former\u2019s parallel design."}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"ablation 2",src:i(3173).A+"",width:"1306",height:"336"})}),"\n",(0,n.jsx)(s.p,{children:"The table above presents ImageNet classification results using different numbers of global tokens in the Former. These tokens have a dimension of 192."}),"\n",(0,n.jsx)(s.p,{children:"Interestingly, even with just one global token, the model performs well (77.1% Top-1 accuracy). Increasing to 3 and 6 tokens improves accuracy by 0.5% and 0.7%, respectively. Beyond 6 tokens, the gains plateau. The compactness of these global tokens is a key factor in Mobile-Former\u2019s efficiency."}),"\n",(0,n.jsx)(s.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,n.jsx)(s.p,{children:"Mobile-Former achieves an efficient vision model by combining MobileNet and Transformer in a parallel design."}),"\n",(0,n.jsx)(s.p,{children:"However, the authors note that while Mobile-Former is faster than MobileNetV3 for large image processing, it slows down with smaller images, especially on mobile devices. This aspect could be a valuable area for future research."}),"\n",(0,n.jsxs)(s.admonition,{type:"tip",children:[(0,n.jsx)(s.p,{children:"The MobileNet-V3 data referenced in this paper is somewhat outdated and hasn\u2019t been optimized with modern training techniques. For more up-to-date information, readers can refer to the MobileNet-V4 paper."}),(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"/en/papers/cnns/lightweight/mobilenet-v4/",children:(0,n.jsx)(s.strong,{children:"[24.04] MobileNet-V4: Five Years of Evolution"})})}),"\n"]}),(0,n.jsx)(s.p,{children:"Mobile-Former might perform differently on this new foundation."})]})]})}function m(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},13597:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/img1-04e9f13ceb67ca8c2c3d683b462f3264.jpg"},3698:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/img2-79fafe74c66539813ed79ea7d5a7aa11.jpg"},71631:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/img3-91f32fc757d07e2facd6bbb1493fc400.jpg"},93668:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/img4-ed15d39985cde50840842f46e05e8738.jpg"},65782:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/img6-8e16469129875f4ea4e3c706b36d4f93.jpg"},28947:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/img7-11c8af22f5060f145250cbf522b1da10.jpg"},40808:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/img8-8bfb76872e246e541ea04a66ba16f7e0.jpg"},3173:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/img9-dd15d064674c0a7ffa8cfa5fa9046246.jpg"},28453:(e,s,i)=>{i.d(s,{R:()=>r,x:()=>l});var n=i(96540);const t={},a=n.createContext(t);function r(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);