"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["55647"],{11243:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>a,default:()=>h,contentTitle:()=>o,assets:()=>c,toc:()=>d,metadata:()=>r});var r=JSON.parse('{"id":"wordcanvas/mrz_gen","title":"MRZGenerator","description":"After completing the development of WordCanvas, we can use this tool to do some other tasks.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/wordcanvas/mrz_gen.md","sourceDirName":"wordcanvas","slug":"/wordcanvas/mrz_gen","permalink":"/en/docs/wordcanvas/mrz_gen","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"zephyr-sh","lastUpdatedAt":1742396243000,"sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Augmentation","permalink":"/en/docs/wordcanvas/imgaug"},"next":{"title":"BarcodeGenerator","permalink":"/en/docs/wordcanvas/barcode_gen"}}'),i=t(85893),s=t(50065);let a={sidebar_position:6},o="MRZGenerator",c={},d=[{value:"What is MRZ?",id:"what-is-mrz",level:2},{value:"Synthetic Images",id:"synthetic-images",level:2},{value:"Display Coordinates of Each Character",id:"display-coordinates-of-each-character",level:2},{value:"Modify Text Background Color and Spacing",id:"modify-text-background-color-and-spacing",level:2},{value:"Specify MRZ Text",id:"specify-mrz-text",level:2},{value:"Further Reading",id:"further-reading",level:2}];function l(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"mrzgenerator",children:"MRZGenerator"})}),"\n",(0,i.jsxs)(n.p,{children:["After completing the development of ",(0,i.jsx)(n.code,{children:"WordCanvas"}),", we can use this tool to do some other tasks."]}),"\n",(0,i.jsx)(n.p,{children:'In this chapter, we will develop a feature that renders the "MRZ image" from the "given input text."'}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["This feature is mainly used to support the training of our ",(0,i.jsx)(n.a,{href:"https://docsaid.org/en/docs/mrzscanner",children:(0,i.jsx)(n.strong,{children:"MRZScanner"})})," model."]}),(0,i.jsxs)(n.p,{children:["Interested readers can try out the model we provided: ",(0,i.jsx)(n.a,{href:"https://docsaid.org/en/playground/mrzscanner-demo",children:(0,i.jsx)(n.strong,{children:"MRZScanner Demo"})})]})]}),"\n",(0,i.jsx)(n.h2,{id:"what-is-mrz",children:"What is MRZ?"}),"\n",(0,i.jsx)(n.p,{children:"MRZ (Machine Readable Zone) refers to a specific area on travel documents such as passports, visas, and identity cards, where the information can be quickly read by machines. MRZ is designed and generated according to the guidelines of ICAO Document 9303 to accelerate border checks and improve the accuracy of information processing."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.icao.int/publications/Documents/9303_p1_cons_en.pdf",children:(0,i.jsx)(n.strong,{children:"ICAO Doc9309"})})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The structure of MRZ varies depending on the type of document, with the following common formats:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"TD1 (Identity cards, etc.):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consists of three lines, each with 30 characters, totaling 90 characters."}),"\n",(0,i.jsx)(n.li,{children:"Includes: Document type, country code, document number, date of birth, gender, expiration date, nationality, surname, given name, optional data 1, optional data 2."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"TD2 (Passport cards, etc.):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consists of two lines, each with 36 characters, totaling 72 characters."}),"\n",(0,i.jsx)(n.li,{children:"Includes: Document type, country code, surname, given name, document number, nationality, date of birth, gender, expiration date, optional data."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"TD3 (Passports, etc.):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consists of two lines, each with 44 characters, totaling 88 characters."}),"\n",(0,i.jsx)(n.li,{children:"Includes: Document type, country code, surname, given name, document number, nationality, date of birth, gender, expiration date, optional data."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"MRVA (Visa type A):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consists of two lines, each with 44 characters, totaling 88 characters."}),"\n",(0,i.jsx)(n.li,{children:"Includes: Document type, country code, surname, given name, document number, nationality, date of birth, gender, expiration date, optional data."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"MRVB (Visa type B):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consists of two lines, each with 36 characters, totaling 72 characters."}),"\n",(0,i.jsx)(n.li,{children:"Includes: Document type, country code, surname, given name, document number, nationality, date of birth, gender, expiration date, optional data."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"synthetic-images",children:"Synthetic Images"}),"\n",(0,i.jsxs)(n.p,{children:["When we want to train an MRZ detection model, we need a large dataset. However, these datasets often contain personal information, making them difficult to collect. To address this issue, we can use ",(0,i.jsx)(n.code,{children:"WordCanvas"})," to generate synthetic MRZ images."]}),"\n",(0,i.jsxs)(n.p,{children:["We have already implemented the relevant features, and you can refer to the following example to use ",(0,i.jsx)(n.code,{children:"MRZGenerator"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from wordcanvas import MRZGenerator\n\nmrz_gen = MRZGenerator(\n    text_color=(0, 0, 0),\n    background_color=(255, 255, 255),\n)\n\noutput_infos = mrz_gen()\nimg = output_infos['image']\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In this configuration, you can manually specify the text color, background color, and separator. Since MRZ text consists of 2 to 3 lines, the separator is set to ",(0,i.jsx)(n.code,{children:"\\n"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["After the setup, simply call it as a function, and we\u2019ve implemented the ",(0,i.jsx)(n.code,{children:"__call__"})," method:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"output_infos = mrz_gen()\n"})}),"\n",(0,i.jsx)(n.p,{children:"This will generate a synthetic MRZ image, with the output format as:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"typ"}),": MRZ type."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"text"}),": MRZ text."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"points"}),": Coordinates of each character in the MRZ."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"image"}),": MRZ image."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"When no parameters are provided, the MRZ type (TD1, TD2, TD3) will be chosen randomly, and MRZ text will be generated randomly, then synthesized into an image."}),"\n",(0,i.jsx)(n.p,{children:"Here is an example of the output image:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mrz_output",src:t(41734).Z+"",width:"1152",height:"157"})}),"\n",(0,i.jsx)(n.h2,{id:"display-coordinates-of-each-character",children:"Display Coordinates of Each Character"}),"\n",(0,i.jsxs)(n.p,{children:["If you're interested in the position of each character, which can help in training a text detection model, we\u2019ve provided this feature. You can simply call the ",(0,i.jsx)(n.code,{children:"points"})," property, and we will directly plot the points for you:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import cv2\nfrom capybara import draw_points\nfrom wordcanvas import MRZGenerator\n\nmrz_gen = MRZGenerator(\n    text_color=(0, 0, 0),\n    background_color=(255, 255, 255),\n)\n\noutput_infos = mrz_gen()\n\nimg = output_infos['image']\npoints = output_infos['points']\npoints_img = draw_points(img, points, scales=5)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mrz_points",src:t(57237).Z+"",width:"1690",height:"118"})}),"\n",(0,i.jsx)(n.h2,{id:"modify-text-background-color-and-spacing",children:"Modify Text Background Color and Spacing"}),"\n",(0,i.jsxs)(n.p,{children:["You can modify the text and background colors using the ",(0,i.jsx)(n.code,{children:"text_color"})," and ",(0,i.jsx)(n.code,{children:"background_color"})," parameters:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"mrz_gen = MRZGenerator(\n    text_color=(255, 0, 0),\n    background_color=(0, 127, 127),\n)\n\noutput_infos = mrz_gen()\nimg = output_infos['image']\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mrz_color",src:t(21967).Z+"",width:"1152",height:"179"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["You can adjust the spacing between characters using the ",(0,i.jsx)(n.code,{children:"spacing"})," parameter:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"mrz_gen = MRZGenerator(\n    spacing=100,\n)\n\noutput_infos = mrz_gen()\nimg = output_infos['image']\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mrz_interval",src:t(85131).Z+"",width:"1152",height:"341"})}),"\n",(0,i.jsx)(n.h2,{id:"specify-mrz-text",children:"Specify MRZ Text"}),"\n",(0,i.jsxs)(n.p,{children:["If you want to specify the MRZ text, you can pass the ",(0,i.jsx)(n.code,{children:"mrz_type"})," and ",(0,i.jsx)(n.code,{children:"mrz_text"})," parameters when calling the function. We\u2019ve implemented some basic checks in the function, such as verifying that the text length matches the type."]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"Please note that we do not perform hash checks. This feature is only for generating synthetic images and does not require real MRZ text."})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'mrz_gen = MRZGenerator(spacing=32)\n\noutput_infos = mrz_gen(\n    mrz_type=\'TD1\',\n    mrz_text=[\n        "I<SWE59000002<8198703142391<<<",\n        "8703145M1701027SWE<<<<<<<<<<<8",\n        "SPECIMEN<<SVEN<<<<<<<<<<<<<<<<"\n    ]\n)\n\nimg = output_infos[\'image\']\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mrz_assign_text",src:t(96269).Z+"",width:"1152",height:"201"})}),"\n",(0,i.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/Arg0s1080/mrz",children:(0,i.jsx)(n.strong,{children:"Arg0s1080/mrz"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://pyimagesearch.com/2015/11/30/detecting-machine-readable-zones-in-passport-images/",children:(0,i.jsx)(n.strong,{children:"Detecting machine-readable zones in passport images"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/DoubangoTelecom/ultimateMRZ-SDK",children:(0,i.jsx)(n.strong,{children:"ultimateMRZ-SDK"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/Mattijah/QKMRZScanner",children:(0,i.jsx)(n.strong,{children:"QKMRZScanner"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/evermeer/PassportScanner",children:(0,i.jsx)(n.strong,{children:"PassportScanner"})})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},96269:function(e,n,t){t.d(n,{Z:()=>r});let r=t.p+"assets/images/mrz_assign_text-8e58148d9b5157da8b030e458ee70b16.jpg"},21967:function(e,n,t){t.d(n,{Z:()=>r});let r=t.p+"assets/images/mrz_color-6f5a1a4b8429844ad9ddc12bb7ad9f3c.jpg"},85131:function(e,n,t){t.d(n,{Z:()=>r});let r=t.p+"assets/images/mrz_interval-ed4898716ff48901e42080bf85c6ecc8.jpg"},41734:function(e,n,t){t.d(n,{Z:()=>r});let r=t.p+"assets/images/mrz_output-b77fd307822b623c5c5d47a9ea56d136.jpg"},57237:function(e,n,t){t.d(n,{Z:()=>r});let r=t.p+"assets/images/mrz_points-b4717274ea5a0b088a74ec98ed53c775.jpg"},50065:function(e,n,t){t.d(n,{Z:()=>o,a:()=>a});var r=t(67294);let i={},s=r.createContext(i);function a(e){let n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);