"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["79515"],{81305:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>o,default:()=>h,toc:()=>c,metadata:()=>s,assets:()=>a,contentTitle:()=>l});var s=JSON.parse('{"id":"nginx-notes/install-and-settings","title":"Nginx Configuration","description":"We will use Ubuntu as an example to install Nginx and set up basic configurations.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/nginx-notes/install-and-settings.md","sourceDirName":"nginx-notes","slug":"/nginx-notes/install-and-settings","permalink":"/en/docs/nginx-notes/install-and-settings","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"zephyr-sh","lastUpdatedAt":1740705000000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Nginx Introduction","permalink":"/en/docs/nginx-notes/intro"},"next":{"title":"Nginx HTTPS Settings","permalink":"/en/docs/nginx-notes/https-settings"}}'),t=i(85893),r=i(50065);let o={sidebar_position:2},l="Nginx Configuration",a={},c=[{value:"Installing Nginx",id:"installing-nginx",level:2},{value:"Nginx Configuration",id:"nginx-configuration-1",level:2},{value:"Main File",id:"main-file",level:3},{value:"Site Files",id:"site-files",level:3},{value:"Testing and Verification",id:"testing-and-verification",level:2},{value:"Multi-Site Configuration",id:"multi-site-configuration",level:2},{value:"Default Configuration",id:"default-configuration",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"nginx-configuration",children:"Nginx Configuration"})}),"\n",(0,t.jsx)(n.p,{children:"We will use Ubuntu as an example to install Nginx and set up basic configurations."}),"\n",(0,t.jsx)(n.p,{children:"For other operating systems, please refer to the official documentation or other resources for installation."}),"\n",(0,t.jsx)(n.h2,{id:"installing-nginx",children:"Installing Nginx"}),"\n",(0,t.jsx)(n.p,{children:"First, update the software repository and install Nginx:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install -y nginx\n"})}),"\n",(0,t.jsx)(n.p,{children:"Once installed, the Nginx service will start automatically."}),"\n",(0,t.jsxs)(n.p,{children:["We can check if Nginx is running properly using ",(0,t.jsx)(n.code,{children:"systemctl"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo systemctl status nginx\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If it shows ",(0,t.jsx)(n.code,{children:"active (running)"}),", it means Nginx has started successfully."]}),"\n",(0,t.jsx)("div",{align:"center",children:(0,t.jsx)("figure",{style:{width:"90%"},children:(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"active-running",src:i(45741).Z+"",width:"1224",height:"248"})})})}),"\n",(0,t.jsxs)(n.admonition,{type:"warning",children:[(0,t.jsx)(n.p,{children:"If the server has a firewall enabled (such as UFW), ensure that HTTP and HTTPS traffic are allowed:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo ufw allow 'Nginx Full'\n"})})]}),"\n",(0,t.jsx)(n.h2,{id:"nginx-configuration-1",children:"Nginx Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"main-file",children:"Main File"}),"\n",(0,t.jsxs)(n.p,{children:["The main configuration file for Nginx is ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/etc/nginx/nginx.conf"})}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["For detailed usage, please refer to our supplementary documentation: ",(0,t.jsx)(n.a,{href:"/en/docs/nginx-notes/supplementary/nginx-conf-intro",children:(0,t.jsx)(n.strong,{children:"nginx.conf"})})]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"Due to space constraints, the detailed explanation is provided separately. Be sure to check it out. \u2B06 \u2B06 \u2B06"})}),"\n",(0,t.jsx)(n.h3,{id:"site-files",children:"Site Files"}),"\n",(0,t.jsx)(n.p,{children:"For each website or service, we typically configure them in two directories:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/etc/nginx/sites-available/"})}),": Create individual configuration files."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/etc/nginx/sites-enabled/"})}),": Enable sites through symbolic links."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Nginx uses the ",(0,t.jsx)(n.code,{children:"sites-available"})," and ",(0,t.jsx)(n.code,{children:"sites-enabled"})," directories to manage configurations for multiple sites."]}),"\n",(0,t.jsxs)(n.p,{children:["For detailed usage, please refer to our supplementary documentation: ",(0,t.jsx)(n.a,{href:"/en/docs/nginx-notes/supplementary/sites-available-intro",children:(0,t.jsx)(n.strong,{children:"sites-available/default"})})]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"Again, make sure to check out the explanation file. \u2B06 \u2B06 \u2B06"})}),"\n",(0,t.jsx)(n.h2,{id:"testing-and-verification",children:"Testing and Verification"}),"\n",(0,t.jsx)(n.p,{children:"After completing the configuration, it's essential to verify if the setup is correct:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Check Nginx Configuration Syntax"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo nginx -t\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If it shows ",(0,t.jsx)(n.code,{children:"syntax is ok"})," and ",(0,t.jsx)(n.code,{children:"test is successful"}),", the configuration is correct."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Reload Nginx to Apply New Configuration"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo systemctl reload nginx\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Verify the Service"})}),"\n",(0,t.jsxs)(n.p,{children:["Use a browser or ",(0,t.jsx)(n.code,{children:"curl"})," to access ",(0,t.jsx)(n.code,{children:"http://temp_api.example.com/test"})," and check if the expected response is received."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.admonition,{type:"tip",children:[(0,t.jsxs)(n.p,{children:["Please note that the ",(0,t.jsx)(n.code,{children:"http://temp_api.example.com/test"})," endpoint is based on the hypothetical API endpoint from the previous section."]}),(0,t.jsxs)(n.p,{children:["You should modify the ",(0,t.jsx)(n.code,{children:"server_name"})," and ",(0,t.jsx)(n.code,{children:"proxy_pass"})," settings in the configuration file according to your actual setup."]})]}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Common Commands"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Start Nginx\nsudo systemctl start nginx\n\n# Stop Nginx\nsudo systemctl stop nginx\n\n# Restart Nginx (typically used for major configuration changes)\nsudo systemctl restart nginx\n\n# Reload Nginx (recommended for minor configuration changes)\nsudo systemctl reload nginx\n"})})]}),"\n",(0,t.jsx)(n.h2,{id:"multi-site-configuration",children:"Multi-Site Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Nginx uses ",(0,t.jsx)(n.code,{children:"server"})," blocks to define virtual hosts, and it determines which site to process based on the requested ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"Host"})})," and ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"listen"})}),' port. When a user sends an HTTP request, Nginx first compares the requested "Host" and "Port" with the configured ',(0,t.jsx)(n.code,{children:"server"})," blocks and processes the matching one."]}),"\n",(0,t.jsxs)(n.p,{children:["Typically, each site is configured to listen on a specified port (like 80 or 443) with the ",(0,t.jsx)(n.code,{children:"listen"})," directive, and the ",(0,t.jsx)(n.code,{children:"server_name"})," directive is used to match a specific domain. For example, ",(0,t.jsx)(n.code,{children:"example.com"})," and ",(0,t.jsx)(n.code,{children:"api.example.com"})," can each have their own ",(0,t.jsx)(n.code,{children:"server_name"}),", and Nginx will select the appropriate configuration based on the Host header."]}),"\n",(0,t.jsx)(n.p,{children:"Here\u2019s an example of a typical multi-site configuration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",metastring:'title="/etc/nginx/sites-available/example.com"',children:"server {\n    listen 80;\n    server_name example.com;\n    root /var/www/example.com;\n    index index.html;\n}\n\nserver {\n    listen 80;\n    server_name api.example.com;\n    location / {\n        proxy_pass http://localhost:5000/;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The first ",(0,t.jsx)(n.code,{children:"server"})," block handles static resources for ",(0,t.jsx)(n.code,{children:"example.com"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["The second ",(0,t.jsx)(n.code,{children:"server"})," block handles requests for ",(0,t.jsx)(n.code,{children:"api.example.com"})," and proxies them to the local API service running on port ",(0,t.jsx)(n.code,{children:"5000"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["For example, when users access ",(0,t.jsx)(n.code,{children:"http://example.com"}),", Nginx will route the request to the ",(0,t.jsx)(n.code,{children:"index.html"})," file in ",(0,t.jsx)(n.code,{children:"/var/www/example.com"}),"; when they access ",(0,t.jsx)(n.code,{children:"http://api.example.com"}),", the request will be forwarded to the API service on port ",(0,t.jsx)(n.code,{children:"5000"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"default-configuration",children:"Default Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["We can set up a ",(0,t.jsx)(n.code,{children:"default_server"})," in the configuration file, so when there is no matching ",(0,t.jsx)(n.code,{children:"server_name"}),", Nginx will use the default server to handle the request:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 80 default_server;\n    server_name _;\n    return 404;\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"This configuration prevents requests with unspecified domain names from being routed to the wrong site."}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.p,{children:"Finally, let's take a look at how to troubleshoot when issues arise."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Check Nginx Configuration for Errors"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo nginx -t\n"})}),"\n",(0,t.jsx)(n.p,{children:"If there are error messages, follow the instructions to fix the configuration."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Check Nginx Service Status"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo systemctl status nginx\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If it shows ",(0,t.jsx)(n.code,{children:"active (running)"}),", Nginx is running normally; if it shows ",(0,t.jsx)(n.code,{children:"failed"}),", check the error logs."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"View Error Logs"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo journalctl -u nginx --no-pager --lines=30\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Or directly view the ",(0,t.jsx)(n.code,{children:"error.log"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo tail -f /var/log/nginx/error.log\n"})}),"\n",(0,t.jsx)(n.p,{children:"These logs help identify specific errors like 404, 502, 403, etc."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,t.jsx)(n.p,{children:"In this chapter, we covered how to install Nginx on Ubuntu and configure basic sites, reverse proxy, and multi-site management."}),"\n",(0,t.jsx)(n.p,{children:"We also learned how to test and verify configurations to ensure the website is functioning correctly. With these basic settings, Nginx can meet the needs of most static websites and API proxies."}),"\n",(0,t.jsx)(n.p,{children:"In the next chapter, we\u2019ll look at how to configure HTTPS and use Let's Encrypt."})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},45741:function(e,n,i){i.d(n,{Z:()=>s});let s=i.p+"assets/images/img1-341cf09fd27a49065afc0eccb9b35913.jpg"},50065:function(e,n,i){i.d(n,{Z:()=>l,a:()=>o});var s=i(67294);let t={},r=s.createContext(t);function o(e){let n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);