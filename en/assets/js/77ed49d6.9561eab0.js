"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["14604"],{5619:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>o,default:()=>h,toc:()=>l,metadata:()=>t,assets:()=>c,contentTitle:()=>a});var t=JSON.parse('{"id":"mrzscanner/intro","title":"Introduction","description":"MRZ (Machine Readable Zone) refers to a specific area on travel documents such as passports, visas, and identity cards, where information can be quickly read by machines. MRZ is designed and generated according to the guidelines in ICAO Document 9303, to speed up border control and improve the accuracy of information processing.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/mrzscanner/intro.md","sourceDirName":"mrzscanner","slug":"/mrzscanner/intro","permalink":"/en/docs/mrzscanner/intro","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"zephyr-sh","lastUpdatedAt":1740795610000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"MRZScanner","permalink":"/en/docs/mrzscanner/"},"next":{"title":"Installation","permalink":"/en/docs/mrzscanner/installation"}}'),s=i(85893),r=i(50065);let o={sidebar_position:1},a="Introduction",c={},l=[{value:"Structure Overview",id:"structure-overview",level:2},{value:"Text Recognition",id:"text-recognition",level:2},{value:"Two-Stage Recognition",id:"two-stage-recognition",level:2},{value:"It\u2019s Boring",id:"its-boring",level:3},{value:"Single-Stage Recognition",id:"single-stage-recognition",level:2},{value:"Playground",id:"playground",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(e){let n={a:"a",admonition:"admonition",blockquote:"blockquote",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"introduction",children:"Introduction"})}),"\n",(0,s.jsx)(n.p,{children:"MRZ (Machine Readable Zone) refers to a specific area on travel documents such as passports, visas, and identity cards, where information can be quickly read by machines. MRZ is designed and generated according to the guidelines in ICAO Document 9303, to speed up border control and improve the accuracy of information processing."}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Interested readers can refer to: ",(0,s.jsx)(n.a,{href:"/en/docs/mrzscanner/reference#icao-9303",children:(0,s.jsx)(n.strong,{children:"Document 9303"})})]})}),"\n",(0,s.jsx)(n.p,{children:"Many people may not be familiar with MRZ, but almost everyone has a passport with an MRZ block, which looks like this, with the red box indicating the MRZ area:"}),"\n",(0,s.jsx)("div",{align:"center",children:(0,s.jsx)("figure",{style:{width:"60%"},children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{alt:"mrz example",src:i(32265).Z+"",width:"2814",height:"1975"}),"\n",(0,s.jsxs)("figcaption",{children:["Image source: ",(0,s.jsx)(n.a,{href:"http://l3i-share.univ-lr.fr/MIDV2020/midv2020.html",children:(0,s.jsx)(n.strong,{children:"MIDV-2020 Synthetic Dataset"})})]})]})})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"In addition to passports, some countries also have MRZ blocks on identity cards, driver\u2019s licenses, visas, and other documents."}),"\n",(0,s.jsx)(n.p,{children:"We can see that MRZ blocks have several obvious characteristics:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Fixed Structure"}),": Different types of MRZs have different structures, and each field's meaning is fixed."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Clean Text Area"}),": The MRZ background is solid, the text is black, and there is a defined gap between characters."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Simple Classification"}),": MRZ text contains only numbers and uppercase letters, with just 37 possible characters."]}),"\n"]}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"MRZ structures differ based on the type of document. The main types are:"}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TD1 (ID cards, etc.)"}),": Three lines with 30 characters per line, totaling 90 characters."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TD2 (Passport cards, etc.)"}),": Two lines with 36 characters per line, totaling 72 characters."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TD3 (Passports, etc.)"}),": Two lines with 44 characters per line, totaling 88 characters."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"MRVA (Visa Type A)"}),": Two lines with 44 characters per line, totaling 88 characters."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"MRVB (Visa Type B)"}),": Two lines with 36 characters per line, totaling 72 characters."]}),"\n"]})]}),"\n",(0,s.jsx)(n.h2,{id:"structure-overview",children:"Structure Overview"}),"\n",(0,s.jsxs)(n.p,{children:["We refer to the popular MRZ parsing GitHub project ",(0,s.jsx)(n.a,{href:"https://github.com/Arg0s1080/mrz",children:(0,s.jsx)(n.strong,{children:"Arg0s1080/mrz"})})," to explain the structure of MRZ:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"field distribution",src:i(38047).Z+"",width:"842",height:"850"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"From the above diagram, we can clearly understand the meaning of each MRZ block:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Type"}),": Document type, such as passport, identity card, visa, etc."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Country Code"}),": Issuing country code."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Surname"}),": Surname."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Given Names"}),": Given names."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Document Number"}),": Document number."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"National"}),": Nationality."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Date of Birth"}),": Date of birth."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Date of Expiry"}),": Expiry date."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Optional"}),": Custom fields."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"text-recognition",children:"Text Recognition"}),"\n",(0,s.jsx)(n.p,{children:'Our focus in this project is "MRZ Text Recognition." This topic is somewhat niche, and there aren\u2019t many research papers on it. But when you break down the problem, it\'s essentially an OCR task. A few OCR models can be fine-tuned, and the problem is solved.'}),"\n",(0,s.jsx)(n.p,{children:"But that\u2019s wasteful! Too wasteful!"}),"\n",(0,s.jsx)(n.p,{children:"OCR models are typically designed to recognize a wide variety of text types, including numbers, uppercase letters, punctuation, etc. The prediction head might cover thousands of characters, making the model complex and requiring more computational resources."}),"\n",(0,s.jsx)(n.p,{children:"If we applied such a model directly to MRZ recognition, it would not be very professional, right?"}),"\n",(0,s.jsx)(n.p,{children:"Therefore, we must redesign the model specifically for MRZ characteristics. This specialized model can perform the task more efficiently without having to handle unnecessary text types, saving computational resources and improving recognition speed and accuracy."}),"\n",(0,s.jsx)(n.h2,{id:"two-stage-recognition",children:"Two-Stage Recognition"}),"\n",(0,s.jsx)(n.p,{children:"Since we are designing a specialized model, we can divide MRZ recognition into two stages:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Region Localization"}),": Using a lightweight model to focus on locating the MRZ region in the image."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Text Recognition"}),": Using a lightweight model to focus on recognizing the text within the MRZ region."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"We spent half a month completing the MRZ localization model and another month completing the MRZ recognition model. The overall performance is quite good. On our custom test set (around 300 MRZ documents), the full-image accuracy reached 97.02%, and the ANLS was 99.97%."}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["Full-image accuracy and ANLS are the metrics we use to evaluate the model\u2019s performance. For more information about these metrics, refer to another section: ",(0,s.jsx)(n.a,{href:"/en/docs/mrzscanner/benchmark",children:(0,s.jsx)(n.strong,{children:"Model Evaluation"})})]})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Since each MRZ region contains at least 72 characters and at most 90 characters, through experimentation, if we aim for a full-image accuracy of 95%, the ANLS value needs to be at least around 99.95%. This is not an easy task."})}),"\n",(0,s.jsx)(n.p,{children:"The only downside to this approach is..."}),"\n",(0,s.jsx)(n.h3,{id:"its-boring",children:"It\u2019s Boring"}),"\n",(0,s.jsx)(n.p,{children:"No matter how you look at it, we feel that finishing this task smoothly is just doing our job."}),"\n",(0,s.jsx)(n.p,{children:"Since the client gave us the requirement, we simply followed the steps and completed it. After delivering the solution to the client, we tossed it into the corner and began thinking about new solutions."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"If we don't use a two-stage recognition approach, then it has to be single-stage recognition!"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"We must directly recognize the text within the MRZ region from the raw image."}),"\n",(0,s.jsx)(n.h2,{id:"single-stage-recognition",children:"Single-Stage Recognition"}),"\n",(0,s.jsx)(n.p,{children:"Then we continued to spend three more months completing a single-stage MRZ recognition model. The results were somewhat unsatisfactory, with a full-image accuracy of only about 40% and an ANLS of just 97%."}),"\n",(0,s.jsx)(n.p,{children:"Honestly, we spent more time than we initially expected, and it was a bit of a loss. This problem turned out to be more difficult than we imagined. Several times we thought, \u201CWhy not just stick with the two-stage solution? It\u2019s boring, but at least it\u2019s accurate! Why make things harder for ourselves?\u201D"}),"\n",(0,s.jsx)(n.p,{children:"There were several difficulties with the single-stage model:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"The size and scale of the full-image search are inconsistent."}),"\n",(0,s.jsx)(n.li,{children:"The MRZ region has unpredictable rotations."}),"\n",(0,s.jsx)(n.li,{children:"The need for fine-grained perception leads to a computational explosion."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Given these challenges, the model had to remain lightweight to meet the requirements of mobile applications. These factors made the model difficult to converge and resulted in subpar performance."}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["We will go into the technical details in the next chapters: ",(0,s.jsx)(n.a,{href:"/en/docs/mrzscanner/model_arch",children:(0,s.jsx)(n.strong,{children:"Model Design"})})]})}),"\n",(0,s.jsx)(n.p,{children:"In the end, despite the frustration during the development process, we persisted and completed the task. Since the money and time spent can\u2019t be recovered, we decided to open-source this solution and share it with everyone."}),"\n",(0,s.jsx)(n.p,{children:'We view the single-stage solution as a "milestone." Our vision for the complete solution is a more robust, more accurate model that can handle more application scenarios.'}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"We will continue to read more papers and improve the model's performance in the future."})}),"\n",(0,s.jsx)(n.h2,{id:"playground",children:"Playground"}),"\n",(0,s.jsx)(n.p,{children:"We have placed this model on this webpage, so you can try it out in the playground."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docsaid.org/en/playground/mrzscanner-demo",children:(0,s.jsx)(n.strong,{children:"MRZScanner-Demo"})})}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"If you find any bugs while using it, please notify us privately to avoid malicious exploitation, and we will address them as soon as possible."})}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(n.p,{children:"In this project, we have completed the following features:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Verified the validity of synthetic datasets."}),"\n",(0,s.jsx)(n.li,{children:"Completed a two-stage solution for MRZ region localization and recognition."}),"\n",(0,s.jsx)(n.li,{children:"Integrated MRZ localization and recognition into a single-stage recognition model."}),"\n",(0,s.jsx)(n.li,{children:"Integrated all MRZ document formats and provided a unified parsing interface."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"If you are interested in this topic, feel free to test it out yourself, and we look forward to your feedback."}),"\n",(0,s.jsx)(n.p,{children:"We also welcome suggestions and are happy to engage in discussions with you."})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},38047:function(e,n,i){i.d(n,{Z:()=>t});let t=i.p+"assets/images/Fields_Distribution-a28293a4a696dc48d1af0bb8197670a3.png"},32265:function(e,n,i){i.d(n,{Z:()=>t});let t=i.p+"assets/images/img1-e65e6f83f042bd41ad1710cadb8ef9d9.jpg"},50065:function(e,n,i){i.d(n,{Z:()=>a,a:()=>o});var t=i(67294);let s={},r=t.createContext(s);function o(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);