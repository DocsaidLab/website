"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["18254"],{88239:function(e,n,i){i.r(n),i.d(n,{default:()=>h,frontMatter:()=>l,metadata:()=>s,assets:()=>a,toc:()=>c,contentTitle:()=>o});var s=JSON.parse('{"id":"nginx-notes/supplementary/sites-available-intro","title":"sites-available","description":"Nginx Site Configuration Files","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/nginx-notes/supplementary/sites-available-intro.md","sourceDirName":"nginx-notes/supplementary","slug":"/nginx-notes/supplementary/sites-available-intro","permalink":"/en/docs/nginx-notes/supplementary/sites-available-intro","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"zephyr-sh","lastUpdatedAt":1739451273000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"nginx.conf","permalink":"/en/docs/nginx-notes/supplementary/nginx-conf-intro"},"next":{"title":"WordCanvas","permalink":"/en/docs/wordcanvas/"}}'),t=i("85893"),r=i("50065");let l={},o="sites-available",a={},c=[{value:"Nginx Site Configuration Files",id:"nginx-site-configuration-files",level:2},{value:"Configuration File Overview",id:"configuration-file-overview",level:2},{value:"Default Server Configuration",id:"default-server-configuration",level:2},{value:"FastCGI PHP Handling",id:"fastcgi-php-handling",level:2},{value:"Restrict Access to <code>.htaccess</code>",id:"restrict-access-to-htaccess",level:2},{value:"Example Virtual Host Configuration",id:"example-virtual-host-configuration",level:2},{value:"How to Enable/Disable This Configuration",id:"how-to-enabledisable-this-configuration",level:2}];function d(e){let n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"sites-available",children:"sites-available"})}),"\n",(0,t.jsx)(n.h2,{id:"nginx-site-configuration-files",children:"Nginx Site Configuration Files"}),"\n",(0,t.jsxs)(n.p,{children:["By default, Nginx uses ",(0,t.jsx)(n.code,{children:"/etc/nginx/sites-available/default"})," as the default site configuration."]}),"\n",(0,t.jsxs)(n.p,{children:["We can create new configuration files as needed (e.g., ",(0,t.jsx)(n.code,{children:"temp_api.conf"}),") to specifically configure new API reverse proxies and static resource services."]}),"\n",(0,t.jsx)(n.p,{children:"Now, let's take a look at the contents of this file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",metastring:'title="/etc/nginx/sites-available/default.conf"',children:"##\n# You should look at the following URL's in order to grasp a solid understanding\n# of Nginx configuration files in order to fully unleash the power of Nginx.\n# https://www.nginx.com/resources/wiki/start/\n# https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/\n# https://wiki.debian.org/Nginx/DirectoryStructure\n#\n# In most cases, administrators will remove this file from sites-enabled/ and\n# leave it as reference inside of sites-available where it will continue to be\n# updated by the nginx packaging team.\n#\n# This file will automatically load configuration files provided by other\n# applications, such as Drupal or Wordpress. These applications will be made\n# available underneath a path with that package name, such as /drupal8.\n#\n# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.\n##\n\n# Default server configuration\n#\nserver {\n	listen 80 default_server;\n	listen [::]:80 default_server;\n\n	# SSL configuration\n	#\n	# listen 443 ssl default_server;\n	# listen [::]:443 ssl default_server;\n	#\n	# Note: You should disable gzip for SSL traffic.\n	# See: https://bugs.debian.org/773332\n	#\n	# Read up on ssl_ciphers to ensure a secure configuration.\n	# See: https://bugs.debian.org/765782\n	#\n	# Self signed certs generated by the ssl-cert package\n	# Don't use them in a production server!\n	#\n	# include snippets/snakeoil.conf;\n\n	root /var/www/html;\n\n	# Add index.php to the list if you are using PHP\n	index index.html index.htm index.nginx-debian.html;\n\n	server_name _;\n\n	location / {\n		# First attempt to serve request as file, then\n		# as directory, then fall back to displaying a 404.\n		try_files $uri $uri/ =404;\n	}\n\n	# pass PHP scripts to FastCGI server\n	#\n	#location ~ \\.php$ {\n	#	include snippets/fastcgi-php.conf;\n	#\n	#	# With php-fpm (or other unix sockets):\n	#	fastcgi_pass unix:/run/php/php7.4-fpm.sock;\n	#	# With php-cgi (or other tcp sockets):\n	#	fastcgi_pass 127.0.0.1:9000;\n	#}\n\n	# deny access to .htaccess files, if Apache's document root\n	# concurs with nginx's one\n	#\n	#location ~ /\\.ht {\n	#	deny all;\n	#}\n}\n\n\n# Virtual Host configuration for example.com\n#\n# You can move that to a different file under sites-available/ and symlink that\n# to sites-enabled/ to enable it.\n#\n#server {\n#	listen 80;\n#	listen [::]:80;\n#\n#	server_name example.com;\n#\n#	root /var/www/example.com;\n#	index index.html;\n#\n#	location / {\n#		try_files $uri $uri/ =404;\n#	}\n#}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"configuration-file-overview",children:"Configuration File Overview"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"##\n# You should look at the following URL's in order to grasp a solid understanding\n# of Nginx configuration files in order to fully unleash the power of Nginx.\n# https://www.nginx.com/resources/wiki/start/\n# https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/\n# https://wiki.debian.org/Nginx/DirectoryStructure\n#\n# In most cases, administrators will remove this file from sites-enabled/ and\n# leave it as reference inside of sites-available where it will continue to be\n# updated by the nginx packaging team.\n#\n# This file will automatically load configuration files provided by other\n# applications, such as Drupal or Wordpress.\n#\n# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.\n##\n"})}),"\n",(0,t.jsxs)(n.p,{children:['This section contains the author\'s "comment," providing some learning resources for Nginx configuration and suggesting that administrators keep this file in the ',(0,t.jsx)(n.code,{children:"sites-available/"})," directory as a reference. The actual running configuration should be loaded from the ",(0,t.jsx)(n.code,{children:"sites-enabled/"})," directory."]}),"\n",(0,t.jsx)(n.p,{children:"Since this advice comes from the developers, there is a reason behind it, so let's leave it as is and continue reading."}),"\n",(0,t.jsx)(n.h2,{id:"default-server-configuration",children:"Default Server Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 80 default_server;\n    listen [::]:80 default_server;\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"listen 80 default_server;"})})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The server listens on ",(0,t.jsx)(n.strong,{children:"port 80 (HTTP)"}),' and is set as the "default server". This means that when there is no match for ',(0,t.jsx)(n.code,{children:"server_name"}),", the request will be handled by this block."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"listen [::]:80 default_server;"})})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["This allows ",(0,t.jsx)(n.strong,{children:"IPv6"})," requests to access the server on port 80 as well."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Default Web Root and Homepage Settings"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"	root /var/www/html;\n\n	# Add index.php to the list if you are using PHP\n	index index.html index.htm index.nginx-debian.html;\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"root /var/www/html;"})})}),"\n",(0,t.jsx)(n.li,{children:"Sets the web root directory. All static files (HTML, CSS, JS) for requests will be served from this directory."}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"index index.html index.htm index.nginx-debian.html;"})})}),"\n",(0,t.jsxs)(n.li,{children:["Sets the default homepage files. If ",(0,t.jsx)(n.code,{children:"index.html"})," exists, it will be served first; if not, it will look for ",(0,t.jsx)(n.code,{children:"index.htm"}),". If neither exists, it will handle the request according to the ",(0,t.jsx)(n.code,{children:"location"})," rules."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Server Name Configuration"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"	server_name _;\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"server_name _;"})})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"_"}),' means that "any unmatched requests" will be handled by this server block.']}),"\n",(0,t.jsxs)(n.li,{children:["It can be changed to a specific domain, such as ",(0,t.jsx)(n.code,{children:"server_name example.com;"}),", to make this configuration apply only to ",(0,t.jsx)(n.code,{children:"example.com"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Handling Static Resources and 404 Page"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"	location / {\n		# First attempt to serve request as file, then\n		# as directory, then fall back to displaying a 404.\n		try_files $uri $uri/ =404;\n	}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"location / {}"})})}),"\n",(0,t.jsxs)(n.li,{children:["Defines how requests to ",(0,t.jsx)(n.code,{children:"/"})," (root) are handled."]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"try_files $uri $uri/ =404;"})})}),"\n",(0,t.jsxs)(n.li,{children:["Attempts to:","\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Serve ",(0,t.jsx)(n.code,{children:"$uri"})," (the requested file, such as ",(0,t.jsx)(n.code,{children:"/index.html"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:["If the request is for a directory, it checks if ",(0,t.jsx)(n.code,{children:"index.html"})," exists in that directory (",(0,t.jsx)(n.code,{children:"$uri/"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:["If neither is found, it returns ",(0,t.jsx)(n.strong,{children:"404 Not Found"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"fastcgi-php-handling",children:"FastCGI PHP Handling"}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"Default as Commented Out."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"    # pass PHP scripts to FastCGI server\n    #\n    #location ~ \\.php$ {\n    #    include snippets/fastcgi-php.conf;\n    #\n    #    # With php-fpm (or other unix sockets):\n    #    fastcgi_pass unix:/run/php/php7.4-fpm.sock;\n    #    # With php-cgi (or other tcp sockets):\n    #    fastcgi_pass 127.0.0.1:9000;\n    #}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This section is for ",(0,t.jsx)(n.strong,{children:"FastCGI configuration"}),", allowing Nginx to handle PHP requests and pass them to the PHP-FPM server."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Enable PHP-FPM processing"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Uncomment the ",(0,t.jsx)(n.code,{children:"location ~ \\.php$"})," block."]}),"\n",(0,t.jsxs)(n.li,{children:["Ensure PHP-FPM is running at ",(0,t.jsx)(n.code,{children:"/run/php/php7.4-fpm.sock"})," or ",(0,t.jsx)(n.code,{children:"127.0.0.1:9000"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"restrict-access-to-htaccess",children:["Restrict Access to ",(0,t.jsx)(n.code,{children:".htaccess"})]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"Default as Commented Out."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"    # deny access to .htaccess files, if Apache's document root\n    # concurs with nginx's one\n    #\n    #location ~ /\\.ht {\n    #    deny all;\n    #}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:".htaccess"})," is a configuration file used by Apache, and Nginx ",(0,t.jsxs)(n.strong,{children:["does not support ",(0,t.jsx)(n.code,{children:".htaccess"})]}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["However, if Nginx and Apache coexist, this rule can be used to prevent ",(0,t.jsx)(n.code,{children:".htaccess"})," from being exposed to external access."]}),"\n",(0,t.jsx)(n.h2,{id:"example-virtual-host-configuration",children:"Example Virtual Host Configuration"}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"Default as Commented Out."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"#server {\n#    listen 80;\n#    listen [::]:80;\n#\n#    server_name example.com;\n#\n#    root /var/www/example.com;\n#    index index.html;\n#\n#    location / {\n#        try_files $uri $uri/ =404;\n#    }\n#}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This is an additional example of a virtual host configuration for the ",(0,t.jsx)(n.code,{children:"example.com"})," website."]}),"\n",(0,t.jsxs)(n.p,{children:["You can move this code to ",(0,t.jsx)(n.code,{children:"sites-available/example.com"}),", then create a symbolic link to ",(0,t.jsx)(n.code,{children:"sites-enabled/"})," to enable it."]}),"\n",(0,t.jsx)(n.h2,{id:"how-to-enabledisable-this-configuration",children:"How to Enable/Disable This Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Once the configuration file in ",(0,t.jsx)(n.code,{children:"sites-available"})," is complete, you need to link it to ",(0,t.jsx)(n.code,{children:"sites-enabled"})," for it to take effect."]}),"\n",(0,t.jsxs)(n.p,{children:["For this ",(0,t.jsx)(n.code,{children:"default"})," configuration file, on Ubuntu/Debian systems, use the following command to enable it:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo ln -s /etc/nginx/sites-available/default /etc/nginx/sites-enabled/\n"})}),"\n",(0,t.jsxs)(n.p,{children:["To disable it, first remove the symlink in ",(0,t.jsx)(n.code,{children:"sites-enabled"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo rm /etc/nginx/sites-enabled/default\n"})}),"\n",(0,t.jsx)(n.p,{children:"Then reload Nginx:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo systemctl reload nginx\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.p,{children:["This ",(0,t.jsx)(n.code,{children:"default"})," configuration file is typically used as the ",(0,t.jsx)(n.strong,{children:"default Nginx website"}),", suitable for testing if Nginx is running properly."]}),"\n",(0,t.jsxs)(n.p,{children:['If you want to customize your website, it\'s recommended to "create a new configuration file" and enable the appropriate ',(0,t.jsx)(n.code,{children:"server_name"})," settings."]})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},50065:function(e,n,i){i.d(n,{Z:function(){return o},a:function(){return l}});var s=i(67294);let t={},r=s.createContext(t);function l(e){let n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);