"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[2399],{85452:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>m,frontMatter:()=>t,metadata:()=>l,toc:()=>h});var i=n(74848),a=n(28453);const t={},r="[23.03] FastViT",l={id:"fastvit/index",title:"[23.03] FastViT",description:"Reparameterized ViT Experiments",source:"@site/i18n/en/docusaurus-plugin-content-docs-papers/current/2303-fastvit/index.md",sourceDirName:"2303-fastvit",slug:"/fastvit/",permalink:"/en/papers/fastvit/",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"zephyr-sh",lastUpdatedAt:1723457488e3,frontMatter:{},sidebar:"papersSidebar",previous:{title:"[22.12] QARepVGG",permalink:"/en/papers/qarepvgg/"},next:{title:"[23.05] VanillaNet",permalink:"/en/papers/vanillanet/"}},c={},h=[{value:"Reparameterized ViT Experiments",id:"reparameterized-vit-experiments",level:2},{value:"Problem Definition",id:"problem-definition",level:2},{value:"Solution",id:"solution",level:2},{value:"Model Architecture",id:"model-architecture",level:3},{value:"Model Configurations",id:"model-configurations",level:3},{value:"Training and Evaluation Strategy",id:"training-and-evaluation-strategy",level:3},{value:"Discussion",id:"discussion",level:2},{value:"Performance on ImageNet",id:"performance-on-imagenet",level:3},{value:"Conclusion",id:"conclusion",level:2}];function o(e){const s={a:"a",admonition:"admonition",annotation:"annotation",h1:"h1",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msup:"msup",mtext:"mtext",p:"p",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h1,{id:"2303-fastvit",children:"[23.03] FastViT"}),"\n",(0,i.jsx)(s.h2,{id:"reparameterized-vit-experiments",children:"Reparameterized ViT Experiments"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://arxiv.org/abs/2303.14189",children:(0,i.jsx)(s.strong,{children:"FastViT: A Fast Hybrid Vision Transformer using Structural Reparameterization"})})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.admonition,{type:"info",children:(0,i.jsx)(s.p,{children:"The following content has been compiled by ChatGPT-4, and has been manually verified and supplemented."})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.p,{children:"After the recent introduction of MobileOne, Apple continues to explore more possibilities with model reparameterization. Previously, they tackled the MobileNet architecture; now, it's Vision Transformer's turn."}),"\n",(0,i.jsxs)(s.admonition,{type:"tip",children:[(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Model Reparameterization"}),":"]}),(0,i.jsx)(s.p,{children:"This involves separating the training and inference architectures, converting the original model parameters into new ones. This transformation mathematically equates the training architecture to the inference architecture, enhancing model speed and performance."}),(0,i.jsx)(s.p,{children:"This series of research into model reparameterization gained popularity after the introduction of RepVGG. If this is your first time encountering this concept, we strongly recommend starting with RepVGG to grasp the reparameterization concept. Understanding this will make subsequent papers much easier to comprehend. Otherwise, you might find this content quite perplexing."}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/en/papers/repvgg/",children:(0,i.jsx)(s.strong,{children:"RepVGG: Making VGG Great Again"})})}),"\n"]})]}),"\n",(0,i.jsx)(s.h2,{id:"problem-definition",children:"Problem Definition"}),"\n",(0,i.jsx)(s.p,{children:"Several design directions have been established over the past few years for Transformer models in computer vision."}),"\n",(0,i.jsx)(s.p,{children:"First, we structure multiple layers corresponding to the multi-scale resolution needs of vision tasks. This concept comes from PVT and Swin Transformer:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/en/papers/pvt/",children:(0,i.jsx)(s.strong,{children:"[21.02] PVT: Spatial Reduction Attention Mechanism"})})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://arxiv.org/abs/2103.14030",children:(0,i.jsx)(s.strong,{children:"[21.03] Swin Transformer"})})}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Next, we design a Token Mixer block paired with an FFN block to form a basic module, a concept derived from MetaFormer:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/en/papers/poolformer/",children:(0,i.jsx)(s.strong,{children:"[21.11] PoolFormer: You Need a Meta!"})})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/en/papers/caformer/",children:(0,i.jsx)(s.strong,{children:"[22.10] CaFormer: MetaFormer User Manual"})})}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"After proposing MobileOne, the authors turned their attention to this structural architecture."}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"/en/papers/mobileone/",children:(0,i.jsx)(s.strong,{children:"[22.06] MobileOne: One Millisecond Optimization"})})}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Is there an opportunity to reparameterize the Vision Transformer series of models as well?"}),"\n",(0,i.jsx)(s.h2,{id:"solution",children:"Solution"}),"\n",(0,i.jsx)(s.h3,{id:"model-architecture",children:"Model Architecture"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"FastViT",src:n(63489).A+"",width:"1618",height:"1038"})}),"\n",(0,i.jsx)(s.p,{children:"The FastViT architecture comprises four distinct stages, operating at different scales."}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"RepMixer"})}),"\n",(0,i.jsx)(s.p,{children:"RepMixer is based on the convolutional mixing concept introduced by ConvMixer, with its mixing block defined as follows:"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"Y"}),(0,i.jsx)(s.mo,{children:"="}),(0,i.jsx)(s.mtext,{children:"BN"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mi,{children:"\u03c3"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mtext,{children:"DWConv"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mi,{children:"X"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mo,{children:"+"}),(0,i.jsx)(s.mi,{children:"X"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"Y = \\text{BN}(\\sigma(\\text{DWConv}(X))) + X"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"Y"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(s.span,{className:"mrel",children:"="}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"BN"})}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c3"}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"DWConv"})}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"}),(0,i.jsx)(s.span,{className:"mclose",children:")))"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"+"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"})]})]})]})}),"\n",(0,i.jsxs)(s.p,{children:["Where ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsx)(s.mrow,{children:(0,i.jsx)(s.mi,{children:"\u03c3"})}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\sigma"})]})})}),(0,i.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c3"})]})})]})," represents a non-linear activation function, BN denotes Batch Normalization, and DWConv is a depth-wise convolution layer. FastViT simplifies this by rearranging operations and removing the non-linear function:"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"Y"}),(0,i.jsx)(s.mo,{children:"="}),(0,i.jsx)(s.mtext,{children:"DWConv"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mtext,{children:"BN"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mi,{children:"X"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mo,{children:"+"}),(0,i.jsx)(s.mi,{children:"X"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"Y = \\text{DWConv}(\\text{BN}(X)) + X"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"Y"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(s.span,{className:"mrel",children:"="}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"DWConv"})}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"BN"})}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"}),(0,i.jsx)(s.span,{className:"mclose",children:"))"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"+"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"})]})]})]})}),"\n",(0,i.jsx)(s.p,{children:"This design primarily benefits inference, where it can be reparameterized into a single depth-wise convolution layer:"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"Y"}),(0,i.jsx)(s.mo,{children:"="}),(0,i.jsx)(s.mtext,{children:"DWConv"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mi,{children:"X"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"Y = \\text{DWConv}(X)"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"Y"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(s.span,{className:"mrel",children:"="}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"DWConv"})}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"}),(0,i.jsx)(s.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,i.jsx)(s.p,{children:"This reparameterization significantly reduces memory access costs and computational complexity. Compared to PoolFormer\u2019s PoolMixer, RepMixer offers better inference performance."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"RepMixer",src:n(20723).A+"",width:"1224",height:"604"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Positional Encoding"})}),"\n",(0,i.jsx)(s.p,{children:"FastViT employs conditional positional encoding (referenced below), which dynamically generates encodings based on the local neighborhood of input tokens. These encodings are generated through depth-wise convolutions and added to the patch embedding. Due to the lack of non-linear operations in this process, this block can be effectively reparameterized."}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://arxiv.org/abs/2102.10882",children:(0,i.jsx)(s.strong,{children:"[21.02] Conditional positional encodings for vision transformers"})})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://arxiv.org/abs/2104.13840",children:(0,i.jsx)(s.strong,{children:"[21.04] Twins: Revisiting the design of spatial attention in vision transformers"})})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Depth-wise Separable Convolution"})}),"\n",(0,i.jsxs)(s.p,{children:["Continuing the design philosophy of MobileOne, FastViT replaces dense ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"k"}),(0,i.jsx)(s.mo,{children:"\xd7"}),(0,i.jsx)(s.mi,{children:"k"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"k \\times k"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})]})]})," convolutions with depth-wise separable convolutions, i.e., ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"k"}),(0,i.jsx)(s.mo,{children:"\xd7"}),(0,i.jsx)(s.mi,{children:"k"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"k \\times k"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})]})]})]})," depth-wise convolutions and ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mn,{children:"1"}),(0,i.jsx)(s.mo,{children:"\xd7"}),(0,i.jsx)(s.mn,{children:"1"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"1 \\times 1"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(s.span,{className:"mord",children:"1"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(s.span,{className:"mord",children:"1"})]})]})]})," point-wise convolutions, paired with reparameterized training strategies."]}),"\n",(0,i.jsx)(s.p,{children:"This approach enhances model capacity without significantly increasing training time. For instance, FastViT-SA12 and FastViT-SA36 saw training time increases of only 6.7% and 4.4%, respectively."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Large Kernel Convolution"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Large Kernel Convolution",src:n(49792).A+"",width:"1390",height:"702"})}),"\n",(0,i.jsx)(s.p,{children:"To address the local receptive field limitation of RepMixer compared to self-attention Token Mixers, FastViT integrates depth-wise large kernel convolutions within FFN and patch embedding layers."}),"\n",(0,i.jsx)(s.p,{children:"Experimental results, as shown in the table, indicate that incorporating large kernel convolutions significantly enhances model performance and robustness. This strategy increases the receptive field without significantly adding computational cost."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"model-configurations",children:"Model Configurations"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"FastViT Configurations",src:n(73910).A+"",width:"888",height:"1080"})}),"\n",(0,i.jsx)(s.p,{children:"FastViT offers various configurations to meet different computational demands and application scenarios, as shown in the table above. These configurations vary in embedding dimensions, MLP expansion ratios, and the types of modules included."}),"\n",(0,i.jsx)(s.p,{children:"Detailed specifics are as follows:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Models with smaller embedding dimensions, such as [64, 128, 256, 512], are prefixed with \u201cS\u201d."}),"\n",(0,i.jsx)(s.li,{children:"Models including self-attention (Self-Attention) layers are prefixed with \u201cSA\u201d."}),"\n",(0,i.jsx)(s.li,{children:"Models with larger embedding dimensions, such as [76, 152, 304, 608], are prefixed with \u201cM\u201d."}),"\n",(0,i.jsx)(s.li,{children:"Models with MLP expansion ratios less than 4 are prefixed with \u201cT\u201d."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"The numbers in the table represent the total number of FastViT modules, with FLOP counts calculated using the fvcore library."}),"\n",(0,i.jsx)(s.h3,{id:"training-and-evaluation-strategy",children:"Training and Evaluation Strategy"}),"\n",(0,i.jsx)(s.p,{children:"The authors conducted experiments using the ImageNet-1K dataset, which includes approximately 1.3 million training images and 50,000 validation images."}),"\n",(0,i.jsx)(s.p,{children:"The training methodology for this model is as follows:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Optimizer"}),": AdamW"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Training epochs"}),": 300"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Weight decay"}),": 0.05"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Peak learning rate"}),": ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mn,{children:"1"}),(0,i.jsxs)(s.msup,{children:[(0,i.jsx)(s.mn,{children:"0"}),(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mo,{children:"\u2212"}),(0,i.jsx)(s.mn,{children:"3"})]})]})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"10^{-3}"})]})})}),(0,i.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.8141em"}}),(0,i.jsx)(s.span,{className:"mord",children:"1"}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord",children:"0"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsx)(s.span,{className:"vlist-t",children:(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.8141em"},children:(0,i.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(s.span,{className:"mord mtight",children:[(0,i.jsx)(s.span,{className:"mord mtight",children:"\u2212"}),(0,i.jsx)(s.span,{className:"mord mtight",children:"3"})]})})]})})})})})]})]})})]})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Total batch size"}),": 1024"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Warm-up epochs"}),": 5"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Learning rate decay"}),": Cosine annealing strategy"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Implementation tool"}),": timm library"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Training hardware"}),": 8 NVIDIA A100 GPUs"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"For input sizes of 384\xd7384, a fine-tuning of 30 epochs was performed, with specific settings as follows:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Weight decay"}),": ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mn,{children:"1"}),(0,i.jsxs)(s.msup,{children:[(0,i.jsx)(s.mn,{children:"0"}),(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mo,{children:"\u2212"}),(0,i.jsx)(s.mn,{children:"8"})]})]})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"10^{-8}"})]})})}),(0,i.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.8141em"}}),(0,i.jsx)(s.span,{className:"mord",children:"1"}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord",children:"0"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsx)(s.span,{className:"vlist-t",children:(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.8141em"},children:(0,i.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(s.span,{className:"mord mtight",children:[(0,i.jsx)(s.span,{className:"mord mtight",children:"\u2212"}),(0,i.jsx)(s.span,{className:"mord mtight",children:"8"})]})})]})})})})})]})]})})]})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Learning rate"}),": ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mn,{children:"5"}),(0,i.jsx)(s.mo,{children:"\xd7"}),(0,i.jsx)(s.mn,{children:"1"}),(0,i.jsxs)(s.msup,{children:[(0,i.jsx)(s.mn,{children:"0"}),(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mo,{children:"\u2212"}),(0,i.jsx)(s.mn,{children:"5"})]})]})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"5 \\times 10^{-5}"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(s.span,{className:"mord",children:"5"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.8141em"}}),(0,i.jsx)(s.span,{className:"mord",children:"1"}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord",children:"0"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsx)(s.span,{className:"vlist-t",children:(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.8141em"},children:(0,i.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(s.span,{className:"mord mtight",children:[(0,i.jsx)(s.span,{className:"mord mtight",children:"\u2212"}),(0,i.jsx)(s.span,{className:"mord mtight",children:"5"})]})})]})})})})})]})]})]})]})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Batch size"}),": 512"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"The authors compared FastViT with other state-of-the-art models on the ImageNet-1K dataset. For fair comparison, they modified the official implementation of ConvNeXt to avoid expensive reshape operations. Additionally, due to poor support for deformable convolutions in the two libraries, LITv2 could not be reliably derived in this paper."}),"\n",(0,i.jsx)(s.h2,{id:"discussion",children:"Discussion"}),"\n",(0,i.jsx)(s.h3,{id:"performance-on-imagenet",children:"Performance on ImageNet"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"FastViT Performance",src:n(5373).A+"",width:"1030",height:"2506"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"ImageNet Performance",src:n(95474).A+"",width:"1654",height:"658"})}),"\n",(0,i.jsx)(s.p,{children:"The complete comparison results are shown in the tables above:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"FastViT-MA36"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Achieved a Top-1 accuracy of 84.9%"}),"\n",(0,i.jsx)(s.li,{children:"49.3% smaller than LITv2-B"}),"\n",(0,i.jsx)(s.li,{children:"Consumes 55.4% fewer FLOPs"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"FastViT-S12"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"26.3% faster than MobileOne-S4 on iPhone 12 Pro"}),"\n",(0,i.jsx)(s.li,{children:"26.9% faster on GPU"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"FastViT-MA36"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Top-1 accuracy of 83.9%"}),"\n",(0,i.jsx)(s.li,{children:"1.9 times faster than the optimized ConvNeXt-B model on iPhone 12 Pro"}),"\n",(0,i.jsx)(s.li,{children:"2.0 times faster on GPU"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"FastViT-MA36"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Top-1 accuracy of 84.9%"}),"\n",(0,i.jsx)(s.li,{children:"As fast as NFNet-F1 on GPU"}),"\n",(0,i.jsx)(s.li,{children:"66.7% smaller"}),"\n",(0,i.jsx)(s.li,{children:"Uses 50.1% fewer FLOPs"}),"\n",(0,i.jsx)(s.li,{children:"42.8% faster on mobile devices"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.admonition,{type:"tip",children:(0,i.jsx)(s.p,{children:"These results are based on experiments conducted on an iPhone 12. Subsequent research found that FastViT's inference speed was not as expected on most devices. This may be due to certain FastViT operators not being optimized for acceleration on other devices. Therefore, we recommend selecting FastViT based on specific application scenarios and device characteristics."})}),"\n",(0,i.jsx)(s.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,i.jsx)(s.p,{children:"FastViT achieves a balance of high performance and low latency through structural reparameterization and other improvements, demonstrating robust performance across various application scenarios."}),"\n",(0,i.jsxs)(s.admonition,{type:"tip",children:[(0,i.jsx)(s.p,{children:"This paper does not compare results with CAFormer. In our own comparisons, CAFormer outperforms FastViT in terms of performance with the same computational cost."}),(0,i.jsx)(s.p,{children:"For example:"}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"CAFormer-S18, MACs 4.1G; FastViT-SA24, MACs 3.8G."}),"\n",(0,i.jsx)(s.li,{children:"CAFormer-S18 has a Top-1 accuracy of 83.6%, while FastViT-SA24 has a Top-1 accuracy of 82.6%."}),"\n"]}),(0,i.jsx)(s.p,{children:"However, CAFormer does not involve reparameterization, so it can be expected to be much slower. Additionally, the smallest model in CAFormer is still quite large and unsuitable for deployment on mobile devices. FastViT has an advantage in this aspect, with the smallest model having approximately 3.6M parameters."})]})]})}function m(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},63489:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/img1-665eb734bfa9e991fbb9b8afaabea142.jpg"},73910:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/img2-bb88e4833bcb1378b9f47470e569e134.jpg"},20723:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/img3-bfca3978f19e1ee8570b2bbdde08f471.jpg"},49792:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/img4-f25f4f37771902349c92cbd771599d29.jpg"},5373:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/img5-97b430d79446787ad3def5fa8ce9bb4d.jpg"},95474:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/img6-81b470299ef7158466f1aebf501a1c79.jpg"},28453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>l});var i=n(96540);const a={},t=i.createContext(a);function r(e){const s=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);