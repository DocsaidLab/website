"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[8069],{39600:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var i=t(74848),s=t(28453);const r={sidebar_position:5},a="MRZGenerator",o={id:"wordcanvas/mrz_gen",title:"MRZGenerator",description:"This feature was added in version 0.5.0.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/wordcanvas/mrz_gen.md",sourceDirName:"wordcanvas",slug:"/wordcanvas/mrz_gen",permalink:"/en/docs/wordcanvas/mrz_gen",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"zephyr-sh",lastUpdatedAt:1723017424e3,sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Augmentation",permalink:"/en/docs/wordcanvas/imgaug"},next:{title:"BarcodeGenerator",permalink:"/en/docs/wordcanvas/barcode_gen"}},c={},d=[{value:"What is MRZ?",id:"what-is-mrz",level:2},{value:"Synthetic Images",id:"synthetic-images",level:2},{value:"Displaying Coordinates of Each Character",id:"displaying-coordinates-of-each-character",level:2},{value:"Changing Text and Background Colors",id:"changing-text-and-background-colors",level:2},{value:"Specifying MRZ Text",id:"specifying-mrz-text",level:2},{value:"Further Reading",id:"further-reading",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"mrzgenerator",children:"MRZGenerator"})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"This feature was added in version 0.5.0."})}),"\n",(0,i.jsxs)(n.p,{children:["After developing ",(0,i.jsx)(n.code,{children:"WordCanvas"}),", we can use this tool for various tasks."]}),"\n",(0,i.jsx)(n.p,{children:'In this section, we will develop a feature to generate "Machine Readable Zone (MRZ)" images.'}),"\n",(0,i.jsx)(n.h2,{id:"what-is-mrz",children:"What is MRZ?"}),"\n",(0,i.jsx)(n.p,{children:"MRZ (Machine Readable Zone) refers to a specific area on travel documents such as passports, visas, and ID cards. Information in this area can be quickly read by machines. MRZ is designed and generated according to the specifications of the International Civil Aviation Organization (ICAO) Document 9303 to expedite border checks and improve data processing accuracy."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.icao.int/publications/Documents/9303_p1_cons_en.pdf",children:(0,i.jsx)(n.strong,{children:"ICAO Doc9309"})})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The structure of MRZ varies depending on the type of document and includes the following types:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"TD1 (ID cards, etc.):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consists of three lines, each with 30 characters, totaling 90 characters."}),"\n",(0,i.jsx)(n.li,{children:"Includes information such as document type, country code, document number, date of birth, sex, expiration date, nationality, surname, given names, optional data 1, and optional data 2."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"TD2 (passport cards, etc.):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consists of two lines, each with 36 characters, totaling 72 characters."}),"\n",(0,i.jsx)(n.li,{children:"Includes information such as document type, country code, surname, given names, document number, nationality, date of birth, sex, expiration date, and optional data."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"TD3 (passports, etc.):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consists of two lines, each with 44 characters, totaling 88 characters."}),"\n",(0,i.jsx)(n.li,{children:"Includes information such as document type, country code, surname, given names, document number, nationality, date of birth, sex, expiration date, and optional data."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"MRVA (Visa Type A):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consists of two lines, each with 44 characters, totaling 88 characters."}),"\n",(0,i.jsx)(n.li,{children:"Includes information such as document type, country code, surname, given names, document number, nationality, date of birth, sex, expiration date, and optional data."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"MRVB (Visa Type B):"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consists of two lines, each with 36 characters, totaling 72 characters."}),"\n",(0,i.jsx)(n.li,{children:"Includes information such as document type, country code, surname, given names, document number, nationality, date of birth, sex, expiration date, and optional data."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"synthetic-images",children:"Synthetic Images"}),"\n",(0,i.jsxs)(n.p,{children:["When training an MRZ detection model, a large dataset is needed, but such data typically contains personal information, making it difficult to collect. To solve this problem, we can use ",(0,i.jsx)(n.code,{children:"WordCanvas"})," to generate synthetic MRZ images."]}),"\n",(0,i.jsxs)(n.p,{children:["The relevant functionality is already implemented. Refer to the following example to invoke ",(0,i.jsx)(n.code,{children:"MRZGenerator"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import docsaidkit as D\nfrom wordcanvas import MRZGenerator\n\nmrz_gen = MRZGenerator(\n    text_color=(0, 0, 0),\n    background_color=(255, 255, 255),\n    interval=None,\n    delimiter='&',\n)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In this setup, you can manually specify the text color, background color, and delimiter. Since MRZ text spans 2-3 lines, the delimiter helps distinguish between each line when outputting text. The default delimiter is ",(0,i.jsx)(n.code,{children:"&"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["After setting up, you can call it as a function, as the ",(0,i.jsx)(n.code,{children:"__call__"})," method is already implemented:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"output_infos = mrz_gen()\n"})}),"\n",(0,i.jsx)(n.p,{children:"This generates a synthetic MRZ image with the following output format:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"typ"}),": MRZ type."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"text"}),": MRZ text."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"points"}),": Coordinates of each character in the MRZ."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"image"}),": MRZ image."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"If no parameters are given during output, the MRZ type (TD1, TD2, TD3) is chosen randomly. The MRZ text is generated randomly, and the image is synthesized."}),"\n",(0,i.jsx)(n.p,{children:"Example output image:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"D.imwrite(output_infos['image'])\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mrz_output",src:t(14792).A+"",width:"1152",height:"157"})}),"\n",(0,i.jsx)(n.h2,{id:"displaying-coordinates-of-each-character",children:"Displaying Coordinates of Each Character"}),"\n",(0,i.jsxs)(n.p,{children:["If you are interested in the position of each character, which can help in training text detection models, you can use the ",(0,i.jsx)(n.code,{children:"points"})," attribute to get this information. Let's draw a picture to visualize it:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import cv2\nimport docsaidkit as D\nfrom wordcanvas import MRZGenerator\n\ndef draw_points(img, points, color=(0, 255, 0), radius=5):\n    for point in points:\n        cv2.circle(img, point, radius, color, -1)\n    return img\n\nmrz_gen = MRZGenerator(\n    text_color=(0, 0, 0),\n    background_color=(255, 255, 255),\n    interval=None,\n    delimiter='&',\n)\n\noutput_infos = mrz_gen()\n\nimg = draw_points(results['image'], results['points'])\nD.imwrite(img)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mrz_points",src:t(7826).A+"",width:"1690",height:"118"})}),"\n",(0,i.jsx)(n.h2,{id:"changing-text-and-background-colors",children:"Changing Text and Background Colors"}),"\n",(0,i.jsxs)(n.p,{children:["You can change the text and background colors using the ",(0,i.jsx)(n.code,{children:"text_color"})," and ",(0,i.jsx)(n.code,{children:"background_color"})," parameters:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"mrz_gen = MRZGenerator(\n    text_color=(255, 0, 0),\n    background_color=(0, 127, 127),\n)\n\noutput_infos = mrz_gen()\nD.imwrite(output_infos['image'])\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mrz_color",src:t(30722).A+"",width:"1152",height:"179"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["Adjust the spacing between characters using the ",(0,i.jsx)(n.code,{children:"interval"})," parameter:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"mrz_gen = MRZGenerator(\n    interval=100,\n)\n\noutput_infos = mrz_gen()\nD.imwrite(output_infos['image'])\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mrz_interval",src:t(67151).A+"",width:"1152",height:"341"})}),"\n",(0,i.jsx)(n.h2,{id:"specifying-mrz-text",children:"Specifying MRZ Text"}),"\n",(0,i.jsxs)(n.p,{children:["If you want to specify MRZ text, you can pass the ",(0,i.jsx)(n.code,{children:"mrz_type"})," and ",(0,i.jsx)(n.code,{children:"mrz_text"})," parameters when calling the function. We perform basic checks, such as verifying text length and type match."]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"Please note, we do not perform hash checks; this feature is intended for image synthesis, not for generating valid MRZ text."})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'mrz_gen = MRZGenerator(interval=32)\n\noutput_infos = mrz_gen(\n    mrz_type=\'TD1\',\n    mrz_text=[\n        "I<SWE59000002<8198703142391<<<",\n        "8703145M1701027SWE<<<<<<<<<<<8",\n        "SPECIMEN<<SVEN<<<<<<<<<<<<<<<<"\n    ]\n)\n\nD.imwrite(output_infos[\'image\'])\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mrz_assign_text",src:t(52276).A+"",width:"1152",height:"201"})}),"\n",(0,i.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/Arg0s1080/mrz",children:(0,i.jsx)(n.strong,{children:"Arg0s1080/mrz"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://pyimagesearch.com/2015/11/30/detecting-machine-readable-zones-in-passport-images/",children:(0,i.jsx)(n.strong,{children:"Detecting machine-readable zones in passport images"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/DoubangoTelecom/ultimateMRZ-SDK",children:(0,i.jsx)(n.strong,{children:"ultimateMRZ-SDK"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/Mattijah/QKMRZScanner",children:(0,i.jsx)(n.strong,{children:"QKMRZScanner"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/evermeer/PassportScanner",children:(0,i.jsx)(n.strong,{children:"PassportScanner"})})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},52276:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/mrz_assign_text-8e58148d9b5157da8b030e458ee70b16.jpg"},30722:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/mrz_color-6f5a1a4b8429844ad9ddc12bb7ad9f3c.jpg"},67151:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/mrz_interval-ed4898716ff48901e42080bf85c6ecc8.jpg"},14792:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/mrz_output-b77fd307822b623c5c5d47a9ea56d136.jpg"},7826:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/mrz_points-b4717274ea5a0b088a74ec98ed53c775.jpg"},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(96540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);