"use strict";(self.webpackChunkdocsaid_website=self.webpackChunkdocsaid_website||[]).push([["6903"],{89730:function(e,n,t){t.r(n),t.d(n,{assets:function(){return c},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return i},toc:function(){return a}});var i=t(60501),r=t(85893),o=t(50065);let s={slug:"mac-selective-vpn-routing",title:"Setting Up Selective Traffic Routing for VPN on Mac",authors:"Zephyr",tags:["routing-vpn","macos"],image:"/en/img/2023/0901.webp",description:"Configuring VPN routing on Mac."},l=void 0,c={authorsImageUrls:[void 0]},a=[{value:"Configuration Guide",id:"configuration-guide",level:2},{value:"Problem Overview",id:"problem-overview",level:2},{value:"Solving the Problem",id:"solving-the-problem",level:2},{value:"Step 1: Identify Your Company\u2019s Internal Network Range",id:"step-1-identify-your-companys-internal-network-range",level:3},{value:"Still Not Working?",id:"still-not-working",level:2},{value:"References",id:"references",level:2}];function h(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"When working remotely with a company VPN setup, sometimes you still need access to local devices and resources on your home network."}),"\n",(0,r.jsx)(n.h2,{id:"configuration-guide",children:"Configuration Guide"}),"\n",(0,r.jsx)(n.p,{children:"We\u2019ll use Mac as the operating system for this setup."}),"\n",(0,r.jsx)(n.h2,{id:"problem-overview",children:"Problem Overview"}),"\n",(0,r.jsx)(n.p,{children:"For example:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Company VPN network range: 192.168.25.XXX"}),"\n",(0,r.jsx)(n.li,{children:"Home network range: 192.168.1.XXX"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"When the VPN is active, all traffic is routed through the company's network, preventing access to devices on your home network within the same domain."}),"\n",(0,r.jsx)(n.p,{children:"In other words, even if you're at home streaming a funny video, the company's network admin might inadvertently catch a glimpse too. Something doesn\u2019t feel quite right about this, does it?"}),"\n",(0,r.jsxs)(n.p,{children:["Our goal here is to ",(0,r.jsx)(n.strong,{children:"route only the traffic meant for the company network through the VPN, while all other traffic stays on the local network."})]}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsx)(n.p,{children:"This guide assumes that your VPN is already configured and functioning correctly. Here, we\u2019ll only address the selective routing issue."}),(0,r.jsx)(n.p,{children:"If the VPN isn\u2019t working, please ensure your VPN settings are correct before proceeding."})]}),"\n",(0,r.jsx)(n.h2,{id:"solving-the-problem",children:"Solving the Problem"}),"\n",(0,r.jsx)(n.h3,{id:"step-1-identify-your-companys-internal-network-range",children:"Step 1: Identify Your Company\u2019s Internal Network Range"}),"\n",(0,r.jsx)(n.p,{children:"First, identify the network range for your company, for example:"}),"\n",(0,r.jsx)(n.p,{children:"192.168.25.XXX"}),"\n",(0,r.jsx)(n.p,{children:"Next, let\u2019s open a system file to configure routing rules:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo vim /etc/ppp/ip-up\n"})}),"\n",(0,r.jsx)(n.p,{children:"Add the following content, replacing the network range with your company\u2019s network range:"}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"Note: This example assumes the VPN network range is 192.168.25.XXX. Modify according to your actual network setup."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"#!/bin/sh\n/sbin/route add -net 192.168.25.0/24 -interface ppp0\n"})}),"\n",(0,r.jsx)(n.p,{children:"Let\u2019s break down what this command does:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"/sbin/route"}),": This is the path to the ",(0,r.jsx)(n.code,{children:"route"})," command, which is used for configuring and displaying routing tables."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"-net 192.168.25.0/24"}),": This specifies that the route is a network route, not a host route. ",(0,r.jsx)(n.code,{children:"192.168.25.0/24"})," represents the range of IP addresses from ",(0,r.jsx)(n.code,{children:"192.168.25.0"})," to ",(0,r.jsx)(n.code,{children:"192.168.25.255"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"-interface ppp0"}),": This specifies the network interface for the route, in this case, ",(0,r.jsx)(n.code,{children:"ppp0"})," (point-to-point protocol interface 0)."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This command effectively adds a route through the ",(0,r.jsx)(n.code,{children:"ppp0"})," interface for the ",(0,r.jsx)(n.code,{children:"192.168.25.0/24"})," network range. When your system tries to access any IP address within this range, it will route the traffic through the ",(0,r.jsx)(n.code,{children:"ppp0"})," interface."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"After editing the file, save and exit, then give it the necessary permissions:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo chmod 755 /etc/ppp/ip-up\n"})}),"\n",(0,r.jsx)(n.h2,{id:"still-not-working",children:"Still Not Working?"}),"\n",(0,r.jsx)(n.p,{children:"At this point, some devices might still have trouble accessing the internet, so let\u2019s try adjusting the network service order in macOS."}),"\n",(0,r.jsx)(n.p,{children:"Open macOS\u2019s System Preferences, and go to Network:"}),"\n",(0,r.jsx)("figure",{style:{width:"80%"},children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"vpn-setting",src:t(96718).Z+"",width:"2048",height:"1699"})})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Step 1: Open System Preferences, and select \u201CNetwork\u201D"}),"\n",(0,r.jsx)(n.li,{children:"Step 2: Click the small options button (three dots)"}),"\n",(0,r.jsx)(n.li,{children:"Step 3: Select \u201CSet Service Order\u201D"}),"\n",(0,r.jsx)(n.li,{children:"Step 4: Drag the VPN service below Wi-Fi in the order"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"Many people set the VPN at the top of the network service order, prioritizing all traffic through the VPN. Here, we\u2019re lowering the VPN service order so that our custom network configuration can take effect."}),"\n",(0,r.jsxs)(n.p,{children:["That\u2019s it! To route additional traffic through the VPN in the future, simply add the specific addresses in the ",(0,r.jsx)(n.code,{children:"ip-up"})," file."]}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://gist.github.com/shalyf/d50b0bbf30a4b5020d2b84f4ae8eb4e0",children:"shalyf/vpn_route.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://superuser.com/questions/4904/how-to-selectively-route-network-traffic-through-vpn-on-mac-os-x-leopard",children:"How to selectively route network traffic through VPN on Mac OS X Leopard?"})}),"\n"]})]})}function d(e={}){let{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},96718:function(e,n,t){t.d(n,{Z:function(){return i}});let i=t.p+"assets/images/vpn-setting-bd7c48703bedfb577a1954606aad8726.jpg"},50065:function(e,n,t){t.d(n,{Z:function(){return l},a:function(){return s}});var i=t(67294);let r={},o=i.createContext(r);function s(e){let n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:n},e.children)}},60501:function(e){e.exports=JSON.parse('{"permalink":"/en/blog/mac-selective-vpn-routing","source":"@site/i18n/en/docusaurus-plugin-content-blog/2023/09-01-mac-selective-vpn-routing/index.md","title":"Setting Up Selective Traffic Routing for VPN on Mac","description":"Configuring VPN routing on Mac.","date":"2023-09-01T00:00:00.000Z","tags":[{"inline":true,"label":"routing-vpn","permalink":"/en/blog/tags/routing-vpn"},{"inline":true,"label":"macos","permalink":"/en/blog/tags/macos"}],"readingTime":2.66,"hasTruncateMarker":true,"authors":[{"name":"Zephyr","title":"Engineer","url":"https://github.com/zephyr-sh","imageURL":"https://github.com/zephyr-sh.png","key":"Zephyr","page":null}],"frontMatter":{"slug":"mac-selective-vpn-routing","title":"Setting Up Selective Traffic Routing for VPN on Mac","authors":"Zephyr","tags":["routing-vpn","macos"],"image":"/en/img/2023/0901.webp","description":"Configuring VPN routing on Mac."},"unlisted":false,"prevItem":{"title":"Unicode Table","permalink":"/en/blog/unicode-table"}}')}}]);