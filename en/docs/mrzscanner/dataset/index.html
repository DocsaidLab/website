<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-mrzscanner/dataset" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>Dataset | DOCSAID</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://docsaid.org/en/img/docsaid-social-card.jpg><meta data-rh=true name=twitter:image content=https://docsaid.org/en/img/docsaid-social-card.jpg><meta data-rh=true property=og:url content=https://docsaid.org/en/docs/mrzscanner/dataset><meta data-rh=true property=og:locale content=en><meta data-rh=true property=og:locale:alternate content=zh_hant><meta data-rh=true property=og:locale:alternate content=ja><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Dataset | DOCSAID"><meta data-rh=true name=description content="Since MRZ images are mostly found in personal documents, we couldn’t find enough real training data."><meta data-rh=true property=og:description content="Since MRZ images are mostly found in personal documents, we couldn’t find enough real training data."><link data-rh=true rel=icon href=/en/img/favicon.ico><link data-rh=true rel=canonical href=https://docsaid.org/en/docs/mrzscanner/dataset><link data-rh=true rel=alternate href=https://docsaid.org/docs/mrzscanner/dataset hreflang=zh-hant><link data-rh=true rel=alternate href=https://docsaid.org/en/docs/mrzscanner/dataset hreflang=en><link data-rh=true rel=alternate href=https://docsaid.org/ja/docs/mrzscanner/dataset hreflang=ja><link data-rh=true rel=alternate href=https://docsaid.org/docs/mrzscanner/dataset hreflang=x-default><link data-rh=true rel=preconnect href=https://S9NC0RYCHF-dsn.algolia.net crossorigin=anonymous><link rel=alternate type=application/rss+xml href=/en/blog/rss.xml title="DOCSAID RSS Feed"><link rel=alternate type=application/atom+xml href=/en/blog/atom.xml title="DOCSAID Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-RDF83L9R4M"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RDF83L9R4M",{anonymize_ip:!0})</script><link rel=search type=application/opensearchdescription+xml title=DOCSAID href=/en/opensearch.xml><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css type=text/css integrity=sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM crossorigin=anonymous><link rel=stylesheet href=/en/assets/css/styles.82d5a8e0.css><script src=/en/assets/js/runtime~main.dc6e4f1f.js defer></script><script src=/en/assets/js/main.81c64958.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/en/img/docsaid_logo.png><link rel=preload as=image href=/en/img/docsaid_logo_white.png><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top navbarHideable_jvwV"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/en/><div class=navbar__logo><img src=/en/img/docsaid_logo.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/en/img/docsaid_logo_white.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/en/docs/>Projects</a><a class="navbar__item navbar__link" href=/en/papers/intro>Papers</a><a class="navbar__item navbar__link" href=/en/blog>Blog</a><a class="navbar__item navbar__link" href=/en/playground/intro>Playground</a><a class="navbar__item navbar__link" href=/en/services>Services</a><a class="navbar__item navbar__link" href=/en/aboutus>About Us</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>English</a><ul class=dropdown__menu><li><a href=/docs/mrzscanner/dataset target=_self rel="noopener noreferrer" class=dropdown__link lang=zh-hant>繁體中文</a><li><a href=/en/docs/mrzscanner/dataset target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=en>English</a><li><a href=/ja/docs/mrzscanner/dataset target=_self rel="noopener noreferrer" class=dropdown__link lang=ja>日本語</a></ul></div><div class=navbarSearchContainer_dCNk><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div><button type=button class="ant-btn css-7ny38l ant-btn-circle ant-btn-default ant-btn-color-default ant-btn-variant-outlined ant-btn-icon-only"><span class=ant-btn-icon><span role=img aria-label=user style=font-size:18px class="anticon anticon-user"><svg viewBox="64 64 896 896" focusable=false data-icon=user width=1em height=1em fill=currentColor aria-hidden=true><path d="M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"/></svg></span></span></button></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_eExm"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/en/><img src=/en/img/docsaid_logo.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/en/img/docsaid_logo_white.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b></b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/en/docs/>Open Source Projects</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/model-training-guide/>Model Training Guide</a><button aria-label="Expand sidebar category 'Model Training Guide'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/autotraderx/>AutoTraderX</a><button aria-label="Expand sidebar category 'AutoTraderX'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/capybara/>Capybara</a><button aria-label="Expand sidebar category 'Capybara'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/docaligner/>DocAligner</a><button aria-label="Expand sidebar category 'DocAligner'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/docclassifier/>DocClassifier</a><button aria-label="Expand sidebar category 'DocClassifier'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/gmailsummary/>GmailSummary</a><button aria-label="Expand sidebar category 'GmailSummary'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/en/docs/mrzscanner/>MRZScanner</a><button aria-label="Collapse sidebar category 'MRZScanner'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/mrzscanner/intro>Introduction</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/mrzscanner/installation>Installation</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/mrzscanner/quickstart>Quick Start</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/mrzscanner/advance>Advanced Settings</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/mrzscanner/model_arch>Model Design</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/mrzscanner/benchmark>Evaluation</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/en/docs/mrzscanner/dataset>Dataset</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/mrzscanner/summit_data>Submission</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/mrzscanner/reference>References</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/nginx-notes/>Nginx Notes</a><button aria-label="Expand sidebar category 'Nginx Notes'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/wordcanvas/>WordCanvas</a><button aria-label="Expand sidebar category 'WordCanvas'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/en/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/en/docs/mrzscanner/><span itemprop=name>MRZScanner</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Dataset</span><meta itemprop=position content=2></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Dataset</h1></header>
<p>Since MRZ images are mostly found in personal documents, we couldn’t find enough real training data.</p>
<p>From the start, we decided not to use real data but rather to rely entirely on <strong>synthetic datasets</strong>. We developed our own synthetic dataset generator, which can create various MRZ formats, and allows control over text content, fonts, sizes, colors, and more.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=training-dataset>Training Dataset<a href=#training-dataset class=hash-link aria-label="Direct link to Training Dataset" title="Direct link to Training Dataset">​</a></h2>
<p>Although we do not release our training module, we have made our custom synthetic dataset available on GitHub:</p>
<ul>
<li><a href=https://github.com/DocsaidLab/MRZScanner/blob/main/dataset/train_dataset.py target=_blank rel="noopener noreferrer"><strong>MRZScanner/dataset/train_dataset.py</strong></a></li>
</ul>
<p>Before you can start using it, there are a few things you’ll need to handle on your own:</p>
<ol>
<li>
<p>Download the dataset: <a href=https://www.kaggle.com/datasets/itsahmad/indoor-scenes-cvpr-2019 target=_blank rel="noopener noreferrer"><strong>MIT Indoor Scenes</strong></a></p>
<p>We used this dataset for background images. After downloading, place it somewhere accessible and point the path to this folder when running the data generator.</p>
</li>
</ol>
<hr>
<ol start=2>
<li>
<p>Download the dataset: <a href=https://www.docvqa.org/ target=_blank rel="noopener noreferrer"><strong>DocVQA</strong></a></p>
<p>Since documents with MRZ typically contain other text, simulating the presence of such unrelated text can be beneficial for model training.</p>
<p>Similarly, after downloading, place it somewhere accessible and point the path to this folder when running the data generator.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_BuS1><p><strong>Note</strong>: Make sure both datasets are in the same directory, as we only provide a single path parameter for specifying the location.</div></div>
</li>
</ol>
<hr>
<ol start=3>
<li>
<p>Install the module: <a href=https://github.com/DocsaidLab/WordCanvas target=_blank rel="noopener noreferrer"><strong>WordCanvas Github</strong></a></p>
<p>The synthetic dataset relies on our other module, <code>WordCanvas</code>. Please install the relevant packages first.</p>
<ul>
<li><a href=/en/docs/wordcanvas/intro><strong>WordCanvas Docs</strong></a></li>
</ul>
<p><img decoding=async loading=lazy alt=wordcanvas src=/en/assets/images/title-e8bde3a5bccc9557aa4d3d532089a363.jpg width=1226 height=702 class=img_ev3q></p>
<figure style=width:80%><p><img decoding=async loading=lazy alt=wordcanvas src=/en/assets/images/title-e8bde3a5bccc9557aa4d3d532089a363.jpg width=1226 height=702 class=img_ev3q></figure>
</li>
</ol>
<hr>
<p>Once these steps are completed, you can start generating the dataset.</p>
<p>Here’s how to use it:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> cv2</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> train_dataset </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> MRZDataset</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">ds </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> MRZDataset</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    root</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'/data/Dataset'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic># Change to your dataset path</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    image_size</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>512</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>512</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    aug_ratio</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    return_tensor</span><span class="token operator" style=color:#393A34>=</span><span class="token boolean" style=color:#36acaa>True</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic># Converts the output to a PyTorch Tensor</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    length_of_dataset</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1000000</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic># Specify the size of the dataset</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The training dataset returns multiple values, so let’s go through them:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">img</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> gt</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> poly</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> fixed_points</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> mrz_points_hmap</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> mrz_region_hmap </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ds</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_BuS1><p>Although we specified <code>idx=0</code>, the <code>MRZDataset</code> generates data randomly, so the result will be different each time.</div></div>
<hr>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=1-img>1. img<a href=#1-img class=hash-link aria-label="Direct link to 1. img" title="Direct link to 1. img">​</a></h3>
<p>First is <code>img</code>, which we can display directly:</p>
<figure align=center><p><img decoding=async loading=lazy alt=img src=/en/assets/images/mrz_img-0d23c6304bf6fdf65dfb1262ed101038.jpg width=512 height=512 class=img_ev3q></figure>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=2-gt>2. gt<a href=#2-gt class=hash-link aria-label="Direct link to 2. gt" title="Direct link to 2. gt">​</a></h3>
<p>The raw <code>gt</code> is a string, which can be split using the <code>split</code> function.</p>
<p>By default, the MRZ is separated by <code>&</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>print</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'GT original:'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> gt</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># >>> GT original: 9SZ563DNUUM1NEAKVHUI09MK4H9SAW&56QI04IS244AF4F0809416QQQ9MDOA&DS0CJGRAALNCT1NKPYGH5DPLAOY72L</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>print</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'GT:'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> gt</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">split</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'&'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># >>> GT: ['9SZ563DNUUM1NEAKVHUI09MK4H9SAW',</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>#          '56QI04IS244AF4F0809416QQQ9MDOA',</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>#          'DS0CJGRAALNCT1NKPYGH5DPLAOY72L']</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>If you are training a text recognition model, this string will serve as your label.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=3-poly>3. poly<a href=#3-poly class=hash-link aria-label="Direct link to 3. poly" title="Direct link to 3. poly">​</a></h3>
<p><code>poly</code> contains the four points of the MRZ area. We can plot it as follows:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> capybara </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> cb</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">poly_img </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> cb</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">draw_polygon</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">img</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">copy</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> poly</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> color</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>255</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cb</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">imwrite</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">poly_img</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'poly.jpg'</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<figure align=center><p><img decoding=async loading=lazy alt=poly src=/en/assets/images/poly-7cfa658cb79583e4e5d6c17b158e1512.jpg width=512 height=512 class=img_ev3q></figure>
<p>If you’re working on a region localization model, you can use these four points as your labels.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=4-fixed_points>4. fixed_points<a href=#4-fixed_points class=hash-link aria-label="Direct link to 4. fixed_points" title="Direct link to 4. fixed_points">​</a></h3>
<p>The dataset generator outputs three types of MRZ formats: TD1, TD2, and TD3. Since these formats have different character lengths, we need <code>fixed_points</code> to ensure the output length is consistent, otherwise PyTorch would throw an error.</p>
<p>These points represent the center of each character, with TD1 having a fixed output string length of 90.</p>
<p>We can plot the points like this:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> capybara </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> cb</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">point_img </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> img</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">copy</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> p </span><span class="token keyword" style=color:#00009f>in</span><span class="token plain"> fixed_points</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> p</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>and</span><span class="token plain"> p</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>break</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    cv2</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">circle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">point_img</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token builtin">int</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">p</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">p</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>255</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cb</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">imwrite</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">point_img</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'points.jpg'</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<figure align=center><p><img decoding=async loading=lazy alt=points src=/en/assets/images/points-a286cfa1177273642322ade38e146892.jpg width=512 height=512 class=img_ev3q></figure>
<p>If you're working on precise character point localization, you can use these points as your labels.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=5-mrz_points_hmap>5. mrz_points_hmap<a href=#5-mrz_points_hmap class=hash-link aria-label="Direct link to 5. mrz_points_hmap" title="Direct link to 5. mrz_points_hmap">​</a></h3>
<p><code>mrz_points_hmap</code> is the heatmap of the MRZ "character center points":</p>
<figure align=center><p><img decoding=async loading=lazy alt=mrz_points_hmap src=/en/assets/images/mrz_points_hmap-41cd506eaae586d0504e61dcb8b70057.jpg width=512 height=512 class=img_ev3q></figure>
<p>This image can be used for supervision if you’re using keypoint detection methods.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=6-mrz_region_hmap>6. mrz_region_hmap<a href=#6-mrz_region_hmap class=hash-link aria-label="Direct link to 6. mrz_region_hmap" title="Direct link to 6. mrz_region_hmap">​</a></h3>
<p><code>mrz_region_hmap</code> is a binary image representing the MRZ text area. This is quite intuitive, so let’s display it directly:</p>
<figure align=center><p><img decoding=async loading=lazy alt=mrz_region_hmap src=data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAIBAQEBAQIBAQECAgICAgQDAgICAgUEBAMEBgUGBgYFBgYGBwkIBgcJBwYGCAsICQoKCgoKBggLDAsKDAkKCgr/2wBDAQICAgICAgUDAwUKBwYHCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgr/wAARCAIAAgADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD+f+iiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKK+v/8AglJ/wRU/an/4LB/8J7/wzR4++H+h/wDCu/7L/tv/AITrVb628/7f9r8nyPstnc7sfYpd27ZjcmN2TtAPkCiv1+/4gqf+Cpv/AEXz9n//AMKnXP8A5T0f8QVP/BU3/ovn7P8A/wCFTrn/AMp6APyBor9fv+IKn/gqb/0Xz9n/AP8ACp1z/wCU9H/EFT/wVN/6L5+z/wD+FTrn/wAp6APyBor9fv8AiCp/4Km/9F8/Z/8A/Cp1z/5T0f8AEFT/AMFTf+i+fs//APhU65/8p6APyBor9fv+IKn/AIKm/wDRfP2f/wDwqdc/+U9H/EFT/wAFTf8Aovn7P/8A4VOuf/KegD8gaK/X7/iCp/4Km/8ARfP2f/8Awqdc/wDlPR/xBU/8FTf+i+fs/wD/AIVOuf8AynoA/IGiv1+/4gqf+Cpv/RfP2f8A/wAKnXP/AJT0f8QVP/BU3/ovn7P/AP4VOuf/ACnoA/IGiv1+/wCIKn/gqb/0Xz9n/wD8KnXP/lPR/wAQVP8AwVN/6L5+z/8A+FTrn/ynoA/IGiv1+/4gqf8Agqb/ANF8/Z//APCp1z/5T0f8QVP/AAVN/wCi+fs//wDhU65/8p6APyBor9fv+IKn/gqb/wBF8/Z//wDCp1z/AOU9H/EFT/wVN/6L5+z/AP8AhU65/wDKegD8gaK/X7/iCp/4Km/9F8/Z/wD/AAqdc/8AlPR/xBU/8FTf+i+fs/8A/hU65/8AKegD8gaK/X7/AIgqf+Cpv/RfP2f/APwqdc/+U9H/ABBU/wDBU3/ovn7P/wD4VOuf/KegD8gaK/X7/iCp/wCCpv8A0Xz9n/8A8KnXP/lPR/xBU/8ABU3/AKL5+z//AOFTrn/ynoA/IGiv1+/4gqf+Cpv/AEXz9n//AMKnXP8A5T0f8QVP/BU3/ovn7P8A/wCFTrn/AMp6APyBor9fv+IKn/gqb/0Xz9n/AP8ACp1z/wCU9H/EFT/wVN/6L5+z/wD+FTrn/wAp6APyBor9fv8AiCp/4Km/9F8/Z/8A/Cp1z/5T0f8AEFT/AMFTf+i+fs//APhU65/8p6APyBor9fv+IKn/AIKm/wDRfP2f/wDwqdc/+U9H/EFT/wAFTf8Aovn7P/8A4VOuf/KegD8gaK/X7/iCp/4Km/8ARfP2f/8Awqdc/wDlPR/xBU/8FTf+i+fs/wD/AIVOuf8AynoA/IGiv1+/4gqf+Cpv/RfP2f8A/wAKnXP/AJT0f8QVP/BU3/ovn7P/AP4VOuf/ACnoA/IGiv1+/wCIKn/gqb/0Xz9n/wD8KnXP/lPR/wAQVP8AwVN/6L5+z/8A+FTrn/ynoA/IGiv1+/4gqf8Agqb/ANF8/Z//APCp1z/5T0f8QVP/AAVN/wCi+fs//wDhU65/8p6APyBor9fv+IKn/gqb/wBF8/Z//wDCp1z/AOU9H/EFT/wVN/6L5+z/AP8AhU65/wDKegD8gaK/X7/iCp/4Km/9F8/Z/wD/AAqdc/8AlPR/xBU/8FTf+i+fs/8A/hU65/8AKegD8gaK/X7/AIgqf+Cpv/RfP2f/APwqdc/+U9H/ABBU/wDBU3/ovn7P/wD4VOuf/KegD8gaK/X7/iCp/wCCpv8A0Xz9n/8A8KnXP/lPR/xBU/8ABU3/AKL5+z//AOFTrn/ynoA/IGiv1+/4gqf+Cpv/AEXz9n//AMKnXP8A5T0f8QVP/BU3/ovn7P8A/wCFTrn/AMp6APyBor6//wCCrf8AwRU/an/4I+f8IF/w0v4++H+uf8LE/tT+xP8AhBdVvrnyPsH2TzvP+1Wdttz9ti27d+dr524G75AoAKKKKACiiigAooooAKKKKACiiigAr9/v+DGP/m6L/uSf/c/X4A1+/wB/wYx/83Rf9yT/AO5+gD9/qKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAPwB/wCD5z/m13/udv8A3AV+ANfv9/wfOf8ANrv/AHO3/uAr8AaACiiigAooooAKKKKACiiigAooooAK/f7/AIMY/wDm6L/uSf8A3P1+ANfv9/wYx/8AN0X/AHJP/ufoA/f6iiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD8Af+D5z/m13/udv/cBX4A1+/wB/wfOf82u/9zt/7gK/AGgAooooAKKKKACiiigAooooAKKKKACv3+/4MY/+bov+5J/9z9fgDX7/AH/BjH/zdF/3JP8A7n6AP3+ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/AH/AIPnP+bXf+52/wDcBX4A1+/3/B85/wA2u/8Ac7f+4CvwBoAKKKKACiiigAooooAKKKKACiiigAr9/v8Agxj/AObov+5J/wDc/X4A1+33/Bmt+1j+yx+y/wD8NHf8NL/tLfD/AOHf9uf8Ih/Yn/CdeMrHSP7Q8n+2/O8j7VLH5vl+bFu252+amcbhkA/o+orwD/h7F/wSy/6SWfs//wDh5ND/APkqj/h7F/wSy/6SWfs//wDh5ND/APkqgD3+ivAP+HsX/BLL/pJZ+z//AOHk0P8A+SqP+HsX/BLL/pJZ+z//AOHk0P8A+SqAPf6K8A/4exf8Esv+kln7P/8A4eTQ/wD5Ko/4exf8Esv+kln7P/8A4eTQ/wD5KoA9/orwD/h7F/wSy/6SWfs//wDh5ND/APkqj/h7F/wSy/6SWfs//wDh5ND/APkqgD3+ivAP+HsX/BLL/pJZ+z//AOHk0P8A+SqP+HsX/BLL/pJZ+z//AOHk0P8A+SqAPf6K8A/4exf8Esv+kln7P/8A4eTQ/wD5Ko/4exf8Esv+kln7P/8A4eTQ/wD5KoA9/orwD/h7F/wSy/6SWfs//wDh5ND/APkqj/h7F/wSy/6SWfs//wDh5ND/APkqgD3+ivAP+HsX/BLL/pJZ+z//AOHk0P8A+SqP+HsX/BLL/pJZ+z//AOHk0P8A+SqAPf6K8A/4exf8Esv+kln7P/8A4eTQ/wD5Ko/4exf8Esv+kln7P/8A4eTQ/wD5KoA9/orwD/h7F/wSy/6SWfs//wDh5ND/APkqj/h7F/wSy/6SWfs//wDh5ND/APkqgD3+ivAP+HsX/BLL/pJZ+z//AOHk0P8A+SqP+HsX/BLL/pJZ+z//AOHk0P8A+SqAPf6K8A/4exf8Esv+kln7P/8A4eTQ/wD5Ko/4exf8Esv+kln7P/8A4eTQ/wD5KoA9/orwD/h7F/wSy/6SWfs//wDh5ND/APkqj/h7F/wSy/6SWfs//wDh5ND/APkqgD3+ivAP+HsX/BLL/pJZ+z//AOHk0P8A+SqP+HsX/BLL/pJZ+z//AOHk0P8A+SqAPf6K8A/4exf8Esv+kln7P/8A4eTQ/wD5Ko/4exf8Esv+kln7P/8A4eTQ/wD5KoA9/orwD/h7F/wSy/6SWfs//wDh5ND/APkqj/h7F/wSy/6SWfs//wDh5ND/APkqgD3+ivAP+HsX/BLL/pJZ+z//AOHk0P8A+SqP+HsX/BLL/pJZ+z//AOHk0P8A+SqAPf6K8A/4exf8Esv+kln7P/8A4eTQ/wD5Ko/4exf8Esv+kln7P/8A4eTQ/wD5KoA9/orwD/h7F/wSy/6SWfs//wDh5ND/APkqj/h7F/wSy/6SWfs//wDh5ND/APkqgD3+ivAP+HsX/BLL/pJZ+z//AOHk0P8A+SqP+HsX/BLL/pJZ+z//AOHk0P8A+SqAPf6K8A/4exf8Esv+kln7P/8A4eTQ/wD5Ko/4exf8Esv+kln7P/8A4eTQ/wD5KoA9/orwD/h7F/wSy/6SWfs//wDh5ND/APkqj/h7F/wSy/6SWfs//wDh5ND/APkqgD3+ivAP+HsX/BLL/pJZ+z//AOHk0P8A+SqP+HsX/BLL/pJZ+z//AOHk0P8A+SqAPf6K8A/4exf8Esv+kln7P/8A4eTQ/wD5Ko/4exf8Esv+kln7P/8A4eTQ/wD5KoA9/orwD/h7F/wSy/6SWfs//wDh5ND/APkqj/h7F/wSy/6SWfs//wDh5ND/APkqgD8gP+D5z/m13/udv/cBX4A1+33/AAeU/tY/ssftQf8ADOP/AAzR+0t8P/iJ/Yf/AAl/9t/8IL4ysdX/ALP87+xPJ8/7LLJ5XmeVLt3Y3eU+M7Tj8QaACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP//Z width=512 height=512 class=img_ev3q></figure>
<p>If you’re developing a segmentation model, this image can be used for supervision.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=summary>Summary<a href=#summary class=hash-link aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h3>
<p>These are all the components of this dataset. You can swap the background base dataset for something else, such as ImageNet, or replace the text noise part with another dataset like DocVQA.</p>
<hr>
<p>Training with a synthetic dataset may result in poor generalization because the real-world scenarios differ significantly from synthetic ones.</p>
<p>From our experiments, using a synthetic dataset for training achieves about <strong>97% ANLS</strong> and <strong>30% ACC</strong> on our real-world validation set.</p>
<p>This means the model can detect 97% of the text in the MRZ area, but since each MRZ block contains at least 72 characters, it is considered "correct" only if all the characters are correct.</p>
<p>Achieving 100% accuracy is very challenging.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_BuS1><p>The validation data we prepared was pre-processed with the <code>DocAligner</code> module to correct angles, ensuring that each MRZ area’s tilt is within 5 degrees.<p>Even with such well-prepared data, the accuracy is only around 30%, which highlights the limitations of using synthetic datasets alone.</div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=fine-tuning-dataset>Fine-Tuning Dataset<a href=#fine-tuning-dataset class=hash-link aria-label="Direct link to Fine-Tuning Dataset" title="Direct link to Fine-Tuning Dataset">​</a></h2>
<p>We used the MIDV-2020 dataset, which also contains synthetic MRZ images. Although the text content is relatively simple, the images are well-made, making it a good dataset for fine-tuning our model.</p>
<p>We implemented the following code to extract MRZ-containing images from the dataset:</p>
<ul>
<li><a href=https://github.com/DocsaidLab/MRZScanner/blob/main/dataset/finetune_dataset.py target=_blank rel="noopener noreferrer"><strong>MRZScanner/dataset/finetune_dataset.py</strong></a></li>
</ul>
<p>Before you can start using it, you’ll need to:</p>
<ol>
<li>
<p>Download the <strong>MIDV-2020</strong> dataset: <a href=http://l3i-share.univ-lr.fr/MIDV2020/midv2020.html target=_blank rel="noopener noreferrer"><strong>MIDV-2020</strong></a></p>
<p>You need to download it; otherwise, you won’t have any data to use. After downloading, place it somewhere accessible and point the path to this folder when running the data generator.</p>
</li>
</ol>
<hr>
<p>Once these steps are completed, you can start generating the dataset.</p>
<p>Here’s how to use it:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> finetune_dataset </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> MRZFinetuneDataset</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">ds </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> MRZFinetuneDataset</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    root</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'/data/Dataset'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic># Change to your dataset path</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    image_size</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>512</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>512</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    aug_ratio</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    return_tensor</span><span class="token operator" style=color:#393A34>=</span><span class="token boolean" style=color:#36acaa>True</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic># Converts the output to a PyTorch Tensor</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The fine-tuning dataset returns fewer values, so let’s check them out:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">img</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> gt </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ds</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>That’s it! Here we only have the image and the label, no other information.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_BuS1><p>This is why our final training model only uses text supervision without auxiliary branches:<p>Most fine-tuning datasets only contain text and lack additional information.</div></div>
<hr>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=1-img-1>1. img<a href=#1-img-1 class=hash-link aria-label="Direct link to 1. img" title="Direct link to 1. img">​</a></h3>
<p>Although there’s not much to say, here’s what the image looks like:</p>
<figure align=center><p><img decoding=async loading=lazy alt=img src=/en/assets/images/finetune_mrz_img-7f89d4da090733df48c93861fcfeb054.jpg width=512 height=512 class=img_ev3q></figure>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=2-gt-1>2. gt<a href=#2-gt-1 class=hash-link aria-label="Direct link to 2. gt" title="Direct link to 2. gt">​</a></h3>
<p>The raw <code>gt</code> is a string, which we can display directly:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>print</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'GT:'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> gt</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># >>> GT: PCAZEABDULLAYEV&lt;&lt;DIL&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;C193895647AZE9408148M28081525188L2V&lt;&lt;&lt;&lt;&lt;&lt;&lt;42</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>print</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'GT:'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> gt</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">split</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'&'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># >>> GT: ['PCAZEABDULLAYEV&lt;&lt;DIL&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;',</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>#          'C193895647AZE9408148M28081525188L2V&lt;&lt;&lt;&lt;&lt;&lt;&lt;42']</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=training-strategy>Training Strategy<a href=#training-strategy class=hash-link aria-label="Direct link to Training Strategy" title="Direct link to Training Strategy">​</a></h2>
<p>After discussing the datasets, let’s talk about our training strategy.</p>
<p>We pre-trained the model using the synthetic dataset with the following parameters:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">ds </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> MRZDataset</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    root</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'/data/Dataset'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    image_size</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>512</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>512</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    aug_ratio</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    return_tensor</span><span class="token operator" style=color:#393A34>=</span><span class="token boolean" style=color:#36acaa>True</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    length_of_dataset</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>640000</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>We trained for 100 epochs, using the AdamW optimizer with a weight decay of 1e-5 and a learning rate of 1e-4, combined with a linear decay schedule. The learning rate first ramps up over 10 epochs, then decreases linearly.</p>
<p>After pre-training, we fine-tuned the model using the fine-tuning dataset with the following parameters:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">ds </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> MRZFinetuneDataset</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    root</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>'/data/Dataset'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    image_size</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>512</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>512</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    aug_ratio</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    return_tensor</span><span class="token operator" style=color:#393A34>=</span><span class="token boolean" style=color:#36acaa>True</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>For fine-tuning, we used the AdamW optimizer with a weight decay of 1e-1 and a learning rate of 1e-6.</p>
<p>We stopped training when validation performance plateaued.</p>
<hr>
<p>Weight Decay’s setting here may seem a bit strange, going against the mainstream method, but we can explain:</p>
<ol>
<li>
<p>During the training phase, the synthetic data’s patterns are complex, making recognition difficult. Combined with a relatively small model, we can’t set the Weight Decay too high, as the diversified data itself has a regularizing effect.</p>
</li>
<li>
<p>During the fine-tuning phase, the data patterns are limited to a few images, so we need stronger regularization to avoid overfitting.</p>
</li>
</ol>
<p>We have verified both of these points through experiments.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=conclusion>Conclusion<a href=#conclusion class=hash-link aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>That’s our dataset! We hope it can be of help to you.</p>
<p>If you have additional datasets for fine-tuning, feel free to share them with us. We’ll integrate them into our dataset so others can benefit as well.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated>Last updated<!-- --> on <b><time datetime=2025-01-02T09:59:53.000Z itemprop=dateModified>Jan 2, 2025</time></b> by <b>zephyr-sh</b></span></div></div><div style=margin-top:3rem> </div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/en/docs/mrzscanner/benchmark><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Evaluation</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/en/docs/mrzscanner/summit_data><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Submission</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#training-dataset class="table-of-contents__link toc-highlight">Training Dataset</a><ul><li><a href=#1-img class="table-of-contents__link toc-highlight">1. img</a><li><a href=#2-gt class="table-of-contents__link toc-highlight">2. gt</a><li><a href=#3-poly class="table-of-contents__link toc-highlight">3. poly</a><li><a href=#4-fixed_points class="table-of-contents__link toc-highlight">4. fixed_points</a><li><a href=#5-mrz_points_hmap class="table-of-contents__link toc-highlight">5. mrz_points_hmap</a><li><a href=#6-mrz_region_hmap class="table-of-contents__link toc-highlight">6. mrz_region_hmap</a><li><a href=#summary class="table-of-contents__link toc-highlight">Summary</a></ul><li><a href=#fine-tuning-dataset class="table-of-contents__link toc-highlight">Fine-Tuning Dataset</a><ul><li><a href=#1-img-1 class="table-of-contents__link toc-highlight">1. img</a><li><a href=#2-gt-1 class="table-of-contents__link toc-highlight">2. gt</a></ul><li><a href=#training-strategy class="table-of-contents__link toc-highlight">Training Strategy</a><li><a href=#conclusion class="table-of-contents__link toc-highlight">Conclusion</a></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class=footer__links><a class=footer__link-item href=/en/docs>Projects</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/papers/intro>Papers</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/blog>Blog</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/terms-of-service>TermsOfUse</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/privacy-policy>Privacy Policy</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/become-an-author>Become an author</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/worklog>Worklog</a></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2024 DOCSAID.</div></div></div></footer></div>