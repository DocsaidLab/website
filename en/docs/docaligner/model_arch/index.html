<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docaligner/model_arch" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>Model Design | DOCSAID</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://docsaid.org/en/img/docsaid-social-card.jpg><meta data-rh=true name=twitter:image content=https://docsaid.org/en/img/docsaid-social-card.jpg><meta data-rh=true property=og:url content=https://docsaid.org/en/docs/docaligner/model_arch><meta data-rh=true property=og:locale content=en><meta data-rh=true property=og:locale:alternate content=zh_hant><meta data-rh=true property=og:locale:alternate content=ja><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Model Design | DOCSAID"><meta data-rh=true name=description content="Referencing past research, we first considered a point regression model."><meta data-rh=true property=og:description content="Referencing past research, we first considered a point regression model."><link data-rh=true rel=icon href=/en/img/favicon.ico><link data-rh=true rel=canonical href=https://docsaid.org/en/docs/docaligner/model_arch><link data-rh=true rel=alternate href=https://docsaid.org/docs/docaligner/model_arch hreflang=zh-hant><link data-rh=true rel=alternate href=https://docsaid.org/en/docs/docaligner/model_arch hreflang=en><link data-rh=true rel=alternate href=https://docsaid.org/ja/docs/docaligner/model_arch hreflang=ja><link data-rh=true rel=alternate href=https://docsaid.org/docs/docaligner/model_arch hreflang=x-default><link data-rh=true rel=preconnect href=https://S9NC0RYCHF-dsn.algolia.net crossorigin=anonymous><link rel=alternate type=application/rss+xml href=/en/blog/rss.xml title="DOCSAID RSS Feed"><link rel=alternate type=application/atom+xml href=/en/blog/atom.xml title="DOCSAID Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-RDF83L9R4M"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RDF83L9R4M",{anonymize_ip:!0})</script><link rel=search type=application/opensearchdescription+xml title=DOCSAID href=/en/opensearch.xml><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css type=text/css integrity=sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM crossorigin=anonymous><link rel=stylesheet href=/en/assets/css/styles.14d14ca4.css><script src=/en/assets/js/runtime~main.17903a86.js defer></script><script src=/en/assets/js/main.d65cd861.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/en/img/docsaid_logo.png><link rel=preload as=image href=/en/img/docsaid_logo_white.png><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top navbarHideable_jvwV"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/en/><div class=navbar__logo><img src=/en/img/docsaid_logo.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/en/img/docsaid_logo_white.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/en/docs/>Projects</a><a class="navbar__item navbar__link" href=/en/papers/intro>Papers</a><a class="navbar__item navbar__link" href=/en/blog>Blog</a><a class="navbar__item navbar__link" href=/en/playground/intro>Playground</a><a class="navbar__item navbar__link" href=/en/services>Services</a><a class="navbar__item navbar__link" href=/en/aboutus>About Us</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>English</a><ul class=dropdown__menu><li><a href=/docs/docaligner/model_arch target=_self rel="noopener noreferrer" class=dropdown__link lang=zh-hant>繁體中文</a><li><a href=/en/docs/docaligner/model_arch target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=en>English</a><li><a href=/ja/docs/docaligner/model_arch target=_self rel="noopener noreferrer" class=dropdown__link lang=ja>日本語</a></ul></div><div class=navbarSearchContainer_dCNk><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div><button type=button class="ant-btn css-7ny38l ant-btn-circle ant-btn-default ant-btn-color-default ant-btn-variant-outlined ant-btn-icon-only"><span class=ant-btn-icon><span role=img aria-label=user style=font-size:18px class="anticon anticon-user"><svg viewBox="64 64 896 896" focusable=false data-icon=user width=1em height=1em fill=currentColor aria-hidden=true><path d="M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"/></svg></span></span></button></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_eExm"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/en/><img src=/en/img/docsaid_logo.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/en/img/docsaid_logo_white.png alt="Docsaid Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b></b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/en/docs/>Open Source Projects</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/model-training-guide/>Model Training Guide</a><button aria-label="Expand sidebar category 'Model Training Guide'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/autotraderx/>AutoTraderX</a><button aria-label="Expand sidebar category 'AutoTraderX'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/capybara/>Capybara</a><button aria-label="Expand sidebar category 'Capybara'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/en/docs/docaligner/>DocAligner</a><button aria-label="Collapse sidebar category 'DocAligner'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/docaligner/intro>Introduction</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/docaligner/installation>Installation</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/docaligner/quickstart>Quick Start</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/docaligner/advance>Advanced</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/en/docs/docaligner/model_arch>Model Design</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/docaligner/benchmark>Evaluation</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/docaligner/discussion>Discussion</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/docaligner/dataset>Dataset</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/docaligner/summit_data>Submission</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/docaligner/reference>References</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/docclassifier/>DocClassifier</a><button aria-label="Expand sidebar category 'DocClassifier'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/gmailsummary/>GmailSummary</a><button aria-label="Expand sidebar category 'GmailSummary'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/mrzscanner/>MRZScanner</a><button aria-label="Expand sidebar category 'MRZScanner'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/nginx-notes/>Nginx Notes</a><button aria-label="Expand sidebar category 'Nginx Notes'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/wordcanvas/>WordCanvas</a><button aria-label="Expand sidebar category 'WordCanvas'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/en/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/en/docs/docaligner/><span itemprop=name>DocAligner</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Model Design</span><meta itemprop=position content=2></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Model Design</h1></header>
<p>Referencing past research, we first considered a point regression model.</p>
<p>If you're interested in the details of previous research, please refer to: <a href=/en/docs/docaligner/reference><strong>References</strong></a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=point-regression-model>Point Regression Model<a href=#point-regression-model class=hash-link aria-label="Direct link to Point Regression Model" title="Direct link to Point Regression Model">​</a></h2>
<p><img decoding=async loading=lazy alt=arch_1.jpg src=/en/assets/images/point_model_arch-cb2afeedf5c66ea527d29726f64e2f03.jpg width=4574 height=3254 class=img_ev3q></p>
<p>The point regression model was our initial version, structured into four main components:</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=1-feature-extraction>1. Feature Extraction<a href=#1-feature-extraction class=hash-link aria-label="Direct link to 1. Feature Extraction" title="Direct link to 1. Feature Extraction">​</a></h3>
<p><img decoding=async loading=lazy alt=pp-lcnet.jpg src=/en/assets/images/lcnet_arch-89fd4d95f589dbbd8ca1edc5b4486391.jpg width=1224 height=736 class=img_ev3q></p>
<p>This part primarily transforms images into vectors. Here, we utilize <a href=https://arxiv.org/abs/2109.15099 target=_blank rel="noopener noreferrer"><strong>PP-LCNet</strong></a> as the feature extractor.</p>
<p>The input image is a 128 x 128 RGB image, and after feature extraction, it outputs a 256-dimensional vector.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_BuS1><p><strong>Why do you always prefer LCNet?</strong><p>We often need to deploy the model on mobile devices. LCNet is exceptionally lightweight, suitable for running on smartphones. Additionally, when we need to quantize the model, LCNet usually doesn't encounter issues with unsupported operations.</div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=2-cross-attention>2. Cross-Attention<a href=#2-cross-attention class=hash-link aria-label="Direct link to 2. Cross-Attention" title="Direct link to 2. Cross-Attention">​</a></h3>
<p>In this model, the Neck part enhances the features from the Backbone.</p>
<p>Here, we employ Cross-Attention, a mechanism commonly used in Transformers, which captures relationships between different features and applies them to enhance the features. We expect Cross-Attention to help the model understand spatial relationships between different points in images, thus improving prediction accuracy. Apart from Cross-Attention, we also use positional encodings, aiding the model in understanding the spatial positions of points in images, thereby enhancing prediction accuracy.</p>
<p>Given the nature of point regression, which heavily relies on precise pixel localization, especially on low-level features, we sequentially query from deep features to shallow features (1/32 -> 1/16 -> 1/8 -> 1/4 -> 1/2). This design allows the model to locate documents' positions across different scales effectively. We believe this querying approach can significantly enhance the model's accuracy.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=3-point-regression>3. Point Regression<a href=#3-point-regression class=hash-link aria-label="Direct link to 3. Point Regression" title="Direct link to 3. Point Regression">​</a></h3>
<p>In the design of our prediction head, we utilize a simple linear layer, converting features into point coordinates. We aim for the model to rely more on the expressive power of Cross-Attention features rather than complex head structures.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=4-smooth-l1-loss>4. Smooth L1 Loss<a href=#4-smooth-l1-loss class=hash-link aria-label="Direct link to 4. Smooth L1 Loss" title="Direct link to 4. Smooth L1 Loss">​</a></h3>
<p>In our model, we opt for Smooth L1 Loss as the loss function, commonly used in regression tasks, particularly suitable for handling outliers.</p>
<p>Compared to L1 Loss, Smooth L1 Loss is more robust when the difference between predicted and true values is large, reducing the impact of outliers on model training. Additionally, to mitigate amplification errors in point regression, we "boost the weights of point predictions to 1000". Through our experiments, this design effectively enhances model accuracy.</p>
<p>Besides corner loss, we also employ other losses, including:</p>
<ul>
<li>Classification Loss: Used for classifying whether a document exists in an image, employing BCE Loss.</li>
</ul>
<p>Please note that this classification loss is not merely auxiliary but one of the main losses. Due to the constraints of corner point prediction, the model may still predict corners even when there's no target object. Therefore, in the deployment phase, we need a classification head to inform us whether an object exists.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=catastrophic-failure>Catastrophic Failure<a href=#catastrophic-failure class=hash-link aria-label="Direct link to Catastrophic Failure" title="Direct link to Catastrophic Failure">​</a></h2>
<p>In the architecture of the "Point Regression Model," we encountered a severe issue of "<strong>amplification error</strong>".</p>
<p>The root of this problem lies in the process of training the model, where we need to downscale the original images to 128 x 128 or 256 x 256. This downsizing leads to the loss of detailed information in the original images, causing the model to inaccurately locate document corners during prediction.</p>
<p><strong>To be precise, the model finds corners based on downscaled images.</strong></p>
<p>Then, we must upscale these corners to the original image size to find the precise positions of document corners. This upscaling process introduces an offset of approximately 5 to 10 pixels, leading to inaccuracies in predicting document positions.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_BuS1><p>You can imagine: in the original image, a region of about 10 pixels around the target corner will be reduced to 1 pixel during prediction. Then, the model makes predictions, resulting in corner positions offset during upscaling.</div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=approaches-by-others>Approaches by Others<a href=#approaches-by-others class=hash-link aria-label="Direct link to Approaches by Others" title="Direct link to Approaches by Others">​</a></h2>
<p>Upon encountering this issue, we consciously sought how others resolved it.</p>
<p>Later, we found in many papers within the field of Document Localization, the solution is:</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=predicting-on-large-images>Predicting on Large Images<a href=#predicting-on-large-images class=hash-link aria-label="Direct link to Predicting on Large Images" title="Direct link to Predicting on Large Images">​</a></h3>
<p>This approach ensures that the model accurately finds document corners during prediction.</p>
<p>However, it's slow, very slow.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=introducing-anchors-and-offsets>Introducing Anchors and Offsets<a href=#introducing-anchors-and-offsets class=hash-link aria-label="Direct link to Introducing Anchors and Offsets" title="Direct link to Introducing Anchors and Offsets">​</a></h3>
<p>The Anchor-Based approach can be borrowed from the object detection domain. We would need some prior knowledge to define anchor sizes. However, since documents can appear in images with arbitrary angles and deformations, the design of anchors would limit the model's detection ability within a certain range.</p>
<p>Basically, you can rewrite the pros and cons of the anchor architecture you know here.</p>
<p>In the real world, the aspect ratios of documents are too arbitrary, making anchor design unsuitable.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=directly-fitting-evaluation-dataset>Directly Fitting Evaluation Dataset<a href=#directly-fitting-evaluation-dataset class=hash-link aria-label="Direct link to Directly Fitting Evaluation Dataset" title="Direct link to Directly Fitting Evaluation Dataset">​</a></h3>
<p>In earlier papers, the logic seems more like designing an algorithm directly for SmartDoc 2015 rather than creating a universal model.</p>
<p>In recent years' papers, SmartDoc 2015 is typically split into training and testing sets. Through this approach, improvements in scores for SmartDoc 2015 are achieved.</p>
<p>So, you may see many architecture scores in benchmarks that seem decent, but in practical applications, they lack sufficient generalization.</p>
<hr>
<p>We found that researchers in this field don't have a unified view on how to solve this problem.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=heatmap-regression-model>Heatmap Regression Model<a href=#heatmap-regression-model class=hash-link aria-label="Direct link to Heatmap Regression Model" title="Direct link to Heatmap Regression Model">​</a></h2>
<p><img decoding=async loading=lazy alt=arch_2.jpg src=/en/assets/images/hmap_model_arch-5a3b42fd4d54769ec6f331952327e323.jpg width=3277 height=1929 class=img_ev3q></p>
<p>This model architecture retains the original feature extractor but modifies the Neck and Head sections.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=1-feature-extraction-1>1. Feature Extraction<a href=#1-feature-extraction-1 class=hash-link aria-label="Direct link to 1. Feature Extraction" title="Direct link to 1. Feature Extraction">​</a></h3>
<p>Apart from using LCNet for mobile-friendly models, we also employ a larger model to extract more features. Because we aim to develop a model that surpasses SoTA, LCNet alone isn't sufficient.</p>
<p>In this model, we attempt using lightweight convolutional neural networks like FastViT, MobileNetV2, etc., especially suitable for efficient feature extraction in resource-constrained environments. We expect the Backbone to extract sufficient feature information from input data to prepare for subsequent heatmap regression.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=2-bifpn>2. BiFPN<a href=#2-bifpn class=hash-link aria-label="Direct link to 2. BiFPN" title="Direct link to 2. BiFPN">​</a></h3>
<p>To better integrate multi-scale features, we introduce BiFPN (Bidirectional Feature Pyramid Network), which enhances feature representation through bidirectional flow of contextual information. We anticipate BiFPN to produce a series of scale-rich and semantically strong feature maps, highly effective in capturing objects at different scales and positively impacting final prediction accuracy.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=3-heatmap-regression>3. Heatmap Regression<a href=#3-heatmap-regression class=hash-link aria-label="Direct link to 3. Heatmap Regression" title="Direct link to 3. Heatmap Regression">​</a></h3>
<p><img decoding=async loading=lazy alt=awing_loss.jpg src=/en/assets/images/awing_loss-f4531a7f843e26f0085e9962144a905d.jpg width=1224 height=912 class=img_ev3q></p>
<p>To address the aforementioned amplification error, we need a certain "fuzziness" in the predicted results. Meaning, we shouldn't let the model precisely pinpoint where the document corners are but rather make the model say, "<strong>The document corners are approximately in this area</strong>".</p>
<p>For this, we adopted a method commonly used in face keypoint detection or human pose estimation: <strong>heatmap regression</strong>.</p>
<p>Heatmap regression generates a heatmap representation of objects, reflecting the likelihood of objects appearing at different positions. By analyzing these heatmaps, the model can accurately predict the position and pose of objects. In our context, heatmaps are used to find document corners.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=4-adaptive-wing-loss>4. Adaptive Wing Loss<a href=#4-adaptive-wing-loss class=hash-link aria-label="Direct link to 4. Adaptive Wing Loss" title="Direct link to 4. Adaptive Wing Loss">​</a></h3>
<p>Loss is crucial in model training, responsible for calculating the difference between model predictions and ground truth labels.</p>
<p>In this model, we use Adaptive Wing Loss, a loss function specifically for face keypoint detection. This method innovates upon loss functions in heatmap regression, particularly suitable for face alignment problems. Its core idea is to adjust the shape of the loss function based on different types of true heatmap pixels, applying more penalty to foreground pixels (pixels near facial keypoints) and less penalty to background pixels.</p>
<p>Here, we treat the document corner prediction problem as a face keypoint detection problem and use a loss function specialized for face keypoint detection in heatmap regression. We believe this approach can effectively address issues in document corner detection and perform well in various scenarios.</p>
<ul>
<li><strong>Reference:</strong> <a href=https://arxiv.org/abs/1904.07399 target=_blank rel="noopener noreferrer"><strong>Adaptive Wing Loss for Robust Face Alignment via Heatmap Regression</strong></a></li>
</ul>
<p>Apart from corner loss, we also use multiple auxiliary losses, including:</p>
<ul>
<li><strong>Edge Loss:</strong> Here, we simultaneously supervise object boundary information, using AWing Loss.</li>
<li><strong>Classification Loss:</strong> Here, used for predicting whether a document exists in the image, employing BCE Loss.</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=resolving-amplification-error>Resolving Amplification Error<a href=#resolving-amplification-error class=hash-link aria-label="Direct link to Resolving Amplification Error" title="Direct link to Resolving Amplification Error">​</a></h2>
<p>The output of the heatmap regression model is a heatmap, indicating approximately where the document corners are. Then, we <strong>cannot directly use this heatmap</strong> because it's downscaled. The actual steps are as follows:</p>
<ol>
<li>We need to upscale this heatmap to the original image size.</li>
<li>Using image post-processing methods, we find the Contour of each heatmap corner area.</li>
<li>We calculate the centroid of the Contour, which represents the document corner.</li>
</ol>
<p>This way, the model can accurately locate corners, resolving the previously mentioned amplification error issue.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=conclusion>Conclusion<a href=#conclusion class=hash-link aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>In the architecture of the heatmap model, you can find a significant drawback:</p>
<ul>
<li><strong>Not an end-to-end model</strong></li>
</ul>
<p>This has been a question we've been constantly pondering while designing the model. We hope to design an end-to-end model, which would be simpler for users and allow the model to learn from each component. However, due to the challenges encountered in the point regression model, we had to resort to the design approach of the heatmap regression model.</p>
<p>In conclusion, after resolving the amplification error issue, we can focus on discussing model scalability, speed, accuracy, etc.</p>
<p>In our experiments, using a larger Backbone, a more complex Neck, all contribute to improving model accuracy.</p>
<p>During deployment, you only need to consider the computational constraints of the usage scenario and choose the appropriate model.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated>Last updated<!-- --> on <b><time datetime=2024-05-09T03:56:13.000Z itemprop=dateModified>May 9, 2024</time></b> by <b>zephyr-sh</b></span></div></div><div style=margin-top:3rem> </div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/en/docs/docaligner/advance><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Advanced</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/en/docs/docaligner/benchmark><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Evaluation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#point-regression-model class="table-of-contents__link toc-highlight">Point Regression Model</a><ul><li><a href=#1-feature-extraction class="table-of-contents__link toc-highlight">1. Feature Extraction</a><li><a href=#2-cross-attention class="table-of-contents__link toc-highlight">2. Cross-Attention</a><li><a href=#3-point-regression class="table-of-contents__link toc-highlight">3. Point Regression</a><li><a href=#4-smooth-l1-loss class="table-of-contents__link toc-highlight">4. Smooth L1 Loss</a></ul><li><a href=#catastrophic-failure class="table-of-contents__link toc-highlight">Catastrophic Failure</a><li><a href=#approaches-by-others class="table-of-contents__link toc-highlight">Approaches by Others</a><ul><li><a href=#predicting-on-large-images class="table-of-contents__link toc-highlight">Predicting on Large Images</a><li><a href=#introducing-anchors-and-offsets class="table-of-contents__link toc-highlight">Introducing Anchors and Offsets</a><li><a href=#directly-fitting-evaluation-dataset class="table-of-contents__link toc-highlight">Directly Fitting Evaluation Dataset</a></ul><li><a href=#heatmap-regression-model class="table-of-contents__link toc-highlight">Heatmap Regression Model</a><ul><li><a href=#1-feature-extraction-1 class="table-of-contents__link toc-highlight">1. Feature Extraction</a><li><a href=#2-bifpn class="table-of-contents__link toc-highlight">2. BiFPN</a><li><a href=#3-heatmap-regression class="table-of-contents__link toc-highlight">3. Heatmap Regression</a><li><a href=#4-adaptive-wing-loss class="table-of-contents__link toc-highlight">4. Adaptive Wing Loss</a></ul><li><a href=#resolving-amplification-error class="table-of-contents__link toc-highlight">Resolving Amplification Error</a><li><a href=#conclusion class="table-of-contents__link toc-highlight">Conclusion</a></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class=footer__links><a class=footer__link-item href=/en/docs>Projects</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/papers/intro>Papers</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/blog>Blog</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/terms-of-service>TermsOfUse</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/privacy-policy>Privacy Policy</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/become-an-author>Become an author</a><span class=footer__link-separator>·</span><a class=footer__link-item href=/en/worklog>Worklog</a></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2024 DOCSAID.</div></div></div></footer></div>